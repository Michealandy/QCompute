<!DOCTYPE html><html><head>
      <title>Shor_CN</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({"extensions":["tex2jax.js"],"jax":["input/TeX","output/HTML-CSS"],"messageStyle":"none","tex2jax":{"processEnvironments":false,"processEscapes":true,"inlineMath":[["$","$"],["\\(","\\)"]],"displayMath":[["$$","$$"],["\\[","\\]"]]},"TeX":{"extensions":["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]},"HTML-CSS":{"availableFonts":["TeX"]}});
        </script>
        <script type="text/javascript" async src="file:///c:\Users\chenyuao\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.5.21\node_modules\@shd101wyy\mume\dependencies\mathjax\MathJax.js" charset="UTF-8"></script>
        
      
      
      
      
      
      
      
      
      
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
body {
  text-align: left;
}
body h1,
body h2,
body h3 {
  text-align: center;
}
body h4,
body h5,
body h6,
body p,
body section {
  text-align: left;
}

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <h1 class="mume-header" id="shor-%E7%AE%97%E6%B3%95">Shor &#x7B97;&#x6CD5;</h1>

<h2 class="mume-header" id="%E5%89%8D%E8%A8%80">&#x524D;&#x8A00;</h2>

<p><strong>&#x6574;&#x6570;&#x5206;&#x89E3;</strong>&#xFF08;Integer Factorization&#xFF09;&#x6307;&#x5C06;&#x4E00;&#x4E2A;&#x6B63;&#x6574;&#x6570; <span class="mathjax-exps">$N$</span> &#x5206;&#x89E3;&#x4E3A;&#x82E5;&#x5E72;&#x66F4;&#x5C0F;&#xFF08;&#x5927;&#x4E8E; <span class="mathjax-exps">$1$</span> &#x7684;&#xFF09;&#x6B63;&#x6574;&#x6570;&#x7684;&#x4E58;&#x79EF;&#xFF0C;&#x6BD4;&#x5982; <span class="mathjax-exps">$45=5\times9$</span>&#x3002;</p>
<p><strong>Shor &#x7B97;&#x6CD5;</strong>&#xFF08;Shor&apos;s Algorithm&#xFF09;&#xFF0C;&#x662F; Shor &#x5728; 1994 &#x5E74;&#x63D0;&#x51FA;&#x7684;&#x91CF;&#x5B50;&#x7B97;&#x6CD5;<span class="mathjax-exps">$^{[2]}$</span>&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x591A;&#x9879;&#x5F0F;&#x65F6;&#x95F4;</p>
<p></p><div class="mathjax-exps">$$O\left((\log N)^2(\log \log N)(\log \log \log N)\right)\tag{1}$$</div><p></p>
<p>&#x7ED9;&#x51FA; <span class="mathjax-exps">$N$</span> &#x7684;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x5206;&#x89E3;&#x3002;</p>
<p>&#x672C;&#x6559;&#x7A0B;&#x5C06;&#x4ECE;&#x4E09;&#x4E2A;&#x65B9;&#x9762;&#x4ECB;&#x7ECD;&#x5E76;&#x6F14;&#x793A; Shor &#x7B97;&#x6CD5;&#x3002;&#x9996;&#x5148;&#x6211;&#x4EEC;&#x4F1A;&#x7ED9;&#x51FA; Shor &#x7B97;&#x6CD5;&#x7684;&#x8F6E;&#x5ED3;&#x601D;&#x8DEF;&#xFF0C;&#x8BE6;&#x89C1; <strong>&#x7B97;&#x6CD5;&#x603B;&#x89C8;</strong> &#x4E00;&#x6BB5;&#x3002;&#x5176;&#x4F1A;&#x5F15;&#x51FA; Shor &#x7B97;&#x6CD5;&#x7684;&#x4E24;&#x4E2A;&#x6838;&#x5FC3;&#x6B65;&#x9AA4;&#xFF1A;&#x5C06;&#x6574;&#x6570;&#x5206;&#x89E3;&#x95EE;&#x9898;&#x7EA6;&#x5316;&#x4E3A;&#x6C42;&#x9636;&#x95EE;&#x9898;&#x4EE5;&#x53CA;&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#xFF0C;&#x8BFB;&#x8005;&#x53EF;&#x4EE5;&#x5206;&#x522B;&#x53C2;&#x7167; <strong>&#x4ECE;&#x6574;&#x6570;&#x5206;&#x89E3;&#x5230;&#x6C42;&#x9636;&#x95EE;&#x9898;</strong> &#x548C; <strong>&#x53CA;&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;</strong> &#x4E24;&#x8282;&#x3002;&#x5728;&#x8FD9;&#x4E24;&#x8282;&#x7684;&#x6700;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x5206;&#x522B;&#x7ED9;&#x51FA;&#x4E86;&#x5206;&#x89E3;&#x6574;&#x6570; <span class="mathjax-exps">$15$</span> &#x548C; <span class="mathjax-exps">$63$</span> &#x7684; QASM &#x548C; QCompute &#x4EE3;&#x7801;&#xFF0C;&#x4EE5;&#x4F9B;&#x8BFB;&#x8005;&#x4E0A;&#x624B;&#x5C1D;&#x8BD5;&#x3002;&#x524D;&#x8FF0;&#x7684;&#x65B9;&#x6CD5;&#x90FD;&#x4E0D;&#x5177;&#x5907;&#x666E;&#x9002;&#x6027;&#xFF0C;&#x4E0D;&#x80FD;&#x4F5C;&#x4E3A;&#x901A;&#x7528;&#x7684;&#x65B9;&#x6CD5;&#x6765;&#x5206;&#x89E3;&#x5168;&#x90E8;&#x7684;&#x6574;&#x6570;&#xFF0C;&#x4E3A;&#x4E86;&#x514B;&#x670D;&#x8FD9;&#x4E00;&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x4E86;&#x6587;&#x732E; [7] &#x7684;&#x65B9;&#x6CD5;&#x7ED9;&#x51FA;&#x4E86;&#x901A;&#x7528;&#x7B97;&#x6CD5;&#x7684;&#x4EE3;&#x7801;&#x5316;&#xFF0C;&#x4F9B;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x8BFB;&#x8005;&#x5C1D;&#x8BD5;&#x548C;&#x5B66;&#x4E60;&#xFF0C;&#x8BE6;&#x89C1; <strong><span class="mathjax-exps">$C(U_{a,N})$</span> &#x95E8;&#x7684;&#x5B9E;&#x73B0;</strong> &#x4E00;&#x6BB5;&#x3002;</p>
<ul>
<li><a href="#shor-%E7%AE%97%E6%B3%95">Shor &#x7B97;&#x6CD5;</a>
<ul>
<li><a href="#%E5%89%8D%E8%A8%80">&#x524D;&#x8A00;</a></li>
<li><a href="#%E7%AE%97%E6%B3%95%E6%80%BB%E8%A7%88">&#x7B97;&#x6CD5;&#x603B;&#x89C8;</a></li>
<li><a href="#%E4%BB%8E%E6%95%B4%E6%95%B0%E5%88%86%E8%A7%A3%E5%88%B0%E6%B1%82%E9%98%B6%E9%97%AE%E9%A2%98">&#x4ECE;&#x6574;&#x6570;&#x5206;&#x89E3;&#x5230;&#x6C42;&#x9636;&#x95EE;&#x9898;</a></li>
<li><a href="#%E9%87%8F%E5%AD%90%E6%B1%82%E9%98%B6%E7%AE%97%E6%B3%95">&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;</a>
<ul>
<li><a href="#%E7%90%86%E8%AE%BA">&#x7406;&#x8BBA;</a>
<ul>
<li><a href="#%E5%B0%86%E9%98%B6%E7%BC%96%E7%A0%81%E5%88%B0%E6%9C%AC%E5%BE%81%E7%9B%B8%E4%BD%8D">&#x5C06;&#x9636;&#x7F16;&#x7801;&#x5230;&#x672C;&#x5F81;&#x76F8;&#x4F4D;</a></li>
<li><a href="#%E8%BF%9E%E5%88%86%E6%95%B0%E5%B1%95%E5%BC%80%E8%A7%A3%E7%A0%81%E7%9B%B8%E4%BD%8D%E4%B8%BA%E9%98%B6">&#x8FDE;&#x5206;&#x6570;&#x5C55;&#x5F00;&#x89E3;&#x7801;&#x76F8;&#x4F4D;&#x4E3A;&#x9636;</a></li>
<li><a href="#%E6%80%BB%E7%BB%93">&#x603B;&#x7ED3;</a></li>
</ul>
</li>
<li><a href="#%E7%AE%80%E4%BE%8B%E4%B8%8E%E5%AE%9E%E9%AA%8C">&#x7B80;&#x4F8B;&#x4E0E;&#x5B9E;&#x9A8C;</a>
<ul>
<li><a href="#%E6%B1%82-rm-ord215-%E5%B9%B6%E5%88%86%E8%A7%A3-15">&#x6C42; <span class="mathjax-exps">${\rm ord}(2,15)$</span> &#x5E76;&#x5206;&#x89E3; <span class="mathjax-exps">$15$</span></a></li>
<li><a href="#%E6%B1%82-rm-ord263-%E5%B9%B6%E5%88%86%E8%A7%A3-63">&#x6C42; <span class="mathjax-exps">${\rm ord}(2,63)$</span> &#x5E76;&#x5206;&#x89E3; <span class="mathjax-exps">$63$</span></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#cu_an-%E9%97%A8%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="mathjax-exps">$C(U_{a,N})$</span> &#x95E8;&#x7684;&#x5B9E;&#x73B0;</a>
<ul>
<li><a href="#%E5%8F%AF%E9%80%86%E8%AE%A1%E7%AE%97">&#x53EF;&#x9006;&#x8BA1;&#x7B97;</a>
<ul>
<li><a href="#%E4%BB%8E%E7%BB%8F%E5%85%B8%E5%8F%AF%E9%80%86%E8%AE%A1%E7%AE%97%E5%BC%80%E5%A7%8B">&#x4ECE;&#xFF08;&#x7ECF;&#x5178;&#xFF09;&#x53EF;&#x9006;&#x8BA1;&#x7B97;&#x5F00;&#x59CB;</a></li>
<li><a href="#%E5%9B%9E%E5%88%B0-u_an-%E9%97%A8">&#x56DE;&#x5230; <span class="mathjax-exps">$U_{a,N}$</span> &#x95E8;</a></li>
</ul>
</li>
<li><a href="#%E9%80%9A%E7%94%A8-cu_an-%E7%9A%84%E5%AE%9E%E7%8E%B0">&#x901A;&#x7528; <span class="mathjax-exps">$C(U_{a,N})$</span> &#x7684;&#x5B9E;&#x73B0;</a>
<ul>
<li><a href="#~phi_la-%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="mathjax-exps">$~\Phi$</span><span class="mathjax-exps">$_{L,+a}$</span> &#x7684;&#x5B9E;&#x73B0;</a></li>
<li><a href="#c2phi_latextmod-n-%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="mathjax-exps">$C^2(\Phi_{L,+a,\text{mod }N})$</span> &#x7684;&#x5B9E;&#x73B0;</a></li>
<li><a href="#u_lacdottext-mod-n-%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="mathjax-exps">$U_{L,+a\cdot\text{ mod }N}$</span> &#x7684;&#x5B9E;&#x73B0;</a></li>
<li><a href="#u_an-%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="mathjax-exps">$U_{a,N}$</span> &#x7684;&#x5B9E;&#x73B0;</a></li>
<li><a href="#%E9%87%8F%E5%AD%90%E6%B1%82%E9%98%B6%E7%AE%97%E6%B3%95%E7%9A%84%E5%AE%9E%E7%8E%B0">&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#x7684;&#x5B9E;&#x73B0;</a></li>
<li><a href="#shor-%E7%AE%97%E6%B3%95%E7%9A%84%E5%AE%9E%E7%8E%B0">Shor &#x7B97;&#x6CD5;&#x7684;&#x5B9E;&#x73B0;</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">&#x53C2;&#x8003;&#x8D44;&#x6599;</a></li>
</ul>
</li>
</ul>
<h2 class="mume-header" id="%E7%AE%97%E6%B3%95%E6%80%BB%E8%A7%88">&#x7B97;&#x6CD5;&#x603B;&#x89C8;</h2>

<p>Shor &#x7B97;&#x6CD5;&#x53EF;&#x4EE5;&#x88AB;&#x7406;&#x89E3;&#x4E3A;&#x5BF9;&#x6574;&#x6570;&#x5206;&#x89E3;&#x95EE;&#x9898;&#x7684;&#x4E00;&#x4E2A;&#x7ECF;&#x5178;&#x6C42;&#x89E3;&#x7B97;&#x6CD5;&#xFF08;&#x601D;&#x60F3;&#x6765;&#x81EA; [1]&#xFF09;&#x7684;&#x91CF;&#x5B50;&#x6539;&#x8FDB;&#xFF1A;</p>
<ol>
<li>&#x4E24;&#x8005;&#x5747;&#x5C06;&#x6574;&#x6570;&#x5206;&#x89E3;&#x95EE;&#x9898;&#x8F6C;&#x5316;&#x4E3A;&#x6C42;&#x9636;&#x95EE;&#x9898;&#xFF08;Order-Finding&#xFF09;&#xFF1B;</li>
<li>Shor &#x5728;&#x6C42;&#x9636;&#x95EE;&#x9898;&#x4E0A;&#x83B7;&#x5F97;&#x4E86;&#x7A81;&#x7834;&#xFF0C;&#x63D0;&#x51FA;&#x4E86;&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#xFF08;Quantum Order-Finding Algorithm&#xFF09;&#xFF1B;</li>
<li>&#x5C06;&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#x66FF;&#x6362;&#x7ECF;&#x5178;&#x7B97;&#x6CD5;&#x4E2D;&#x6C42;&#x9636;&#x7684;&#x6B65;&#x9AA4;&#xFF0C;&#x4FBF;&#x53EF;&#x5F97;&#x5230;&#x91CF;&#x5B50;&#x7248;&#x672C;&#x7684;&#x6574;&#x6570;&#x5206;&#x89E3;&#x7B97;&#x6CD5;&#xFF0C;&#x5373; Shor &#x7B97;&#x6CD5;&#x3002;</li>
</ol>
<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x4F1A;&#x4F9D;&#x6B21;&#x4ECB;&#x7ECD; &#x201C;&#x8F6C;&#x5316;&#x201D; &#x7684;&#x8FC7;&#x7A0B;&#xFF08;&#x4ECE;&#x6574;&#x6570;&#x5206;&#x89E3;&#x5230;&#x6C42;&#x9636;&#x95EE;&#x9898;&#xFF09;&#x3001;&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#xFF0C;&#x4EE5;&#x53CA;&#x8FD9;&#x4E9B;&#x7684;&#x91CF;&#x6613;&#x4F0F;&#x4EE3;&#x7801;&#x6837;&#x4F8B;&#x3002;&#x4F46;&#x8FD9;&#x4E9B;&#x5E76;&#x4E0D;&#x80FD;&#x7528;&#x4E8E;&#x901A;&#x7528;&#x7684;&#x6574;&#x6570;&#x5206;&#x89E3;&#xFF0C;&#x5176;&#x6D89;&#x53CA;&#x5230;&#x4E00;&#x4E2A;&#x5173;&#x952E;&#x7684;&#x96BE;&#x9898;&#x201C;&#x91CF;&#x5B50;&#x9ED1;&#x7BB1;&#x201D;&#xFF08;Oracle&#xFF09;&#x7684;&#x6709;&#x6548;&#x6784;&#x9020;&#x65B9;&#x6848;&#xFF0C;&#x6211;&#x4EEC;&#x5728;&#x6700;&#x540E;&#x4E00;&#x6BB5;&#x7684;&#x524D;&#x534A;&#xFF0C;&#x5C06;&#x7ED9;&#x51FA;&#x4E00;&#x79CD;&#x57FA;&#x4E8E;&#x53EF;&#x9006;&#x8BA1;&#x7B97;&#x7684;&#x5B9E;&#x73B0;&#x601D;&#x8DEF;&#xFF0C;&#x5728;&#x540E;&#x534A;&#x6839;&#x636E;&#x53C2;&#x8003;&#x6587;&#x732E; [7] &#x7ED9;&#x51FA;&#x4E86;&#x5177;&#x4F53;&#x7684;&#x5B9E;&#x73B0;&#x4EE3;&#x7801;&#xFF0C;&#x4F9B;&#x8BFB;&#x8005;&#x91CF;&#x529B;&#x5B66;&#x4E60;&#x3002;</p>
<h2 class="mume-header" id="%E4%BB%8E%E6%95%B4%E6%95%B0%E5%88%86%E8%A7%A3%E5%88%B0%E6%B1%82%E9%98%B6%E9%97%AE%E9%A2%98">&#x4ECE;&#x6574;&#x6570;&#x5206;&#x89E3;&#x5230;&#x6C42;&#x9636;&#x95EE;&#x9898;</h2>

<p>&#x5728;&#x672C;&#x6BB5;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x7ED9;&#x51FA;&#x5C06;&#x6574;&#x6570;&#x5206;&#x89E3;&#x95EE;&#x9898;&#x7EA6;&#x5316;&#x4E3A;&#x6C42;&#x9636;&#x95EE;&#x9898;&#x7684;&#x4E00;&#x79CD;&#x65B9;&#x6848;&#x3002;&#x57FA;&#x4E8E;&#x6B64;&#xFF0C;&#x53EA;&#x8981;&#x6211;&#x4EEC;&#x80FD;&#x6C42;&#x89E3;&#x6C42;&#x9636;&#x95EE;&#x9898;&#xFF0C;&#x5C31;&#x80FD;&#x7ED9;&#x51FA;&#x76F8;&#x5E94;&#x6574;&#x6570;&#x7684;&#x5206;&#x89E3;&#x3002;</p>
<p>&#x9605;&#x8BFB;&#x672C;&#x8282;&#x540E;&#x7EED;&#x5185;&#x5BB9;&#x9700;&#x8981;&#x4E00;&#x4E9B;&#x57FA;&#x672C;&#x7684;&#x6570;&#x5B66;&#x80CC;&#x666F;&#x77E5;&#x8BC6;&#x5982;&#x4E0B;&#xFF1A;</p>
<ol>
<li>&#x7ED9;&#x5B9A;&#x6574;&#x6570; <span class="mathjax-exps">$N,a$</span>&#xFF0C;&#x82E5; <span class="mathjax-exps">$N/a$</span> &#x4E5F;&#x662F;&#x6574;&#x6570;&#xFF0C;&#x79F0; <span class="mathjax-exps">$a$</span> <strong>&#x6574;&#x9664;&#xFF08;Divide&#xFF09;</strong> <span class="mathjax-exps">$N$</span>&#xFF0C;<span class="mathjax-exps">$a$</span> &#x662F; <span class="mathjax-exps">$N$</span> &#x7684; <strong>&#x56E0;&#x6570;&#xFF08;Factor&#xFF09;</strong>&#xFF0C;&#x8BB0;&#x4E3A; <span class="mathjax-exps">$a\,|\,N$</span>&#xFF1B;&#x5426;&#x5219;&#x79F0; <span class="mathjax-exps">$a$</span> &#x4E0D;&#x6574;&#x9664; <span class="mathjax-exps">$N$</span>&#xFF0C;&#x8BB0;&#x4E3A; <span class="mathjax-exps">$a\nmid N$</span>&#xFF1B;</li>
<li><span class="mathjax-exps">$N$</span> &#x7684; <strong>&#x975E;&#x5E73;&#x51E1;&#x56E0;&#x6570;</strong> &#x6307; <span class="mathjax-exps">$\pm 1$</span> &#x548C; <span class="mathjax-exps">$\pm N$</span> &#x4EE5;&#x5916;&#x7684;&#x56E0;&#x6570;&#xFF1B;<strong>&#x6574;&#x6570;&#x5206;&#x89E3;</strong> &#x4E5F;&#x53EF;&#x4EE5;&#x8BA4;&#x4E3A;&#x662F;&#x975E;&#x5E73;&#x51E1;&#x56E0;&#x6570;&#x6C42;&#x89E3;&#xFF1B;</li>
<li>&#x82E5;&#x5E72;&#x4E2A;&#x6574;&#x6570;&#x7684; <strong>&#x6700;&#x5927;&#x516C;&#x56E0;&#x6570;&#xFF08;Greatest Common Divisor&#xFF09;</strong> &#x5B9A;&#x4E49;&#x4E3A;&#x540C;&#x65F6;&#x6574;&#x9664;&#x8FD9;&#x4E9B;&#x6574;&#x6570;&#x7684;&#x6700;&#x5927;&#x7684;&#x6B63;&#x6574;&#x6570;&#xFF0C;&#x8BB0;&#x4E3A; <span class="mathjax-exps">${\rm gcd}(\cdot,\cdots,\cdot)$</span>&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <a href="https://baike.baidu.com/item/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95/1647675?fr=aladdin">Euclid &#x8F97;&#x8F6C;&#x76F8;&#x9664;&#x6CD5;</a> &#x9AD8;&#x6548;&#x8BA1;&#x7B97;&#xFF1B;&#x79F0;&#x6700;&#x5927;&#x516C;&#x56E0;&#x6570;&#x4E3A; <span class="mathjax-exps">$1$</span> &#x7684;&#x4E24;&#x4E2A;&#x6574;&#x6570;&#x4E92;&#x7D20;&#xFF1B;</li>
<li>&#x7ED9;&#x5B9A;&#x6574;&#x6570; <span class="mathjax-exps">$a,b,N$</span>&#xFF0C;&#x82E5; <span class="mathjax-exps">$N|(a-b)$</span>&#xFF0C;&#x79F0; <span class="mathjax-exps">$a$</span> &#x4E0E; <span class="mathjax-exps">$b$</span> <strong>&#x6A21;</strong> <span class="mathjax-exps">$N$</span> <strong>&#x540C;&#x4F59;</strong>&#xFF0C;&#x8BB0;&#x4E3A; <span class="mathjax-exps">$a\equiv b\pmod{N}$</span>&#xFF1B;&#x5426;&#x5219;&#x79F0; <span class="mathjax-exps">$a$</span> &#x4E0E; <span class="mathjax-exps">$b$</span> &#x6A21; <span class="mathjax-exps">$N$</span> &#x4E0D;&#x540C;&#x4F59;&#xFF0C;&#x8BB0;&#x4E3A; <span class="mathjax-exps">$a\not\equiv b\pmod{N}$</span>&#xFF1B;</li>
<li>&#x7ED9;&#x5B9A;&#x6574;&#x6570; <span class="mathjax-exps">$a$</span> &#x548C; <span class="mathjax-exps">$N$</span>&#xFF0C;&#x82E5; <span class="mathjax-exps">$r$</span> &#x662F;&#x4F7F;&#x5F97; <span class="mathjax-exps">$a^r\equiv 1\pmod{N}$</span> &#x7684;&#x6700;&#x5C0F;&#x6B63;&#x6574;&#x6570;&#xFF0C;&#x79F0; <span class="mathjax-exps">$r$</span> &#x4E3A; <span class="mathjax-exps">$a$</span> &#x6A21; <span class="mathjax-exps">${N}$</span> &#x7684; <strong>&#x4E58;&#x6CD5;&#x9636;&#xFF08;Multiplicative Order&#xFF09;</strong>&#xFF0C;&#x7B80;&#x79F0;&#x4E3A;&#x9636;&#xFF0C;&#x8BB0;&#x4E3A; <span class="mathjax-exps">$r={\rm ord}(a,N)$</span>&#xFF1B;&#x79F0; <span class="mathjax-exps">$a$</span> &#x4E3A;&#x5E95;&#x6570;&#xFF0C;<span class="mathjax-exps">$N$</span> &#x4E3A;&#x6A21;&#x6570;&#x3002;</li>
</ol>
<p>&#x5982;&#x679C;&#x6211;&#x4EEC;&#x77E5;&#x9053;&#x4E00;&#x4E2A;&#x6574;&#x6570; <span class="mathjax-exps">$a$</span> &#x548C;&#x5176;&#x6A21; <span class="mathjax-exps">$N$</span> &#x7684;&#x9636; <span class="mathjax-exps">$r$</span>&#xFF0C;&#x4FBF;&#x6709; <span class="mathjax-exps">$N\,|\,(a^r-1)$</span>&#x3002;&#x82E5;&#x8FFD;&#x52A0;&#x5047;&#x8BBE; <span class="mathjax-exps">$r$</span> &#x662F;&#x5076;&#x6570;&#xFF0C;&#x90A3;&#x4E48;&#x7531;&#x5E73;&#x65B9;&#x5DEE;&#x516C;&#x5F0F;&#x6709; <span class="mathjax-exps">$N\,|\,(a^{r/2}-1)(a^{r/2}+1)$</span>&#xFF0C;&#x7531;&#x9636;&#x5B9A;&#x4E49;&#x4E2D;&#x7684;&#x6700;&#x5C0F;&#x6027;&#x77E5; <span class="mathjax-exps">$N\nmid(a^{r/2}-1)$</span>&#x3002;&#x82E5;&#x518D;&#x8FFD;&#x52A0;&#x5047;&#x8BBE; <span class="mathjax-exps">$N\nmid(a^{r/2}+1)$</span> &#x5373; <span class="mathjax-exps">$a^{r/2}\not\equiv-1\pmod{N}$</span>&#xFF0C;&#x6709; <span class="mathjax-exps">$N\nmid(a^{r/2}\pm1)$</span> &#x4F46; <span class="mathjax-exps">$N\mid(a^{r/2}-1)(a^{r/2}+1)$</span>&#x3002;&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x8BC1;&#x660E; <span class="mathjax-exps">${\rm gcd}(N,a^{r/2}\pm1)$</span> &#x5747;&#x4E3A; <span class="mathjax-exps">$N$</span> &#x7684;&#x975E;&#x5E73;&#x51E1;&#x56E0;&#x6570;&#x3002;&#x7EFC;&#x4E0A;&#x6240;&#x8FF0;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x6C42;&#x5F97;&#x4E86;&#x4E00;&#x7EC4; <span class="mathjax-exps">$(a,r)$</span> &#x6EE1;&#x8DB3;&#x524D;&#x8FF0;&#x6761;&#x4EF6;&#xFF0C;&#x4FBF;&#x53EF;&#x4EE5;&#x6709;&#x6548;&#x5730;&#x8BA1;&#x7B97;&#x51FA; <span class="mathjax-exps">$N$</span> &#x7684;&#x4E00;&#x4E2A;&#x975E;&#x5E73;&#x51E1;&#x56E0;&#x6570;&#xFF08;&#x7B49;&#x4EF7;&#x5730;&#xFF0C;&#x4E5F;&#x4F1A;&#x5F97;&#x5230; <span class="mathjax-exps">$N$</span> &#x7684;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x5206;&#x89E3;&#xFF09;&#x3002;&#x4E3A;&#x4E86;&#x7B80;&#x5316;&#x8868;&#x8FF0;&#xFF0C;&#x7B14;&#x8005;&#x7ED9;&#x524D;&#x8FF0;&#x6761;&#x4EF6;&#x4E00;&#x4E2A;&#x79F0;&#x8C13;&#xFF08;&#x975E;&#x901A;&#x7528;&#x6B63;&#x5F0F;&#x7684;&#x7528;&#x8BED;&#xFF09;&#xFF1A;</p>
<div class="theorem">
<p><strong>&#x5B9A;&#x4E49; 1&#xFF08;&#x201C;&#x826F;&#x6027;&#x201D;&#xFF09;.</strong> &#x7ED9;&#x5B9A;&#x4E92;&#x7D20;&#x7684;&#x6574;&#x6570; <span class="mathjax-exps">$a$</span> &#x548C;&#x5947;&#x6570; <span class="mathjax-exps">$N$</span>&#xFF0C;&#x8BBE; <span class="mathjax-exps">$r={\rm ord}(a,N)$</span> &#x662F; <span class="mathjax-exps">$a$</span> &#x6A21; <span class="mathjax-exps">${N}$</span> &#x7684;&#x9636;&#xFF0C;&#x82E5; <span class="mathjax-exps">$r$</span> &#x662F;&#x5076;&#x6570;&#x4E14; <span class="mathjax-exps">$a^{r/2}\not\equiv-1\pmod{N}$</span>&#xFF0C;&#x6211;&#x4EEC;&#x79F0; <span class="mathjax-exps">$a$</span> &#x6A21; <span class="mathjax-exps">${N}$</span> &#x662F;&#x201C;&#x826F;&#x6027;&#x201D;&#x7684;&#xFF1B;&#x5426;&#x5219;&#x79F0;&#x4E3A;&#x201C;&#x975E;&#x826F;&#x6027;&#x201D;&#x7684;&#x3002;&#x6211;&#x4EEC;&#x5728;&#x4E0D;&#x5F15;&#x53D1;&#x6B67;&#x4E49;&#x65F6;&#x7565;&#x53BB;&#x201C;&#x6A21; <span class="mathjax-exps">${N}$</span>&#x201D;&#x4EE5;&#x7B80;&#x5316;&#x8868;&#x8FF0;&#x3002;</p>
</div>
<p>&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x77E5;&#x9053;&#x201C;&#x826F;&#x6027;&#x201D;&#x7684; <span class="mathjax-exps">$a$</span> &#x53CA;&#x5176;&#x9636; <span class="mathjax-exps">$r$</span> &#x53EF;&#x4EE5;&#x8BF1;&#x5BFC;&#x51FA; <span class="mathjax-exps">$N$</span> &#x7684;&#x6574;&#x6570;&#x5206;&#x89E3;&#xFF0C;&#x4F46;&#x5982;&#x4F55;&#x627E;&#x5230;&#x201C;&#x826F;&#x6027;&#x201D;&#x7684; <span class="mathjax-exps">$a$</span> &#x548C;&#x5982;&#x4F55;&#x8BA1;&#x7B97; <span class="mathjax-exps">$a$</span> &#x7684;&#x9636;&#x90FD;&#x662F;&#x5C1A;&#x672A;&#x89E3;&#x51B3;&#x7684;&#x95EE;&#x9898;&#x3002;&#x4F46;&#x662F;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x6709;&#x5BF9;&#x4EFB;&#x610F;&#x7684; <span class="mathjax-exps">$a$</span> &#x548C; <span class="mathjax-exps">$N$</span> &#x53EF;&#x4EE5;&#x8BA1;&#x7B97;&#x9636; <span class="mathjax-exps">$\rm{ord}(a,N)$</span> &#x7684;&#x7B97;&#x6CD5;&#xFF0C;&#x4FBF;&#x53EF;&#x968F;&#x673A;&#x62BD;&#x9009;&#x6574;&#x6570; <span class="mathjax-exps">$a$</span>&#xFF0C;&#x7136;&#x540E;&#x8BA1;&#x7B97;&#x5176;&#x9636; <span class="mathjax-exps">$r$</span>&#xFF0C;&#x518D;&#x5224;&#x65AD; <span class="mathjax-exps">$a$</span> &#x662F;&#x4E0D;&#x662F;&#x201C;&#x826F;&#x6027;&#x201D;&#x7684;&#xFF0C;&#x82E5;&#x5176;&#x662F;&#x201C;&#x826F;&#x6027;&#x201D;&#x7684;&#xFF0C;&#x4FBF;&#x53EF;&#x7531; <span class="mathjax-exps">${\rm gcd}(N,a^{r/2}\pm1)$</span> &#x4E3A; <span class="mathjax-exps">$N$</span> &#x7684;&#x975E;&#x5E73;&#x51E1;&#x56E0;&#x6570;&#x5F97;&#x5230; <span class="mathjax-exps">$N$</span> &#x7684;&#x6574;&#x6570;&#x5206;&#x89E3;&#xFF1B;&#x5426;&#x5219;&#x91CD;&#x65B0;&#x62BD;&#x9009; <span class="mathjax-exps">$a$</span>&#xFF0C;&#x5E76;&#x91CD;&#x590D;&#x4E0A;&#x8FF0;&#x6D41;&#x7A0B;&#x3002;&#x7279;&#x522B;&#x5730;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x62BD;&#x9009;&#x5230;&#x7684; <span class="mathjax-exps">$a$</span> &#x4E0E; <span class="mathjax-exps">$N$</span> &#x4E0D;&#x4E92;&#x7D20;&#xFF0C;&#x867D;&#x7136; <span class="mathjax-exps">$a$</span> &#x7684;&#x9636;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x4F46; <span class="mathjax-exps">${\rm gcd}(a,N)$</span> &#x5DF2;&#x7ECF;&#x662F; <span class="mathjax-exps">$N$</span> &#x7684;&#x4E00;&#x4E2A;&#x975E;&#x5E73;&#x51E1;&#x56E0;&#x6570;&#x4E86;&#xFF0C;&#x6B64;&#x65F6;&#x53EF;&#x4EE5;&#x4E0D;&#x8FDB;&#x5165;&#x6C42;&#x9636;&#x6B65;&#x9AA4;&#x5C31;&#x53EF;&#x4EE5;&#x5F97;&#x5230; <span class="mathjax-exps">$N$</span> &#x7684;&#x6574;&#x6570;&#x5206;&#x89E3;&#x3002;</p>
<div class="theorem">
<p><strong>&#x4F8B; 2.</strong> &#x8003;&#x8651; <span class="mathjax-exps">$N=315$</span>&#xFF0C;<span class="mathjax-exps">$a=2$</span>&#xFF0C;&#x53EF;&#x4EE5;&#x9A8C;&#x8BC1; <span class="mathjax-exps">${\rm ord}(2,315)=12$</span> &#x53CA; <span class="mathjax-exps">$2^{12/2}\equiv 64\not\equiv-1\pmod{315}$</span>&#xFF0C;&#x8FDB;&#x800C; <span class="mathjax-exps">$2$</span> &#x662F;&#x201C;&#x826F;&#x6027;&#x201D;&#x7684;&#xFF0C; <span class="mathjax-exps">${\rm gcd}(2^{6}-1,315)=63$</span> &#x548C; <span class="mathjax-exps">${\rm gcd}(2^{6}+1,315)=5$</span> &#x5747;&#x4E3A; <span class="mathjax-exps">$315$</span> &#x7684;&#x975E;&#x5E73;&#x51E1;&#x56E0;&#x6570;&#x3002;&#x7279;&#x522B;&#x5730;&#xFF0C;&#x6070;&#x6709; <span class="mathjax-exps">$315=63\times5$</span>&#x3002;</p>
</div>
<p>&#x5173;&#x4E8E;&#x6C42;&#x9636;&#x8FD9;&#x4E00;&#x6B65;&#x9AA4;&#x6211;&#x4EEC;&#x5C06;&#x5728;&#x4E0B;&#x4E00;&#x6BB5;&#x4E2D;&#x5C55;&#x5F00;&#xFF0C;&#x8FD9;&#x4E5F;&#x662F; Shor &#x7B97;&#x6CD5;&#x4E2D;&#x552F;&#x4E00;&#x91CF;&#x5B50;&#x7684;&#x90E8;&#x5206;&#x3002;&#x4F5C;&#x4E3A;&#x672C;&#x6BB5;&#x7684;&#x6700;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x603B;&#x7ED3;&#x4E00;&#x4E0B; Shor &#x7B97;&#x6CD5;&#x7684;&#x6D41;&#x7A0B;&#x5982;&#x4E0B;&#xFF1A;</p>
<div class="theorem">
<p><strong>&#x7B97;&#x6CD5; 3&#xFF08;Shor &#x7B97;&#x6CD5;&#xFF09;.</strong></p>
<p><strong>&#x8F93;&#x5165;&#xFF1A;</strong> &#x6B63;&#x5947;&#x6570; <span class="mathjax-exps">$N$</span>, &#x81F3;&#x5C11;&#x6709;&#x4E24;&#x4E2A;&#x4E92;&#x7D20;&#x7684;&#x975E;&#x5E73;&#x51E1;&#x56E0;&#x6570;&#x3002;</p>
<p><strong>&#x8F93;&#x51FA;&#xFF1A;</strong> <span class="mathjax-exps">$N$</span> &#x7684;&#x4E00;&#x4E2A;&#x975E;&#x5E73;&#x51E1;&#x56E0;&#x6570;&#x3002;</p>
<ol>
<li>&#x5728; <span class="mathjax-exps">$\{2,3,\cdots,N-2\}$</span> &#x4E2D;&#x968F;&#x673A;&#x9009;&#x53D6;&#x6574;&#x6570; <span class="mathjax-exps">$a$</span>&#xFF1B;</li>
<li>&#x4F7F;&#x7528; <a href="https://baike.baidu.com/item/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95/1647675?fr=aladdin">Euclid &#x8F97;&#x8F6C;&#x76F8;&#x9664;&#x6CD5;</a> &#x8BA1;&#x7B97;&#x6700;&#x5927;&#x516C;&#x56E0;&#x6570; <span class="mathjax-exps">${\rm gcd}(a,N)$</span>&#xFF1B;</li>
<li><strong>&#x82E5;</strong> <span class="mathjax-exps">${\rm gcd}(a,N)\ne1$</span>&#xFF0C;<strong>&#x8FD4;&#x56DE;</strong> <span class="mathjax-exps">${\rm gcd}(a,N)$</span>&#xFF1B;</li>
<li>&#x4F7F;&#x7528;&#xFF08;&#x91CF;&#x5B50;&#xFF09;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#x8BA1;&#x7B97; <span class="mathjax-exps">$r={\rm ord}(a,N)$</span>&#xFF1B;</li>
<li><strong>&#x82E5;</strong> <span class="mathjax-exps">$r$</span> &#x4E3A;&#x5076;&#x6570; <strong>&#x5E76;&#x4E14;</strong> <span class="mathjax-exps">$a^{r/2}\not\equiv -1\pmod{N}$</span>&#xFF0C;<strong>&#x8FD4;&#x56DE;</strong> <span class="mathjax-exps">${\rm gcd}(a^{r/2}+1,N)$</span> &#xFF08;&#x6216; <span class="mathjax-exps">${\rm gcd}(a^{r/2}-1,N)$</span>&#xFF09;&#xFF1B;</li>
<li><strong>&#x8F6C;&#x79FB;</strong> &#x5230;&#x6B65;&#x9AA4; 1&#x3002;</li>
</ol>
</div>
<h2 class="mume-header" id="%E9%87%8F%E5%AD%90%E6%B1%82%E9%98%B6%E7%AE%97%E6%B3%95">&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;</h2>

<h3 class="mume-header" id="%E7%90%86%E8%AE%BA">&#x7406;&#x8BBA;</h3>

<p>&#x56E0;&#x4E3A;&#x7B97;&#x6CD5;&#x65E8;&#x5728;&#x6C42;&#x89E3; <span class="mathjax-exps">$a$</span> &#x6A21; <span class="mathjax-exps">$N$</span> &#x7684;&#x9636; <span class="mathjax-exps">${\rm ord}(a,N)$</span>&#xFF0C;&#x6211;&#x4EEC;&#x79F0;&#x5176;&#x4E3A;&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#x3002;&#x53EF;&#x4EE5;&#x8BC1;&#x660E;</p>
<p></p><div class="mathjax-exps">$$f(x)= a^x\text{ mod }{N}\tag{2}$$</div><p></p>
<p>&#x4E3A;&#x5468;&#x671F;&#x51FD;&#x6570;&#xFF0C;&#x5176;&#xFF08;&#x6700;&#x5C0F;&#x6B63;&#xFF09;&#x5468;&#x671F;&#x6070;&#x662F; <span class="mathjax-exps">${\rm ord}(a,N)$</span>&#xFF0C;&#x8FD9;&#x91CC; <span class="mathjax-exps">$x \text{ mod }y:=x-y\lfloor x/y\rfloor\in\{0,\cdots,y-1\}$</span> &#x662F; <span class="mathjax-exps">$x$</span> &#x9664;&#x4EE5; <span class="mathjax-exps">$y$</span> &#x7684;&#x4F59;&#x6570;&#x3002;&#x8FDB;&#x800C;&#xFF0C;&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#x53EF;&#x4F5C;&#x4E3A; <strong>&#x91CF;&#x5B50;&#x5468;&#x671F;&#x6C42;&#x89E3;&#x7B97;&#x6CD5;</strong>&#xFF08;Period-Finding&#xFF09;&#x7684;&#x4E00;&#x4E2A;&#x7279;&#x4F8B;&#x3002;&#x4ECE;&#x672C;&#x8D28;&#x4E0A;&#x8BB2;&#xFF0C;&#x91CF;&#x5B50;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;&#x4E5F;&#x662F;&#x91CF;&#x5B50;&#x5468;&#x671F;&#x6C42;&#x89E3;&#x7B97;&#x6CD5;&#x7684;&#x4E00;&#x4E2A;&#x7279;&#x4F8B;&#xFF0C;&#x4F46;&#x662F;&#x4ECE;&#x5468;&#x671F;&#x6C42;&#x89E3;&#x7B97;&#x6CD5;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x7406;&#x89E3;&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#x548C;&#x91CF;&#x5B50;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;&#x76F8;&#x5BF9;&#x8981;&#x56F0;&#x96BE;&#x4E00;&#x4E9B;&#xFF0C;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x8BFB;&#x8005;&#x53EF;&#x4EE5;&#x81EA;&#x884C;&#x5C1D;&#x8BD5;&#x4E86;&#x89E3;<span class="mathjax-exps">$^{[5]}$</span>&#x3002;</p>
<p>Shor &#x7684;&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#x53EF;&#x4EE5;&#x88AB;&#x8BA4;&#x4E3A;&#x662F;&#x57FA;&#x4E8E;&#x91CF;&#x5B50;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;&#x7684;&#xFF0C;&#x5C06;&#x9636;&#x8FD9;&#x4E00;&#x4FE1;&#x606F; <strong>&#x7F16;&#x7801;</strong> &#x5230;&#x67D0;&#x4E2A;&#x91CF;&#x5B50;&#x95E8;&#xFF08;&#x6216;&#x91CF;&#x5B50;&#x5B50;&#x7535;&#x8DEF;&#xFF09;&#x7684;&#x672C;&#x5F81;&#x76F8;&#x4F4D;&#x4E0A;&#x53BB;&#xFF0C;&#x501F;&#x7531;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5; <strong>&#x4F30;&#x8BA1;</strong> &#x51FA;&#x8BE5;&#x76F8;&#x4F4D;&#xFF0C;&#x8FDB;&#x800C;&#x518D;&#x7531;&#x8FDE;&#x5206;&#x6570;&#x5C55;&#x5F00;&#x7B97;&#x6CD5; <strong>&#x6062;&#x590D;</strong> &#x51FA;&#x9636;&#x7684;&#x503C;&#x3002;</p>
<h4 class="mume-header" id="%E5%B0%86%E9%98%B6%E7%BC%96%E7%A0%81%E5%88%B0%E6%9C%AC%E5%BE%81%E7%9B%B8%E4%BD%8D">&#x5C06;&#x9636;&#x7F16;&#x7801;&#x5230;&#x672C;&#x5F81;&#x76F8;&#x4F4D;</h4>

<p>&#x7ED9;&#x5B9A; <span class="mathjax-exps">$a\in\{2,\cdots,N-2\}$</span> &#x4E0E; <span class="mathjax-exps">$N$</span> &#x4E92;&#x7D20;&#xFF0C;&#x73B0;&#x8981;&#x6C42;&#x89E3; <span class="mathjax-exps">$a$</span> &#x6A21; <span class="mathjax-exps">$N$</span> &#x7684;&#x9636; <span class="mathjax-exps">$r={\rm ord}(a,N)$</span>&#x3002;&#x4F7F;&#x7528; <span class="mathjax-exps">$L=\lceil \log_2(N+1)\rceil$</span> &#x4E2A;&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#x6765;&#x7F16;&#x7801;&#xFF0C;&#x8BBE;&#x6709;&#x91CF;&#x5B50;&#x95E8;</p>
<p></p><div class="mathjax-exps">$$U_{a,N}=\sum_{x=0}^{N-1}|{ax\ \textrm{mod } {N}}\rangle\langle{x}|+\sum_{x=N}^{2^L-1}|{x}\rangle\langle{x}|.\tag{3}$$</div><p></p>
<p>&#x53EF;&#x4EE5;&#x8BC1;&#x660E; <span class="mathjax-exps">$|1\rangle$</span> &#x662F; <span class="mathjax-exps">$U_{a,N}$</span> &#x7684;&#x4E00;&#x4E9B;&#x672C;&#x5F81;&#x6001;&#x7684;&#x7B49;&#x6982;&#x7387;&#x5E45;&#x53E0;&#x52A0;&#x6001;&#xFF0C;&#x5BF9; <span class="mathjax-exps">$|1\rangle$</span> &#x548C; <span class="mathjax-exps">$U_{a,N}$</span> &#x8C03;&#x7528;&#x91CF;&#x5B50;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;&#xFF0C;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x67D0;&#x4E2A;&#x76F8;&#x4F4D;</p>
<p></p><div class="mathjax-exps">$$2\pi s/r, \ s=0,1,\cdots,r-1\tag{4}$$</div><p></p>
<p>&#x7684; <strong>&#x4F30;&#x8BA1;</strong> <span class="mathjax-exps">$k$</span> &#xFF08;&#x8FD9;&#x91CC; <span class="mathjax-exps">$k$</span> &#x662F; <strong>&#x76F8;&#x4F4D;&#x56E0;&#x5B50;</strong> <span class="mathjax-exps">$s/r$</span> &#x7684;&#x8FD1;&#x4F3C;&#xFF09;&#x3002;&#x5F53;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;&#x7684;&#x7CBE;&#x5EA6;&#x8FBE;&#x5230; <span class="mathjax-exps">$N^{-2}$</span> &#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8FDE;&#x5206;&#x6570;&#x5C55;&#x5F00;&#x7B97;&#x6CD5;&#x4ECE; <span class="mathjax-exps">$k$</span> &#x4E2D;&#x6062;&#x590D;&#x51FA;&#x76F8;&#x4F4D;&#x7684;&#x5206;&#x6BCD; <span class="mathjax-exps">$r$</span>.</p>
<h4 class="mume-header" id="%E8%BF%9E%E5%88%86%E6%95%B0%E5%B1%95%E5%BC%80%E8%A7%A3%E7%A0%81%E7%9B%B8%E4%BD%8D%E4%B8%BA%E9%98%B6">&#x8FDE;&#x5206;&#x6570;&#x5C55;&#x5F00;&#x89E3;&#x7801;&#x76F8;&#x4F4D;&#x4E3A;&#x9636;</h4>

<p>&#x8FD9;&#x91CC;&#x4E3E;&#x4F8B;&#x6F14;&#x793A;&#x4E00;&#x4E0B;&#x8FDE;&#x5206;&#x6570;&#x5C55;&#x5F00;&#x7B97;&#x6CD5;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x8FDE;&#x5206;&#x6570;&#x5C55;&#x5F00;&#x7684;&#x8FC7;&#x7A0B;&#x5C31;&#x662F; Euclid &#x8F97;&#x8F6C;&#x76F8;&#x9664;&#x6CD5;&#xFF0C;&#x6BCF;&#x4E00;&#x6B21;&#x8FED;&#x4EE3;&#x5C06;&#x5206;&#x6570;&#x8868;&#x793A;&#x4E3A;&#x5E26;&#x5206;&#x6570;&#x7684;&#x5F62;&#x5F0F;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x5E26;&#x5206;&#x6570;&#x7684;&#x5206;&#x6570;&#x90E8;&#x5206;&#x7684;&#x5206;&#x5B50;&#x5316;&#x4E3A; <span class="mathjax-exps">$1$</span>&#xFF0C;&#x5C06;&#x65B0;&#x7684;&#x5206;&#x6BCD;&#x4F5C;&#x4E3A;&#x4E0B;&#x4E00;&#x6B21;&#x8FED;&#x4EE3;&#x7684;&#x8F93;&#x5165;&#xFF0C;&#x5FAA;&#x73AF;&#x81F3;&#x5E26;&#x5206;&#x6570;&#x4E3A;&#x6574;&#x6570;&#x6B62;&#x3002;</p>
<div class="theorem">
<p><strong>&#x4F8B; 4.</strong> &#x8003;&#x8651; <span class="mathjax-exps">$N=63$</span> &#x65F6;&#xFF0C;&#x5BF9; <span class="mathjax-exps">$k=2729/8192$</span> &#x6267;&#x884C;&#x8FDE;&#x5206;&#x6570;&#x5C55;&#x5F00;&#xFF1A;</p>
<p></p><div class="mathjax-exps">$$\begin{align*} \frac{2729}{8192} =&amp;\frac{1}{\frac{8192}{2729}}=\frac{1}{3+\frac{5}{2729}}=\frac{1}{3+\frac{1}{545+\frac45}}\\ =&amp;0 + \frac{1}{3+\frac{1}{545+\frac{1}{1+\frac{1}{4}}}}=:[0,3,545,1,4], \end{align*}\tag{5}$$</div><p></p>
<p>&#x5206;&#x522B;&#x79F0; <span class="mathjax-exps">$[0]=0$</span>&#xFF0C;<span class="mathjax-exps">$[0,3]=0+\frac{1}{3}=\frac{1}{3}$</span>&#xFF0C;<span class="mathjax-exps">$[0,3,545]=0+\frac{1}{3+\frac{1}{545}}=\frac{545}{1636}$</span> &#x548C; <span class="mathjax-exps">$[0,3,545,1]=0+\frac{1}{3+\frac{1}{545+\frac{1}{1}}}=\frac{546}{1639}$</span> &#x4E3A;&#x8FDE;&#x5206;&#x6570; <span class="mathjax-exps">$[0,3,545,1,4]$</span> &#x7684;&#x7B2C; <span class="mathjax-exps">$0$</span>&#xFF0C;&#x7B2C; <span class="mathjax-exps">$1$</span>&#xFF0C;&#x7B2C; <span class="mathjax-exps">$2$</span> &#x548C;&#x7B2C; <span class="mathjax-exps">$3$</span> <strong>&#x622A;&#x65AD;</strong>&#xFF08;convergent&#xFF0C;&#x7B14;&#x8005;&#x8BD1;&#xFF09;&#x3002;&#x8FDE;&#x5206;&#x6570;&#x5C55;&#x5F00;&#x7B97;&#x6CD5; <strong>&#x8FD4;&#x56DE;</strong> <span class="mathjax-exps">$k$</span> &#x5404;&#x622A;&#x65AD;&#x7684;&#x5206;&#x6BCD;&#x4E2D; <span class="mathjax-exps">$&lt; N$</span> &#x7684;&#x6700;&#x5927;&#x8005;&#xFF08;&#x672C;&#x4F8B;&#x4E3A; <span class="mathjax-exps">$3$</span>&#xFF09;&#x3002;</p>
</div> 
<div class="theorem">
<p><strong>&#x6CE8; 5.</strong> &#x5F53;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;&#x7684;&#x7CBE;&#x5EA6;&#x8FBE;&#x5230; <span class="mathjax-exps">$N^{-2}$</span> &#x65F6;&#xFF0C;&#x8FDE;&#x5206;&#x6570;&#x5C55;&#x5F00;&#x7B97;&#x6CD5;&#x603B;&#x80FD;&#x8FD4;&#x56DE; <span class="mathjax-exps">$s/r$</span> &#x7684;&#x5206;&#x6BCD;&#xFF0C;&#x4F46; <span class="mathjax-exps">$s/r$</span> &#x7684;&#x5206;&#x6BCD;&#x4E0D;&#x4E00;&#x5B9A;&#x662F; <span class="mathjax-exps">$r$</span>&#xFF1A;&#x5F53; <span class="mathjax-exps">${\rm gcd}(s,r)\ne1$</span> &#x65F6;&#xFF0C;<span class="mathjax-exps">$s/r$</span> &#x7684;&#x5206;&#x6BCD;&#x662F; <span class="mathjax-exps">$r/{\rm gcd}(s,r)$</span>&#x3002;&#x6B64;&#x65F6;&#x80FD;&#x6062;&#x590D;&#x51FA;&#x9636; <span class="mathjax-exps">$r$</span> &#x7684;&#x6982;&#x7387;&#x4E0E; <span class="mathjax-exps">$N$</span> &#x76F8;&#x5173;&#xFF0C;&#x4F46;&#x6700;&#x7CDF;&#x7CD5;&#x60C5;&#x51B5;&#x4E0B;&#x4F1A;&#x8D8B;&#x8FD1;&#x4E8E; <span class="mathjax-exps">$0$</span>&#x3002;</p>
</div> 
<p>&#x4E3A;&#x4E86;&#x63D0;&#x9AD8;&#x6062;&#x590D;&#x51FA;&#x9636; <span class="mathjax-exps">$r$</span> &#x7684;&#x6982;&#x7387;&#xFF0C;&#x76EE;&#x524D;&#x6700;&#x597D;&#x7684;&#x529E;&#x6CD5;&#x662F;&#x6267;&#x884C;&#x4E24;&#x6B21;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#x5E76;&#x8BA1;&#x7B97;&#x5206;&#x6BCD;&#x7684;&#x6700;&#x5C0F;&#x516C;&#x500D;&#x6570;&#xFF1A;</p>
<div class="theorem">
<p><strong>&#x5B9A;&#x7406; 6.</strong> &#x901A;&#x8FC7;&#x6267;&#x884C;&#x4E24;&#x6B21;&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#xFF0C;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x4E24;&#x4E2A;&#x5206;&#x6BCD; <span class="mathjax-exps">$q$</span> &#x548C; <span class="mathjax-exps">$q&apos;$</span>&#xFF0C;&#x8BA1;&#x7B97; <span class="mathjax-exps">$q$</span> &#x548C; <span class="mathjax-exps">$q&apos;$</span> &#x7684;&#x6700;&#x5C0F;&#x516C;&#x500D;&#x6570; <span class="mathjax-exps">$\tilde r:=q q&apos;/\textrm{gcd}(q,q&apos;)$</span>&#xFF0C;&#x5219; <span class="mathjax-exps">$\tilde r=r$</span> &#x7684;&#x6982;&#x7387; <span class="mathjax-exps">$\ge{6(1-\epsilon)^2}/{\pi^2} \ge60.7\%\cdot(1-\epsilon)^2$</span>&#xFF0C;&#x8FD9;&#x91CC; <span class="mathjax-exps">$\epsilon$</span> &#x662F;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;&#x7684;&#x5931;&#x8D25;&#x6982;&#x7387;&#x3002;&#x8FD9;&#x91CC; <span class="mathjax-exps">$q$</span> &#x548C; <span class="mathjax-exps">$q&apos;$</span> &#x5206;&#x522B;&#x4E3A;&#x4E24;&#x6B21;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;&#x8FD4;&#x56DE;&#x4F30;&#x8BA1; <span class="mathjax-exps">$k$</span> &#x548C; <span class="mathjax-exps">$k&apos;$</span> &#x4F5C;&#x4E3A;&#x8FDE;&#x5206;&#x6570;&#x5C55;&#x5F00;&#x7B97;&#x6CD5;&#x8F93;&#x5165;&#x540E;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x3002;</p>
</div>
<h4 class="mume-header" id="%E6%80%BB%E7%BB%93">&#x603B;&#x7ED3;</h4>

<p>&#x672C;&#x6BB5;&#x7684;&#x6700;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x518D;&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#x3002;</p>
<div class="theorem">
<p><strong>&#x7B97;&#x6CD5; 7&#xFF08;&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#xFF09;.</strong></p>
<p><strong>&#x8F93;&#x5165;&#xFF1A;</strong> &#x6574;&#x6570; <span class="mathjax-exps">$a\in\{2,\cdots,N-2\}$</span> &#x4E0E; <span class="mathjax-exps">$N$</span> &#x4E92;&#x7D20;&#xFF0C;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;&#x7684;&#x5931;&#x8D25;&#x6982;&#x7387; <span class="mathjax-exps">$\epsilon$</span>&#x3002;</p>
<p><strong>&#x8F93;&#x51FA;&#xFF1A;</strong> <span class="mathjax-exps">${\rm ord}(a,N)$</span>&#x3002;</p>
<ol>
<li>&#x4EE4; <span class="mathjax-exps">$L=\lceil \log_2(N+1)\rceil$</span>&#xFF1B;</li>
<li>&#x6267;&#x884C;&#x4E24;&#x6B21;&#xFF1A;&#x4F7F;&#x7528; <span class="mathjax-exps">$t=2L+1+\lceil\log_2(1+\frac{2}{\epsilon\pi^2})\rceil$</span> &#x4E2A;&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#x4F5C;&#x4E3A;&#x8F85;&#x52A9;&#x5BC4;&#x5B58;&#x5668;&#x5BF9;&#x91CF;&#x5B50;&#x95E8; <span class="mathjax-exps">$U_{a,N}$</span> &#x548C;&#x91CF;&#x5B50;&#x6001; <span class="mathjax-exps">$|1\rangle$</span> &#x6267;&#x884C;&#x91CF;&#x5B50;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;&#x5E76;&#x5BF9;&#x8F85;&#x52A9;&#x5BC4;&#x5B58;&#x5668;&#x8FDB;&#x884C;&#x6D4B;&#x91CF;&#x3002;&#x5206;&#x522B;&#x5F97;&#x5230; <span class="mathjax-exps">$|m\rangle$</span> &#x548C; <span class="mathjax-exps">$|m&apos;\rangle$</span>&#xFF1B;</li>
<li>&#x5206;&#x522B;&#x5BF9; <span class="mathjax-exps">$k=2^{-t}m$</span> &#x548C; <span class="mathjax-exps">$k&apos;=2^{-t}m&apos;$</span> &#x505A;&#x8FDE;&#x5206;&#x6570;&#x5C55;&#x5F00;&#xFF0C;&#x5206;&#x522B;&#x8BA1;&#x7B97;&#x5B83;&#x4EEC;&#x5404;&#x4E2A;&#x622A;&#x65AD;&#x4E2D; <span class="mathjax-exps">$&lt; N$</span> &#x7684;&#x6700;&#x5927;&#x5206;&#x6BCD; <span class="mathjax-exps">$q_j$</span> &#x548C; <span class="mathjax-exps">$q_k&apos;$</span>&#xFF1B;</li>
<li>&#x8BA1;&#x7B97; <span class="mathjax-exps">$r_{jk}=q_jq_k&apos;/{\rm gcd}(q_j,q_k&apos;)$</span>&#xFF0C;<strong>&#x82E5;</strong> <span class="mathjax-exps">$a^{r_{jk}}\equiv 1\pmod N$</span> <strong>&#x8FD4;&#x56DE;</strong> <span class="mathjax-exps">${\rm ord}(a,N)=r_{jk}$</span>&#xFF0C;<strong>&#x5426;&#x5219;</strong> <strong>&#x8F6C;&#x79FB;</strong> &#x5230;&#x6B65;&#x9AA4; 2 &#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x3002;</li>
</ol>
</div>
<p>&#x5176;&#x4E2D;&#x7B97;&#x6CD5; 7 &#x6B65;&#x9AA4; 4 &#x7684;&#x8FD4;&#x56DE; <span class="mathjax-exps">${\rm ord}(a,N)$</span> &#x7684;&#x6982;&#x7387;&#x4E0D;&#x5C0F;&#x4E8E; <span class="mathjax-exps">$60.7\%\cdot(1-\epsilon)^2$</span>&#x3002;&#x7279;&#x522B;&#x5730;&#xFF0C;&#x53D6; <span class="mathjax-exps">$t=2L+1+3$</span> &#x65F6;&#xFF0C;<span class="mathjax-exps">$\epsilon=2.895\%$</span>&#xFF0C;&#x7B97;&#x6CD5; 7 &#x6B65;&#x9AA4; 4 &#x8FD4;&#x56DE; <span class="mathjax-exps">$\rm{ord}(a,N)$</span> &#x7684;&#x6982;&#x7387;&#x4E0D;&#x5C11;&#x4E8E; <span class="mathjax-exps">$57.3\%$</span>&#xFF1B;&#x6B64;&#x65F6;&#x5FAA;&#x73AF;&#x81F3;&#x591A; <span class="mathjax-exps">$4$</span> &#x6B21;&#x53EF;&#x4EE5;&#x8FD4;&#x56DE; <span class="mathjax-exps">$\rm{ord}(a,N)$</span> &#x7684;&#x6982;&#x7387;&#x4E0D;&#x5C11;&#x4E8E; <span class="mathjax-exps">$96.6\%$</span>&#x3002;</p>
<p>&#x81F3;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x7ED9;&#x51FA;&#x4E86; Shor &#x7B97;&#x6CD5;&#x7684;&#x5168;&#x90E8;&#x5185;&#x5BB9;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x4E8E;&#x4E0B;&#x4E00;&#x5B50;&#x6BB5;&#x6F14;&#x793A;&#x4E24;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;&#x3002;</p>
<h3 class="mume-header" id="%E7%AE%80%E4%BE%8B%E4%B8%8E%E5%AE%9E%E9%AA%8C">&#x7B80;&#x4F8B;&#x4E0E;&#x5B9E;&#x9A8C;</h3>

<p>&#x5728;&#x672C;&#x6BB5;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x4F1A;&#x4F7F;&#x7528;&#x91CF;&#x5B50;&#x7F16;&#x7A0B;&#x5E73;&#x53F0;&#x2014;&#x2014;<a href="https://quantum-hub.baidu.com/#/">&#x91CF;&#x6613;&#x4F0F;</a>&#x6765;&#x6F14;&#x793A; Shor&#x7B97;&#x6CD5;&#x3002;<br>
&#x6211;&#x4EEC;&#x4F1A;&#x5148;&#x4F7F;&#x7528;&#x91CF;&#x5B50;&#x4F5C;&#x66F2;&#x5BB6;&#xFF08;QComposer&#xFF09;&#x6765;&#x5206;&#x89E3;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;&#x2014;&#x2014;<span class="mathjax-exps">$15=3\times5$</span>&#xFF0C;&#x7136;&#x540E;&#x7528;&#x91CF;&#x5B50;&#x5728;&#x7EBF;&#x5E73;&#x53F0;&#xFF08;PyOnline&#xFF09;&#x6765;&#x5206;&#x89E3;&#x4E00;&#x4E2A;&#x66F4;&#x590D;&#x6742;&#x7684;&#x4F8B;&#x5B50;&#x2014;&#x2014;<span class="mathjax-exps">$63=3^2\times 7$</span>&#x3002;</p>
<h4 class="mume-header" id="%E6%B1%82-rm-ord215-%E5%B9%B6%E5%88%86%E8%A7%A3-15">&#x6C42; <span class="mathjax-exps">${\rm ord}(2,15)$</span> &#x5E76;&#x5206;&#x89E3; <span class="mathjax-exps">$15$</span></h4>

<p>&#x6211;&#x4EEC;&#x9700;&#x8981; <span class="mathjax-exps">$L=\lceil \log_2(15+1)\rceil=4$</span> &#x4E2A;&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#x6765;&#x7F16;&#x7801;&#x91CF;&#x5B50;&#x95E8; <span class="mathjax-exps">$U_{2,15}$</span>&#xFF08;&#x672C;&#x5B50;&#x6BB5;&#x4E2D;&#x4E5F;&#x7B80;&#x8BB0;&#x4E3A; <span class="mathjax-exps">$U$</span>&#xFF09;&#xFF1A;</p>
<p></p><div class="mathjax-exps">$$U_{2,15}=\left[\begin{array}{cccccccccccccccc} 1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\ 0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\ 0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\ 0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\ 0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\ 0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0\\ 0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\ 0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0\\ 0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\ 0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0\\ 0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\ 0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0\\ 0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\ 0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0\\ 0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\ 0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1 \end{array}\right].\tag{6}$$</div><p></p>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7ED9;&#x51FA; <span class="mathjax-exps">$C(U_{2,15})$</span> &#x7684;&#x4E00;&#x79CD;&#x5206;&#x89E3;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF0C;&#x5176;&#x4EE5;&#x7B2C; <span class="mathjax-exps">$0$</span> &#x6BD4;&#x7279;&#x4E3A;&#x63A7;&#x5236;&#x6BD4;&#x7279;&#xFF0C;&#x7B2C; <span class="mathjax-exps">$1,2,3,4$</span> &#x6BD4;&#x7279;&#x6309;&#x987A;&#x5E8F;&#x4F5C;&#x4E3A; <span class="mathjax-exps">$U_{2,15}$</span> &#x7684;&#x4F5C;&#x7528;&#x6BD4;&#x7279;&#xFF1A;</p>
<p><img src="figures/CU_2_15.png" alt></p>
<p>&#x5BF9;&#x5E94; OPENQASM &#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="cpp{.line-numbers}" class="language-cpp line-numbers">OPENQASM <span class="token number">2.0</span><span class="token punctuation">;</span>
include <span class="token string">&quot;qelib1.inc&quot;</span><span class="token punctuation">;</span>
qreg q<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
creg c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
cswap q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
cswap q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
cswap q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>&#x53EF;&#x4EE5;&#x7B80;&#x8BB0;&#x4E3A;</p>
<p></p><div class="mathjax-exps">$$\begin{align*}C(U_{2,15})&amp;= \operatorname{CSWAP}_{0,3,4}\cdot\operatorname{CSWAP}_{0,2,3}\cdot\operatorname{CSWAP}_{0,1,2},\tag{7}\end{align*}$$</div><p></p>
<p>&#x8FD9;&#x91CC; <span class="mathjax-exps">$\operatorname{CSWAP}_{j,k,l}$</span> &#x4E3A;&#x7B2C; <span class="mathjax-exps">$j$</span> &#x6BD4;&#x7279;&#x4E3A;&#x63A7;&#x5236;&#x6BD4;&#x7279;&#x3001;&#x4EE5;&#x7B2C; <span class="mathjax-exps">$k$</span> &#x548C; <span class="mathjax-exps">$l$</span> &#x6BD4;&#x7279;&#x4E3A;&#x53D7;&#x63A7;&#x6BD4;&#x7279;&#x7684; <span class="mathjax-exps">$\operatorname{CSWAP}$</span> &#x95E8;&#x3002;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;&#x4E2D;&#x8FD8;&#x9700;&#x8981;&#x7528;&#x5230;&#x5176;&#x5B83; <span class="mathjax-exps">$C(U_{2,15}^{2^j})$</span>&#x95E8;:</p>
<p></p><div class="mathjax-exps">$$\begin{align*}C(U_{2,15}^2)&amp;= \operatorname{CSWAP}_{0,2,4}\cdot \operatorname{CSWAP}_{0,1,3};\tag{8}\\ C(U_{2,15}^{2^j}) &amp;= I,\quad j\ge3.\tag{9}\end{align*}$$</div><p></p>
<p>&#x4F7F;&#x7528; <span class="mathjax-exps">$2L+1=9$</span> &#x4E2A;&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#x4F30;&#x8BA1;&#x91CF;&#x5B50;&#x6001; <span class="mathjax-exps">$|0001\rangle$</span> &#x7684;&#x76F8;&#x4F4D;&#xFF0C;&#x91CF;&#x5B50;&#x4F5C;&#x66F2;&#x5BB6;&#x4E2D;&#x7684;&#x7535;&#x8DEF;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF08;&#x8FD9;&#x91CC;&#x7565;&#x53BB;&#x4E86;&#x53EF;&#x4EE5;&#x5FFD;&#x7565;&#x7684; <span class="mathjax-exps">$I$</span> &#x95E8;&#xFF09;&#xFF1A;</p>
<p><img src="figures/OrderFinding_2_15.png" alt="&#x8BA1;&#x7B97;  &#x7684;&#x91CF;&#x5B50;&#x4F5C;&#x66F2;&#x5BB6;&#x7535;&#x8DEF;"></p>
<p>&#x5176;&#x5BF9;&#x5E94;&#x7684; OPENQASM <a href="https://quantum-hub.baidu.com/#/">&#x4EE3;&#x7801;</a>&#x5982;&#x4E0B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="cpp{.line-numbers}OPENQASM 2.0;" class="language-cpp line-numbers">include <span class="token string">&quot;qelib1.inc&quot;</span><span class="token punctuation">;</span>
qreg q<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// q[0],...,q[8] &#x4E3A;&#x8F85;&#x52A9;&#x5BC4;&#x5B58;&#x5668;&#xFF0C;q[9],...,q[12] &#x4E3A;&#x5DE5;&#x4F5C;&#x5BC4;&#x5B58;&#x5668;</span>
creg c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
x q<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// &#x5236;&#x5907;&#x521D;&#x59CB;&#x72B6;&#x6001;|0&gt;|1&gt;&#xFF0C;&#x4E0B;&#x9762;&#x5F00;&#x59CB;&#x6267;&#x884C;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;</span>
h q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
h q<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
h q<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
h q<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
h q<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
h q<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
h q<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
h q<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
h q<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// &#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7684;&#x8F85;&#x52A9;&#x6B65;&#xFF0C;&#x5BF9;&#x8F85;&#x52A9;&#x5BC4;&#x5B58;&#x5668;&#x53D6;&#x5E73;&#x5747;&#x53E0;&#x52A0;&#x5B8C;&#x6BD5;</span>
cswap q<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
cswap q<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
cswap q<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// &#x4E0A;&#x4E00;&#x6CE8;&#x91CA;&#x81F3;&#x6B64;&#x5B9E;&#x73B0;&#x4E86; C(U) &#x95E8;&#xFF0C;q[8] &#x63A7;&#x5236;&#x5DE5;&#x4F5C;&#x5BC4;&#x5B58;&#x5668;</span>
cswap q<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
cswap q<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//&#x4E0A;&#x4E00;&#x6CE8;&#x91CA;&#x81F3;&#x6B64;&#x5B9E;&#x73B0;&#x4E86; C(U^2) &#x95E8;&#xFF0C;q[7] &#x63A7;&#x5236;&#x5DE5;&#x4F5C;&#x5BC4;&#x5B58;&#x5668;</span>
<span class="token comment">// &#x7565;&#x53BB;&#x4E3A; I &#x7684;&#x5176;&#x4ED6; C(U^(2^j)) &#x95E8;&#xFF0C;&#x51C6;&#x5907;&#x5F00;&#x59CB;&#x5BF9;&#x8F85;&#x52A9;&#x5BC4;&#x5B58;&#x5668;&#x505A;&#x9006; Fourier &#x53D8;&#x6362;</span>
<span class="token comment">// &#x9006; Fourier &#x53D8;&#x6362;&#x7684; SWAP &#x6B65;&#x9AA4;</span>
swap q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
swap q<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
swap q<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
swap q<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// &#x9006; Fourier &#x53D8;&#x6362;&#x7684;&#x63A7;&#x5236;&#x65CB;&#x8F6C;&#x6B65;&#x9AA4;</span>
h q<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
h q<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
h q<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
h q<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">16</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
h q<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">32</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">16</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
h q<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">64</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">32</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">16</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
h q<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">128</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">64</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">32</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">16</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
h q<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">256</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">128</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">64</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">32</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">16</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">cu</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> q<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
h q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// &#x9006; Fourier &#x53D8;&#x6362;&#x7ED3;&#x675F;&#xFF0C;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;&#x8FDB;&#x5165;&#x6D4B;&#x91CF;&#x9636;&#x6BB5;</span>
measure q<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
measure q<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
measure q<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
measure q<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
measure q<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
measure q<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
measure q<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
measure q<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
measure q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-&gt;</span> c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>&#x67D0;&#x6B21;&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token punctuation">{</span>
    <span class="token string">&quot;000000011&quot;</span><span class="token punctuation">:</span> <span class="token number">237</span><span class="token punctuation">,</span>
    <span class="token string">&quot;000000010&quot;</span><span class="token punctuation">:</span> <span class="token number">257</span><span class="token punctuation">,</span>
    <span class="token string">&quot;000000000&quot;</span><span class="token punctuation">:</span> <span class="token number">269</span><span class="token punctuation">,</span>
    <span class="token string">&quot;000000001&quot;</span><span class="token punctuation">:</span> <span class="token number">261</span>
<span class="token punctuation">}</span>
</pre><p>&#x6D4B;&#x91CF;&#x7ED3;&#x679C;&#x5927;&#x7EA6;&#x4E3A;&#x7B49;&#x9891;&#x7387;&#x7684; <span class="mathjax-exps">$|000000000\rangle$</span>&#xFF0C;<span class="mathjax-exps">$|010000000\rangle$</span>&#xFF0C;<span class="mathjax-exps">$|100000000\rangle$</span> &#x548C; <span class="mathjax-exps">$|110000000\rangle$</span>&#xFF0C;&#x5206;&#x522B;&#x5BF9;&#x5E94;&#x771F;&#x5206;&#x6570; <span class="mathjax-exps">$0$</span>&#xFF0C;<span class="mathjax-exps">$1/4$</span>&#xFF0C;<span class="mathjax-exps">$1/2$</span> &#x548C; <span class="mathjax-exps">$3/4$</span>&#x3002;&#x8FD9;&#x91CC;&#x4EC5; <span class="mathjax-exps">$3/4$</span> &#x53EF;&#x4EE5;&#x505A;&#x8FDE;&#x5206;&#x6570;&#x5C55;&#x5F00;&#xFF1A;</p>
<p></p><div class="mathjax-exps">$$\frac{3}{4}=\frac{1}{1+\frac{1}{3}},\tag{10}$$</div><p></p>
<p>&#x5176;&#x7B2C; <span class="mathjax-exps">$1$</span> &#x622A;&#x65AD;&#x4E3A; <span class="mathjax-exps">$1$</span>&#x3002;</p>
<p>&#x6545;&#x800C;&#x6BCF;&#x6B21;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;&#x6709;&#x7EA6; <span class="mathjax-exps">$1/2$</span> &#x7684;&#x6982;&#x7387;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x6B63;&#x786E;&#x7ED3;&#x679C; <span class="mathjax-exps">${\rm ord}(2,15)=4$</span>&#xFF0C;&#x4E24;&#x6B21;&#x5B9E;&#x9A8C;&#x6709;&#x7EA6; <span class="mathjax-exps">$3/4$</span> &#x7684;&#x6982;&#x7387;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x6B63;&#x786E;&#x7ED3;&#x679C;&#x3002;<br>
&#x7531; <span class="mathjax-exps">$2^{4/2} = 4\not\equiv -1\pmod{15}$</span> &#x77E5; <span class="mathjax-exps">$15|(4-1)(4+1)$</span> &#x8BF1;&#x5BFC;&#x4E86; <span class="mathjax-exps">$15$</span> &#x7684;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x5206;&#x89E3;&#xFF1A;</p>
<p></p><div class="mathjax-exps">$$15=\textrm{gcd}(15,4-1)\times\textrm{gcd}(15,4+1)=3\times5.\tag{11}$$</div><p></p>
<p>&#x81F3;&#x6B64;&#x5B8C;&#x6210;&#x4E86; Shor &#x7B97;&#x6CD5;&#x5206;&#x89E3; <span class="mathjax-exps">$15$</span> &#x7684;&#x6F14;&#x793A;&#x3002;</p>
<p>&#x540E;&#x8BDD;&#xFF1A;&#x4EE3;&#x7801;&#x6F14;&#x793A;&#x4E2D;&#x201C;&#x7565;&#x53BB;&#x4E3A; <span class="mathjax-exps">$I$</span> &#x7684;&#x5176;&#x4ED6; <span class="mathjax-exps">$C(U^{2^j})$</span> &#x95E8;&#x201D;&#x6709;&#x5FAA;&#x73AF;&#x8BBA;&#x8BC1;&#x4E4B;&#x5ACC;&#xFF0C;&#x6B63;&#x786E;&#x7684;&#x6F14;&#x793A;&#x5E94;&#x5F53;&#x5C06;&#x8FD9;&#x4E9B;&#x95E8;&#x9010;&#x4E2A;&#x5206;&#x89E3;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x5229;&#x7528;&#x7406;&#x8BBA;&#x8BC1;&#x660E;&#x7684;&#x65B9;&#x6CD5;&#x8BA1;&#x7B97;&#x5F97;&#x51FA; <span class="mathjax-exps">$C(U^{2^j})=I$</span>&#xFF0C;&#x5728;&#x4E0B;&#x4E00;&#x5B50;&#x6BB5;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5728;&#x6F14;&#x793A; <span class="mathjax-exps">$63$</span> &#x7684;&#x5206;&#x89E3;&#x65F6;&#x907F;&#x5F00;&#x4E86;&#x8FD9;&#x4E00;&#x95EE;&#x9898;&#x3002;</p>
<h4 class="mume-header" id="%E6%B1%82-rm-ord263-%E5%B9%B6%E5%88%86%E8%A7%A3-63">&#x6C42; <span class="mathjax-exps">${\rm ord}(2,63)$</span> &#x5E76;&#x5206;&#x89E3; <span class="mathjax-exps">$63$</span></h4>

<p>&#x5728;&#x672C;&#x5B50;&#x6BB5;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;<a href="https://quantum-hub.baidu.com/#/">&#x91CF;&#x6613;&#x4F0F;</a>&#x7684;&#x91CF;&#x5B50;&#x5728;&#x7EBF;&#x5E73;&#x53F0;&#x6765;&#x6F14;&#x793A; Shor &#x7B97;&#x6CD5;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x9700;&#x8981; <span class="mathjax-exps">$L=\lceil \log_2(63+1)\rceil=6$</span> &#x4E2A;&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#x6765;&#x7F16;&#x7801;&#x7B97;&#x7B26; <span class="mathjax-exps">$U_{2,63}$</span>&#xFF08;&#x672C;&#x5B50;&#x6BB5;&#x4E2D;&#x4E5F;&#x7B80;&#x8BB0;&#x4E3A; <span class="mathjax-exps">$U$</span>&#xFF09;&#xFF0C;&#x4F7F;&#x7528; <span class="mathjax-exps">$2L+1=13$</span> &#x4E2A;&#x8F85;&#x52A9;&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#x6765;&#x4F30;&#x8BA1;&#x76F8;&#x4F4D;&#x3002;&#x8003;&#x8651;&#x5230; <span class="mathjax-exps">$j&gt;0$</span> &#x65F6;&#x6709;</p>
<p></p><div class="mathjax-exps">$$U^{2^j}=U^{2^{j\rm{\ mod\ }2}},\tag{12}$$</div><p></p>
<p>&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x5206;&#x89E3;&#x95E8; <span class="mathjax-exps">$C(U)$</span>&#xFF0C;<span class="mathjax-exps">$C(U^{2})$</span> &#x548C; <span class="mathjax-exps">$C(U^{4})$</span>&#xFF1A;</p>
<p></p><div class="mathjax-exps">$$\begin{align*} C(U)&amp;= \operatorname{CSWAP}_{0,1,2}\cdot\operatorname{CSWAP}_{0,2,3}\cdot\operatorname{CSWAP}_{0,3,4}\cdot\operatorname{CSWAP}_{0,4,5}\cdot\operatorname{CSWAP}_{0,5,6};\tag{13}\\ C(U^2)&amp;= \operatorname{CSWAP}_{0,3,5}\cdot \operatorname{CSWAP}_{0,1,3}\cdot\operatorname{CSWAP}_{0,4,6}\cdot \operatorname{CSWAP}_{0,2,4};\tag{14}\\ C(U^{4}) &amp;=\operatorname{CSWAP}_{0,1,3} \cdot \operatorname{CSWAP}_{0,3,5}\cdot\operatorname{CSWAP}_{0,2,4}\cdot \operatorname{CSWAP}_{0,4,6}.\tag{15} \end{align*}$$</div><p></p>
<p><a href="https://quantum-hub.baidu.com/#/">&#x91CF;&#x5B50;&#x5728;&#x7EBF;&#x5E73;&#x53F0;</a>&#x4E2D;&#x7684;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="python{.numberLines}" class="language-python line-numbers"><span class="token keyword">from</span> QCompute <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> pi


<span class="token keyword">def</span> <span class="token function">func_order_finding_2_mod_63</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5C06;&#x4F1A;&#x8FD4;&#x56DE;&#x7279;&#x5F81;&#x76F8;&#x4F4D;&#x56E0;&#x5B50; s/6 &#x7684;&#x903C;&#x8FD1;&#xFF0C;&#x5176;&#x4E2D; 6 &#x662F; 2 &#x6A21; 63 &#x7684;&#x9636;&#xFF0C;s=0,1,...,5
    &quot;&quot;&quot;</span>
    env <span class="token operator">=</span> QEnv<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># &#x521B;&#x5EFA;&#x73AF;&#x5883;</span>
    env<span class="token punctuation">.</span>backend<span class="token punctuation">(</span>BackendName<span class="token punctuation">.</span>LocalBaiduSim2<span class="token punctuation">)</span>  <span class="token comment"># &#x9009;&#x62E9;&#x540E;&#x7AEF; LocalBaiduSim2</span>

    L <span class="token operator">=</span> <span class="token number">6</span>  <span class="token comment"># &#x7F16;&#x7801; U &#x95E8;&#x9700;&#x8981;&#x7684;&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#x6570;&#x3001;&#x5DE5;&#x4F5C;&#x5BC4;&#x5B58;&#x5668;&#x7684;&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#x6570;</span>
    N <span class="token operator">=</span> <span class="token number">3</span> <span class="token operator">*</span> L <span class="token operator">+</span> <span class="token number">1</span>  <span class="token comment"># &#x7B97;&#x6CD5;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x7684;&#x603B;&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#x6570;</span>
    t <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> L <span class="token operator">+</span> <span class="token number">1</span>  <span class="token comment"># &#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;&#x6240;&#x9700;&#x7684;&#x8F85;&#x52A9;&#x6BD4;&#x7279;&#x6570;&#x3001;&#x8F85;&#x52A9;&#x5BC4;&#x5B58;&#x5668;&#x7684;&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#x6570;</span>

    q <span class="token operator">=</span> env<span class="token punctuation">.</span>Q<span class="token punctuation">.</span>createList<span class="token punctuation">(</span>N<span class="token punctuation">)</span>  <span class="token comment"># &#x751F;&#x6210;&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#x7684;&#x5217;&#x8868;</span>

    X<span class="token punctuation">(</span>q<span class="token punctuation">[</span>N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># &#x5728;&#x5DE5;&#x4F5C;&#x5BC4;&#x5B58;&#x5668;&#x5236;&#x5907;&#x521D;&#x59CB;&#x72B6;&#x6001; |1&gt;&#xFF0C;&#x4E0B;&#x9762;&#x5F00;&#x59CB;&#x6267;&#x884C;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">:</span>
        H<span class="token punctuation">(</span>q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># &#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7684;&#x7B2C;&#x4E00;&#x6B65;&#xFF0C;&#x5BF9;&#x8F85;&#x52A9;&#x5BC4;&#x5B58;&#x5668;&#x53D6;&#x5E73;&#x5747;&#x53E0;&#x52A0;&#x5B8C;&#x6BD5;&#xFF0C;&#x4E0B;&#x9762;&#x5F00;&#x59CB;&#x5C06;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;&#x7684;&#x8F6C;&#x5B58;&#x6B65;&#x9AA4;</span>

    CSWAP<span class="token punctuation">(</span>q<span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> L<span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    CSWAP<span class="token punctuation">(</span>q<span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> L<span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    CSWAP<span class="token punctuation">(</span>q<span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> L<span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    CSWAP<span class="token punctuation">(</span>q<span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> L<span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    CSWAP<span class="token punctuation">(</span>q<span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> L<span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># &#x4E0A;&#x4E00;&#x6CE8;&#x91CA;&#x81F3;&#x6B64;&#x5B9E;&#x73B0;&#x4E86;&#x95E8; C(U)&#xFF0C;&#x8F85;&#x52A9;&#x5BC4;&#x5B58;&#x5668;&#x7684;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#x63A7;&#x5236;&#x5DE5;&#x4F5C;&#x5BC4;&#x5B58;&#x5668;</span>

    s <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> L <span class="token operator">-</span> <span class="token number">1</span>  <span class="token comment"># &#x51C6;&#x5907;&#x4F9D;&#x6B21;&#x4F5C;&#x7528;&#x5176;&#x4ED6; C(U^(2^j)) &#x95E8;&#xFF0C;q[s] &#x5373;&#x95E8;&#x7684;&#x63A7;&#x5236;&#x91CF;&#x5B50;&#x4F4D;</span>
    <span class="token keyword">while</span> s <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> s <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            CSWAP<span class="token punctuation">(</span>q<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            CSWAP<span class="token punctuation">(</span>q<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            CSWAP<span class="token punctuation">(</span>q<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            CSWAP<span class="token punctuation">(</span>q<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># &#x672C;&#x6761;&#x4EF6;&#x4E0B;&#x7684;&#x95E8;&#x7EC4;&#x5408;&#x540E;&#x5373;&#x95E8; C(U^2)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            CSWAP<span class="token punctuation">(</span>q<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            CSWAP<span class="token punctuation">(</span>q<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            CSWAP<span class="token punctuation">(</span>q<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            CSWAP<span class="token punctuation">(</span>q<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># &#x672C;&#x6761;&#x4EF6;&#x4E0B;&#x7684;&#x95E8;&#x7EC4;&#x5408;&#x540E;&#x5373;&#x95E8; C(U^4)</span>
        s <span class="token operator">-=</span> <span class="token number">1</span>  <span class="token comment"># &#x6307;&#x9488;&#x79FB;&#x52A8;&#x5230;&#x66F4;&#x9AD8;&#x4F4D;&#x7684;&#x8F85;&#x52A9;&#x6BD4;&#x7279;&#x4E0A;&#x53BB;</span>

    <span class="token comment"># &#x9006; Fourier &#x53D8;&#x6362;&#x4E2D;&#x7684; SWAP &#x6B65;&#x9AA4;</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>t <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        SWAP<span class="token punctuation">(</span>q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token comment"># &#x9006; Fourier &#x53D8;&#x6362;&#x4E2D;&#x7684;&#x63A7;&#x5236;&#x65CB;&#x8F6C;&#x6B65;&#x9AA4;</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>t <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        H<span class="token punctuation">(</span>q<span class="token punctuation">[</span>t <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            CU<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>pi <span class="token operator">/</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>q<span class="token punctuation">[</span>t <span class="token operator">-</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span>t <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    H<span class="token punctuation">(</span>q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token comment"># &#x5B8C;&#x6210;&#x9006; Fourier &#x53D8;&#x6362;&#xFF0C;&#x5B8C;&#x6210;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;&#xFF0C;&#x7B49;&#x5F85;&#x6D4B;&#x91CF;</span>
    MeasureZ<span class="token punctuation">(</span>q<span class="token punctuation">[</span><span class="token punctuation">:</span>t<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># &#x53EA;&#x6D4B;&#x91CF;&#x8F85;&#x52A9;&#x5BC4;&#x5B58;&#x5668;&#x5373;&#x524D; t &#x4E2A;&#x6BD4;&#x7279;</span>
    env<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token number">8192</span><span class="token punctuation">,</span> downloadResult<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    func_order_finding_2_mod_63<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>&#x6267;&#x884C;&#x91CF;&#x5B50;&#x7B97;&#x6CD5; <span class="mathjax-exps">$8192$</span> &#x6B21;&#xFF0C;&#x5FFD;&#x7565;&#x603B;&#x9891;&#x6B21; <span class="mathjax-exps">$5\%$</span> &#x7684;&#x4E00;&#x4E9B;&#x5C0F;&#x6982;&#x7387;&#x7ED3;&#x679C;&#xFF0C;&#x5176;&#x4F59;&#x7ED3;&#x679C;&#x7ECF;&#x6570;&#x636E;&#x5904;&#x7406;&#x540E;&#x5982;&#x4E0B;&#xFF0C;&#x5176;&#x4E2D; <code>&quot;4096&quot;: 1419</code> &#x8868;&#x793A; <span class="mathjax-exps">$|4096\rangle$</span> &#x51FA;&#x73B0;&#x4E86; <span class="mathjax-exps">$1419$</span> &#x6B21;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token punctuation">{</span>
    <span class="token string">&quot;4096&quot;</span><span class="token punctuation">:</span> <span class="token number">1419</span><span class="token punctuation">,</span>
    <span class="token string">&quot;0&quot;</span><span class="token punctuation">:</span> <span class="token number">1287</span><span class="token punctuation">,</span>
    <span class="token string">&quot;5461&quot;</span><span class="token punctuation">:</span> <span class="token number">955</span><span class="token punctuation">,</span>
    <span class="token string">&quot;2731&quot;</span><span class="token punctuation">:</span> <span class="token number">955</span><span class="token punctuation">,</span>
    <span class="token string">&quot;1365&quot;</span><span class="token punctuation">:</span> <span class="token number">940</span><span class="token punctuation">,</span>
    <span class="token string">&quot;6827&quot;</span><span class="token punctuation">:</span> <span class="token number">896</span><span class="token punctuation">,</span>
    <span class="token string">&quot;6826&quot;</span><span class="token punctuation">:</span> <span class="token number">252</span><span class="token punctuation">,</span>
    <span class="token string">&quot;1366&quot;</span><span class="token punctuation">:</span> <span class="token number">250</span><span class="token punctuation">,</span>
    <span class="token string">&quot;2730&quot;</span><span class="token punctuation">:</span> <span class="token number">246</span><span class="token punctuation">,</span>
    <span class="token string">&quot;5462&quot;</span><span class="token punctuation">:</span> <span class="token number">219</span><span class="token punctuation">,</span>
    <span class="token string">&quot;2732&quot;</span><span class="token punctuation">:</span> <span class="token number">56</span><span class="token punctuation">,</span>
    <span class="token string">&quot;5460&quot;</span><span class="token punctuation">:</span> <span class="token number">53</span><span class="token punctuation">,</span>
    <span class="token string">&quot;6828&quot;</span><span class="token punctuation">:</span> <span class="token number">52</span><span class="token punctuation">,</span>
    <span class="token string">&quot;1364&quot;</span><span class="token punctuation">:</span> <span class="token number">49</span><span class="token punctuation">,</span>
    <span class="token string">&quot;2729&quot;</span><span class="token punctuation">:</span> <span class="token number">47</span><span class="token punctuation">,</span>
    <span class="token string">&quot;1367&quot;</span><span class="token punctuation">:</span> <span class="token number">41</span><span class="token punctuation">,</span>
    <span class="token string">&quot;5463&quot;</span><span class="token punctuation">:</span> <span class="token number">36</span><span class="token punctuation">,</span>
    <span class="token string">&quot;6825&quot;</span><span class="token punctuation">:</span> <span class="token number">34</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> 
</pre><p>&#x5206;&#x522B;&#x5BF9;&#x8FD9;&#x4E9B;&#x7ED3;&#x679C;&#x5BF9;&#x5E94;&#x7684;&#x5206;&#x6570;&#x505A;&#x8FDE;&#x5206;&#x6570;&#x5C55;&#x5F00;&#x5E76;&#x622A;&#x65AD;&#xFF0C;&#x5F97;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token punctuation">{</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token number">1419</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token number">1287</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5461</span><span class="token operator">/</span><span class="token number">8192</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token number">955</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2731</span><span class="token operator">/</span><span class="token number">8192</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token number">955</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">682</span><span class="token operator">/</span><span class="token number">4093</span><span class="token punctuation">,</span> <span class="token number">1365</span><span class="token operator">/</span><span class="token number">8192</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token number">940</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token operator">/</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3411</span><span class="token operator">/</span><span class="token number">4093</span><span class="token punctuation">,</span> <span class="token number">6827</span><span class="token operator">/</span><span class="token number">8192</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token number">896</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token operator">/</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1704</span><span class="token operator">/</span><span class="token number">2045</span><span class="token punctuation">,</span> <span class="token number">3413</span><span class="token operator">/</span><span class="token number">4096</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token number">252</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">341</span><span class="token operator">/</span><span class="token number">2045</span><span class="token punctuation">,</span> <span class="token number">683</span><span class="token operator">/</span><span class="token number">4096</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token number">250</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1365</span><span class="token operator">/</span><span class="token number">4096</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token number">246</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2731</span><span class="token operator">/</span><span class="token number">4096</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token number">219</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">683</span><span class="token operator">/</span><span class="token number">2048</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token number">56</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1365</span><span class="token operator">/</span><span class="token number">2048</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token number">53</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token operator">/</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">851</span><span class="token operator">/</span><span class="token number">1021</span><span class="token punctuation">,</span> <span class="token number">1707</span><span class="token operator">/</span><span class="token number">2048</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token number">52</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">170</span><span class="token operator">/</span><span class="token number">1021</span><span class="token punctuation">,</span> <span class="token number">341</span><span class="token operator">/</span><span class="token number">2048</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token number">49</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">545</span><span class="token operator">/</span><span class="token number">1636</span><span class="token punctuation">,</span> <span class="token number">546</span><span class="token operator">/</span><span class="token number">1639</span><span class="token punctuation">,</span> <span class="token number">2729</span><span class="token operator">/</span><span class="token number">8192</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token number">47</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">136</span><span class="token operator">/</span><span class="token number">815</span><span class="token punctuation">,</span> <span class="token number">137</span><span class="token operator">/</span><span class="token number">821</span><span class="token punctuation">,</span> <span class="token number">410</span><span class="token operator">/</span><span class="token number">2457</span><span class="token punctuation">,</span> <span class="token number">1367</span><span class="token operator">/</span><span class="token number">8192</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token number">41</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1091</span><span class="token operator">/</span><span class="token number">1636</span><span class="token punctuation">,</span> <span class="token number">1093</span><span class="token operator">/</span><span class="token number">1639</span><span class="token punctuation">,</span> <span class="token number">5463</span><span class="token operator">/</span><span class="token number">8192</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token number">36</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token operator">/</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">679</span><span class="token operator">/</span><span class="token number">815</span><span class="token punctuation">,</span> <span class="token number">684</span><span class="token operator">/</span><span class="token number">821</span><span class="token punctuation">,</span> <span class="token number">2047</span><span class="token operator">/</span><span class="token number">2457</span><span class="token punctuation">,</span> <span class="token number">6825</span><span class="token operator">/</span><span class="token number">8192</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token number">34</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span> 
</pre><p>&#x8003;&#x8651;&#x5404;&#x884C;&#x7B2C;&#x4E00;&#x4E2A;&#x5206;&#x91CF;&#x4E2D;&#x4E0D;&#x8D85;&#x8FC7; <span class="mathjax-exps">$N=63$</span> &#x7684;&#x6700;&#x5927;&#x5206;&#x6BCD;&#xFF08;&#x8FD9;&#x91CC;&#x4EC5;&#x6709; <span class="mathjax-exps">$1,2,3,6$</span>&#xFF09;&#xFF0C;<br>
&#x5176;&#x4E2D;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x7684;&#x5206;&#x6BCD;&#x4E3A; <span class="mathjax-exps">$2$</span>&#xFF0C;<span class="mathjax-exps">$3$</span> &#x548C; <span class="mathjax-exps">$6$</span> &#x7684;&#x9891;&#x6B21;&#x5206;&#x522B;&#x4E3A; <span class="mathjax-exps">$1419$</span>&#xFF0C;<span class="mathjax-exps">$2567$</span> &#x548C; <span class="mathjax-exps">$2514$</span>&#x3002;&#x8003;&#x8651;&#x5230; <span class="mathjax-exps">$\rm{ord}(2,63)=6$</span>&#xFF0C;&#x6545;&#x800C;&#x6267;&#x884C;&#x4E00;&#x6B21;&#x91CF;&#x5B50;&#x7535;&#x8DEF;&#x7136;&#x540E;&#x505A;&#x8FDE;&#x5206;&#x6570;&#x5C55;&#x5F00;&#x7B97;&#x6CD5;&#x6709;&#x7EA6; <span class="mathjax-exps">$2514/8192 \approx 30.7\%$</span> &#x7684;&#x6982;&#x7387;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x6B63;&#x786E;&#x7ED3;&#x679C; <span class="mathjax-exps">${\rm ord}(2,63)=6$</span>&#xFF0C;&#x4E24;&#x6B21;&#x5B9E;&#x9A8C;&#x6709;&#x7EA6;</p>
<p></p><div class="mathjax-exps">$$1-\left(1-\frac{2514}{8192}\right)^2+2 * \frac{1419}{8192} * \frac{2567}{8192}\approx 62.8\%\tag{16}$$</div><p></p>
<p>&#x7684;&#x6982;&#x7387;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x6B63;&#x786E;&#x7ED3;&#x679C; <span class="mathjax-exps">${\rm ord}(2,63)=6$</span>&#xFF0C;&#x8FD9;&#x91CC;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x52A0;&#x9879;&#x8868;&#x793A;&#x4E24;&#x6B21;&#x6D4B;&#x91CF;&#x4E2D;&#x4E00;&#x6B21;&#x7ED3;&#x679C;&#x4E3A; <span class="mathjax-exps">$2$</span> &#x800C;&#x53E6;&#x4E00;&#x6B21;&#x4E3A; <span class="mathjax-exps">$3$</span>&#x3002;&#x7531; <span class="mathjax-exps">$2^{6/2} = 8\not\equiv -1\pmod{63}$</span> &#x77E5; <span class="mathjax-exps">$63|(8-1)(8+1)$</span> &#x8BF1;&#x5BFC;&#x4E86; <span class="mathjax-exps">$63$</span> &#x7684;&#x4E00;&#x4E2A;&#x4E0D;&#x5E73;&#x51E1;&#x7684;&#x5206;&#x89E3;&#xFF1A;</p>
<p></p><div class="mathjax-exps">$$63=\textrm{gcd}(63,8-1)\times\textrm{gcd}(63,8+1)=7\times9.\tag{17}$$</div><p></p>
<p>&#x8FD9;&#x91CC;&#x867D;&#x7136;&#x6CA1;&#x6709;&#x4E86;&#x5FAA;&#x73AF;&#x8BBA;&#x8BC1;&#x4E4B;&#x5ACC;&#xFF0C;&#x4F46;&#x662F;&#x4ECE;</p>
<p></p><div class="mathjax-exps">$$U^{2^3}=U^2\tag{18}$$</div><p></p>
<p>&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5E94;&#x5F53;&#x80FD;&#x76F4;&#x63A5;&#x5F97;&#x5230; <span class="mathjax-exps">$U^{2^3-2}=I$</span>&#xFF0C;<span class="mathjax-exps">$\rm{ord}(2,63)\,|\,(2^3-2)=6$</span>&#xFF0C;&#x53C8;&#x9677;&#x5165;&#x4E86;&#x820D;&#x8FD1;&#x6C42;&#x8FDC;&#x4E4B;&#x5ACC;&#x3002;</p>
<h2 class="mume-header" id="cu_an-%E9%97%A8%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="mathjax-exps">$C(U_{a,N})$</span> &#x95E8;&#x7684;&#x5B9E;&#x73B0;</h2>

<p>&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x820D;&#x8FD1;&#x6C42;&#x8FDC;&#x7684;&#x5ACC;&#x7591;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x901A;&#x7528;&#x7684; Shor &#x7B97;&#x6CD5;&#x5B9E;&#x73B0;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4E00;&#x79CD;&#x901A;&#x7528;&#x7684;&#x7B97;&#x6CD5;&#xFF0C;&#x53EF;&#x4EE5;&#x8BA1;&#x7B97;&#x51FA;&#x91CF;&#x5B50;&#x95E8; <span class="mathjax-exps">$C(U_{a,N})$</span> &#x7684;&#x5206;&#x89E3;&#x5F62;&#x5F0F;&#x3002;&#x5728;&#x4E0A;&#x4E00;&#x4E2A;&#x5B50;&#x6BB5;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x4EE3;&#x6570;&#x624B;&#x6BB5;&#x5C06; <span class="mathjax-exps">$C(U_{a,N})$</span> &#x5206;&#x89E3;&#x4E3A; <span class="mathjax-exps">$\operatorname{CSWAP}$</span> &#x95E8;&#x7684;&#x7EC4;&#x5408;&#xFF0C;&#x5E76;&#x501F;&#x7531;&#x7ECF;&#x5178;&#x8BA1;&#x7B97;&#x7B80;&#x5316;&#x4E86; <span class="mathjax-exps">$C(U_{a,N}^{2^j})$</span> &#x95E8;&#x3002;&#x8FD9;&#x5728;&#x903B;&#x8F91;&#x4E0A;&#x5176;&#x5B9E;&#x662F;&#x8BF4;&#x4E0D;&#x901A;&#x7684;&#xFF0C;&#x65E0;&#x8BBA;&#x662F;&#x95E8;&#x7684;&#x5206;&#x89E3;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x8FD8;&#x662F;&#x7701;&#x7565;&#x8BA1;&#x7B97;&#x7684;&#x8FC7;&#x7A0B;&#x90FD;&#x6709;&#x5FAA;&#x73AF;&#x8BBA;&#x8BC1;&#x4E4B;&#x5ACC;&#xFF1A;&#x6D89;&#x53CA;&#x5230;&#x6216;&#x8005;&#x8574;&#x542B;&#x5230;&#x5DF2;&#x77E5; <span class="mathjax-exps">$N$</span> &#x7684;&#x5206;&#x89E3;&#x8FD9;&#x4E00;&#x4E8B;&#x5B9E;&#x3002;&#x82E5;&#x60F3;&#x5F15;&#x5165;&#x4E00;&#x4E2A;&#x5E38;&#x89C4;&#x7684;&#x6CDB;&#x7528;&#x7684; <span class="mathjax-exps">$C(U_{a,N})$</span> &#x95E8;&#x7684;&#x5206;&#x89E3;&#x53EF;&#x4EE5;&#x53C2;&#x7167;&#x6587;&#x732E; <span class="mathjax-exps">$[6,7]$</span> &#x7B49;&#x3002;</p>
<p>&#x9664;&#x4E86;&#x8FD9;&#x79CD;&#x4E3A;&#x4E86;&#x63A7;&#x5236;&#x8F85;&#x52A9;&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#x6570;&#x91CF;&#x800C;&#x8BBE;&#x8BA1;&#x7684;&#x590D;&#x6742;&#x7684;&#x65B9;&#x6CD5;&#x4E4B;&#x5916;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x501F;&#x52A9;&#x7ECF;&#x5178;&#x7684;&#x53EF;&#x9006;&#x8BA1;&#x7B97;&#x7684;&#x9014;&#x5F84;&#x6765;&#x5B9E;&#x73B0; <span class="mathjax-exps">$C(U_{a,N})$</span>&#x3002;</p>
<h3 class="mume-header" id="%E5%8F%AF%E9%80%86%E8%AE%A1%E7%AE%97">&#x53EF;&#x9006;&#x8BA1;&#x7B97;</h3>

<h4 class="mume-header" id="%E4%BB%8E%E7%BB%8F%E5%85%B8%E5%8F%AF%E9%80%86%E8%AE%A1%E7%AE%97%E5%BC%80%E5%A7%8B">&#x4ECE;&#xFF08;&#x7ECF;&#x5178;&#xFF09;&#x53EF;&#x9006;&#x8BA1;&#x7B97;&#x5F00;&#x59CB;</h4>

<p>&#x4EC0;&#x4E48;&#x662F;&#x7ECF;&#x5178;&#x7684;&#x53EF;&#x9006;&#x8BA1;&#x7B97;&#xFF1F;&#x5927;&#x5BB6;&#x5E94;&#x8BE5;&#x90FD;&#x77E5;&#x9053;&#x7ECF;&#x5178;&#x8BA1;&#x7B97;&#x673A;&#x662F;&#x57FA;&#x4E8E; 2 &#x8FDB;&#x5236;&#x6570;&#x53CA;&#x903B;&#x8F91;&#x8FD0;&#x7B97;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x903B;&#x8F91;&#x8FD0;&#x7B97;&#x4E00;&#x822C;&#x7528;&#x4E09;&#x79CD;&#x57FA;&#x672C;&#x7684;&#x95E8;&#x201C;&#x4E0E;&#x201D;&#x95E8; <span class="mathjax-exps">$\wedge$</span>&#x3001;&#x201C;&#x6216;&#x201D;&#x95E8; <span class="mathjax-exps">$\vee$</span> &#x548C;&#x201C;&#x975E;&#x201D;&#x95E8; <span class="mathjax-exps">$\neg$</span> &#x6765;&#x5B9E;&#x73B0;&#xFF0C;&#x9664;&#x53BB;&#x201C;&#x975E;&#x201D;&#x95E8;&#x5916;&#xFF0C;&#x201C;&#x4E0E;&#x201D;&#x95E8;&#x548C;&#x201C;&#x6216;&#x201D;&#x95E8;&#x90FD;&#x662F;&#x4E24;&#x4E2A;&#x8F93;&#x5165;&#x4E00;&#x4E2A;&#x8F93;&#x51FA;&#xFF1A;</p>
<p></p><div class="mathjax-exps">$$\forall a,b\in\{0,1\},\ a\wedge b=ab,\ a\vee b=\neg(\neg a\wedge\neg b)=1-(1-a)(1-b),\ \neg a=1-a.\tag{19}$$</div><p></p>
<p>&#x8FD9;&#x79CD;&#x65E0;&#x6CD5;&#x4ECE;&#x8F93;&#x51FA;&#x5B8C;&#x5168;&#x6062;&#x590D;&#x51FA;&#x8F93;&#x5165;&#x4FE1;&#x606F;&#x7684;&#x8BA1;&#x7B97;&#x5C31;&#x88AB;&#x79F0;&#x4E3A;&#x4E0D;&#x53EF;&#x9006;&#x8BA1;&#x7B97;&#xFF0C;&#x53CD;&#x4E4B;&#x79F0;&#x4E3A; <strong>&#x53EF;&#x9006;&#x8BA1;&#x7B97;</strong>&#x3002;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x5BF9;&#x53EF;&#x9006;&#x8BA1;&#x7B97;&#x800C;&#x8A00;&#xFF0C;&#x8F93;&#x5165;&#x4E0E;&#x8F93;&#x51FA;&#x7684;&#x6BD4;&#x7279;&#x6570;&#x91CF;&#x5E94;&#x5F53;&#x76F8;&#x7B49;&#xFF0C;&#x6BD4;&#x5982;&#x4E0A;&#x8FF0;&#x7684;&#x201C;&#x975E;&#x201D;&#x95E8;&#x5C31;&#x662F;&#x53EF;&#x9006;&#x8BA1;&#x7B97;&#x3002;</p>
<p>&#x53EF;&#x4EE5;&#x9884;&#x6599;&#x5230;&#x5F53;&#x6211;&#x4EEC;&#x4FDD;&#x7559;&#x8F93;&#x5165;&#x4FE1;&#x606F;&#xFF0C;&#x5E76;&#x5728;&#x989D;&#x5916;&#x7684;&#x5BC4;&#x5B58;&#x5668;&#x4E0A;&#x5B9E;&#x73B0;&#x8BA1;&#x7B97;&#x65F6;&#xFF0C;&#x5B9E;&#x73B0;&#x7684;&#x8BA1;&#x7B97;&#x5FC5;&#x7136;&#x662F;&#x53EF;&#x9006;&#x8BA1;&#x7B97;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;</p>
<p></p><div class="mathjax-exps">$$(a,b,c)\rightarrow(a,b,c\oplus f(a,b)),\tag{20}$$</div><p></p>
<p>&#x8FD9;&#x91CC; <span class="mathjax-exps">$f(a,b)$</span> &#x662F;&#x4EFB;&#x610F;&#x4E00;&#x4E2A; <span class="mathjax-exps">$\{0,1\}^2\rightarrow\{0,1\}$</span> &#x7684;&#x51FD;&#x6570;&#xFF0C;<span class="mathjax-exps">$x\oplus y:=x+y\text{ mod }2$</span> &#x662F; <span class="mathjax-exps">$x$</span> &#x548C; <span class="mathjax-exps">$y$</span> &#x7684;&#x201C;&#x5F02;&#x6216;&#x201D;&#x8FD0;&#x7B97;&#x7ED3;&#x679C;&#x3002;</p>
<p>&#x6700;&#x540E;&#x6211;&#x4EEC;&#x6765;&#x8BB2;&#xFF0C;&#x901A;&#x8FC7;&#x5F15;&#x5165;&#x8F85;&#x52A9;&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#xFF0C;&#x91CF;&#x5B50;&#x8BA1;&#x7B97;&#x4E2D;&#x7684; <span class="mathjax-exps">$X$</span> &#x95E8;&#x3001;<span class="mathjax-exps">$C(X)$</span> &#x95E8;&#x548C; Toffoli &#x95E8; <span class="mathjax-exps">$C^2(X)$</span>&#xFF0C;&#x4FBF;&#x53EF;&#x6A21;&#x62DF;&#x6240;&#x6709;&#x7684;&#x53EF;&#x9006;&#x8BA1;&#x7B97;&#xFF0C;&#x5176;&#x4E2D;&#xFF1A;</p>
<p></p><div class="mathjax-exps">$$\begin{align*} X|a\rangle=&amp;\ |\neg a\rangle,\\ C^2(X)|a\rangle|b\rangle|0\rangle =&amp;\ |a\rangle|b\rangle|a\wedge b\rangle,\\ C(X)|a\rangle|0\rangle =&amp;\ |a\rangle|a\rangle=:\operatorname{FANOUT}|a\rangle, \end{align*}\tag{21}$$</div><p></p>
<p>&#x8FD9;&#x91CC;&#x201C;&#x6247;&#x51FA;&#x201D; <span class="mathjax-exps">$\operatorname{FANOUT}$</span> &#x662F;&#x5C06;&#x4E00;&#x4E2A;&#x7ECF;&#x5178;&#x6BD4;&#x7279;&#x590D;&#x5236;&#x4E3A;&#x4E24;&#x4EFD;&#xFF0C;&#x8FD9;&#x5728;&#x91CF;&#x5B50;&#x8BA1;&#x7B97;&#x5BF9;&#x8BA1;&#x7B97;&#x57FA;&#x80FD;&#x6709;&#x6548;&#x5B9E;&#x73B0;&#x3002;&#x53E6;&#x5916;&#x7531;&#x201C;&#x6216;&#x201D;&#x95E8;&#x7684;&#x5206;&#x89E3;&#xFF0C;&#x6211;&#x4EEC;&#x4E5F;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x5176;&#x91CF;&#x5B50;&#x7248;&#x672C;&#xFF1A;</p>
<p></p><div class="mathjax-exps">$$(X\otimes X\otimes X)\cdot C^2(X)\cdot(X\otimes X\otimes I)|a\rangle|b\rangle|0\rangle =\ |a\rangle|b\rangle|a\vee b\rangle.\tag{22}$$</div><p></p>
<p><img src="figures/vee.png" alt="&#x91CF;&#x5B50;&#x201C;&#x6216;&#x201D;&#x95E8;"></p>
<h4 class="mume-header" id="%E5%9B%9E%E5%88%B0-u_an-%E9%97%A8">&#x56DE;&#x5230; <span class="mathjax-exps">$U_{a,N}$</span> &#x95E8;</h4>

<p></p><div class="mathjax-exps">$$U_{a,N}=\sum_{x=0}^{N-1}|{ax\ \textrm{mod } {N}}\rangle\langle{x}|+\sum_{x=N}^{2^L-1}|{x}\rangle\langle{x}|.\tag{23}$$</div><p></p>
<p>&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A;&#x8F93;&#x5165; <span class="mathjax-exps">$x\in\{0,1,\cdots,2^L-1\}$</span>&#xFF0C;&#x6211;&#x4EEC;&#x603B;&#x80FD;&#x7ECF;&#x5178;&#x5730;&#x8BA1;&#x7B97;&#x5224;&#x65AD; <span class="mathjax-exps">$x&lt; N$</span>&#xFF0C;&#x5E76;&#x5728; <span class="mathjax-exps">$x&lt; N$</span> &#x65F6;&#x8BA1;&#x7B97; <span class="mathjax-exps">$ax\textrm{ mod } N$</span>&#xFF0C;&#x8FD9;&#x4E2A;&#x5224;&#x65AD;&#x548C;&#x8BA1;&#x7B97;&#x7684;&#x8FC7;&#x7A0B;&#x7EC8;&#x5F52;&#x662F;&#x7528;&#x903B;&#x8F91;&#x8FD0;&#x7B97;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x5373;&#x6700;&#x7EC8;&#x88AB;&#x5206;&#x89E3;&#x4E3A;&#x201C;&#x4E0E;&#x201D;&#x95E8;&#x3001;&#x201C;&#x975E;&#x201D;&#x95E8;&#x548C;&#x201C;&#x6247;&#x51FA;&#x201D;&#x95E8;&#x7684;&#x7EC4;&#x5408;&#xFF0C;&#x8FDB;&#x800C;&#x53EF;&#x88AB;&#x91CF;&#x5B50;&#x7535;&#x8DEF;&#x7B49;&#x6548;&#x5B9E;&#x73B0;&#x3002;&#x6700;&#x7EC8;&#x6211;&#x4EEC;&#x83B7;&#x5F97;&#x4E86;&#x4E00;&#x4E2A;&#x7531;&#x82E5;&#x5E72; <span class="mathjax-exps">$X$</span> &#x95E8;&#x3001;<span class="mathjax-exps">$C(X)$</span> &#x95E8;&#x548C; Toffoli &#x95E8;&#x7EC4;&#x6210;&#x7684;&#x91CF;&#x5B50;&#x7535;&#x8DEF; <span class="mathjax-exps">$\operatorname{C}$</span>&#xFF0C;&#x5176;&#x5B9E;&#x73B0;&#x4E86;</p>
<p></p><div class="mathjax-exps">$$\operatorname{C}|x\rangle|0\rangle^{\otimes L}|0\rangle^{\otimes t}=|x\rangle(U_{a,N}|x\rangle)|0\rangle^{\otimes t},\tag{24}$$</div><p></p>
<p>&#x5176;&#x4E2D; <span class="mathjax-exps">$t+L$</span> &#x662F;&#x6574;&#x4E2A;&#x7535;&#x8DEF;&#x9700;&#x8981;&#x5F15;&#x5165;&#x7684;&#x8F85;&#x52A9;&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#x7684;&#x6570;&#x76EE;&#x3002;&#x6839;&#x636E;&#x53EF;&#x9006;&#x8BA1;&#x7B97;&#x7684;&#x6027;&#x8D28;&#xFF0C;&#x4E0A;&#x8FF0;&#x7535;&#x8DEF;&#x4E2D;&#x6240;&#x9700;&#x91CF;&#x5B50;&#x95E8;&#x7684;&#x6570;&#x76EE;&#x548C; <span class="mathjax-exps">$t$</span> &#x90FD;&#x4E0D;&#x8D85;&#x8FC7;&#x7ECF;&#x5178;&#x8BA1;&#x7B97;&#x4E2D;&#x903B;&#x8F91;&#x8FD0;&#x7B97;&#x6B21;&#x6570;&#x7684;&#x4E24;&#x500D;&#xFF0C;&#x8FD9;&#x4FDD;&#x8BC1;&#x4E86; <span class="mathjax-exps">$\operatorname{C}$</span> &#x53EF;&#x4EE5;&#x88AB;&#x6709;&#x6548;&#x5B9E;&#x73B0;&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x548C;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7684; <span class="mathjax-exps">$|x\rangle\rightarrow U_{a,N}|x\rangle$</span> &#x8FD8;&#x662F;&#x4E0D;&#x592A;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x91CF;&#x5B50;&#x95E8; <span class="mathjax-exps">$\operatorname{SWAP}$</span> &#x4EA4;&#x6362;&#x4E24;&#x4E2A;&#x5BC4;&#x5B58;&#x5668;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x518D;&#x7C7B;&#x4F3C;&#x5730;&#x5B9E;&#x73B0; <span class="mathjax-exps">$U_{a^{-1},N}^\dagger$</span>&#xFF0C;&#x501F;&#x6B64;&#x62B9;&#x53BB; <span class="mathjax-exps">$|x\rangle$</span> &#x7684;&#x4FE1;&#x606F;&#xFF1A;</p>
<p></p><div class="mathjax-exps">$$|x\rangle(U_{a,N}|x\rangle)|0\rangle^{\otimes t}\xrightarrow{\operatorname{SWAP}} (U_{a,N}|x\rangle)|x\rangle|0\rangle^{\otimes t}\xrightarrow{\operatorname{\hat C^\dagger}} (U_{a,N}|x\rangle)|0\rangle|0\rangle^{\otimes t},\tag{25}$$</div><p></p>
<p>&#x8FD9;&#x91CC; <span class="mathjax-exps">$\hat {\operatorname C}^\dagger$</span> &#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E3A; <span class="mathjax-exps">$\hat {\operatorname C}$</span> &#x7684;&#x9006;&#x7535;&#x8DEF;:</p>
<p></p><div class="mathjax-exps">$$(U_{a,N}|x\rangle)|0\rangle|0\rangle^{\otimes t} \xrightarrow{\operatorname{\hat C}} (U_{a,N}|x\rangle)(U_{a^{-1},N}U_{a,N}|x\rangle)|0\rangle^{\otimes t}=(U_{a,N}|x\rangle)|x\rangle|0\rangle^{\otimes t}.\tag{26}$$</div><p></p>
<p><strong>&#x4F8B; 8.</strong> &#x6211;&#x4EEC;&#x4EE5; <span class="mathjax-exps">$U_{2,3}$</span> &#x4E3A;&#x4F8B;&#x6F14;&#x793A;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#xFF1A;</p>
<p><img src="figures/2xmod3.png" alt></p>
<p>&#x6211;&#x4EEC;&#x5F15;&#x5165; <span class="mathjax-exps">$3$</span> &#x4E2A;&#x96F6;&#x5316;&#x8F85;&#x52A9;&#x6BD4;&#x7279;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x7528;&#x4F5C;&#x6BD4;&#x8F83;&#x5668;&#xFF0C;&#x8BB0;&#x5F55; <span class="mathjax-exps">$x$</span> &#x662F;&#x5426; <span class="mathjax-exps">$&lt;3$</span>&#xFF0C;&#x7136;&#x540E;&#x4EE5;&#x8BE5;&#x6BD4;&#x7279;&#x4F5C;&#x4E3A;&#x63A7;&#x5236;&#x6BD4;&#x7279;&#x5B9E;&#x73B0; <span class="mathjax-exps">$|x\rangle$</span> &#x5230; <span class="mathjax-exps">$|2x\text{ mod }3\rangle$</span> &#x7684;&#x53D8;&#x6362;&#x3002;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x53D8;&#x6362; <span class="mathjax-exps">$|x\rangle|0\rangle\rightarrow|x\rangle|2x\text{ mod }3\rangle$</span>&#xFF0C;&#x7136;&#x540E;&#x4EA4;&#x6362;&#x91CF;&#x5B50;&#x6001;&#xFF0C;&#x5C06; <span class="mathjax-exps">$|2x\text{ mod } 3\rangle$</span> &#x50A8;&#x5B58;&#x5728;&#x524D;&#x4E24;&#x4E2A;&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#x4E2D;&#x3002;&#x518D;&#x63A5;&#x4E0B;&#x6765;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7528; <span class="mathjax-exps">$|2x\text{ mod }3\rangle$</span> &#x6765;&#x62B9;&#x9664; <span class="mathjax-exps">$|x\rangle$</span> &#x7684;&#x4FE1;&#x606F;&#x5F97;&#x5230; <span class="mathjax-exps">$|2x\text{ mod }3\rangle|0\rangle$</span>&#xFF0C;&#x56E0;&#x4E3A; <span class="mathjax-exps">$2(2x\text{ mod 3})\text{ mod 3} = x$</span>&#x3002;&#x6700;&#x540E;&#x62B9;&#x9664;&#x7B2C;&#x4E00;&#x4E2A;&#x8F85;&#x52A9;&#x6BD4;&#x7279;&#x7684;&#x8BB0;&#x5F55;&#x4FE1;&#x606F;&#xFF0C;&#x4FBF;&#x53EF;&#x5B9E;&#x73B0; <span class="mathjax-exps">$U_{2,3}$</span>&#x3002;&#x91CF;&#x5B50;&#x6001;&#x7684;&#x8BE6;&#x7EC6;&#x6F14;&#x5316;&#x8FC7;&#x7A0B;&#x5982;&#x4E0B;&#xFF1A;</p>
<p></p><div class="mathjax-exps">$$\begin{eqnarray} |x\rangle|0\rangle|0\rangle\rightarrow \begin{cases} |x\rangle|1\rangle|0\rangle\rightarrow|x\rangle|1\rangle|2x\text{ mod }3\rangle\rightarrow|2x\text{ mod }3\rangle|1\rangle|x\rangle\rightarrow|2x\text{ mod }3\rangle|1\rangle|0\rangle\rightarrow|2x\text{ mod }3\rangle|0\rangle|0\rangle,&amp;x&lt;3;\\ |x\rangle|0\rangle|0\rangle\rightarrow|x\rangle|0\rangle|0\rangle\rightarrow|x\rangle|0\rangle|0\rangle\rightarrow|x\rangle|0\rangle|0\rangle\rightarrow|x\rangle|0\rangle|0\rangle,&amp;x=3. \end{cases} \end{eqnarray}\tag{27}$$</div><p></p>
<p>&#x5F53;&#x7136;&#x8FD9;&#x91CC;&#x8BA1;&#x7B97; <span class="mathjax-exps">$2x\text{ mod }3$</span> &#x7684;&#x8FC7;&#x7A0B;&#x88AB;&#x5927;&#x5E45;&#x5EA6;&#x7B80;&#x5316;&#x8FC7;&#x4E86;&#xFF0C;&#x5BF9;&#x4E8E;&#x66F4;&#x4E00;&#x822C;&#x7684;&#x53C2;&#x6570;&#x60C5;&#x5F62;&#xFF0C;&#x4F1A;&#x7528;&#x5230;&#x66F4;&#x591A;&#x7684;&#x8F85;&#x52A9;&#x6BD4;&#x7279;&#x6765;&#x5B58;&#x50A8;&#x8FDB;&#x4F4D;&#x4FE1;&#x606F;&#x548C;&#x4E58;&#x6CD5;&#x7684;&#x4E2D;&#x95F4;&#x8BA1;&#x7B97;&#x7ED3;&#x679C;&#x3002;</p>
<h3 class="mume-header" id="%E9%80%9A%E7%94%A8-cu_an-%E7%9A%84%E5%AE%9E%E7%8E%B0">&#x901A;&#x7528; <span class="mathjax-exps">$C(U_{a,N})$</span> &#x7684;&#x5B9E;&#x73B0;</h3>

<p>&#x5728;&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#x4E2D;&#xFF0C;&#x91CF;&#x5B50;&#x9ED1;&#x76D2;&#x662F;&#x9149;&#x77E9;&#x9635;</p>
<p></p><div class="mathjax-exps">$$U_{a,N}=\sum_{x=0}^{N-1}|{ax\ \textrm{mod } {N}}\rangle\langle{x}|+\sum_{x=N}^{2^L-1}|{x}\rangle\langle{x}|.\tag{6}$$</div><p></p>
<p>&#x9700;&#x8981;&#x7528;&#x5230;&#x7684; <span class="mathjax-exps">$U_{a,N}$</span> &#x7684;&#x5E42;</p>
<p></p><div class="mathjax-exps">$$U_{a,N}^{2^k}=U_{a^{2^k}\text{ mod }N,N},$$</div><p></p>
<p>&#x6070;&#x4E5F;&#x5177;&#x6709;&#x5F62;&#x5F0F; <span class="mathjax-exps">$U_{\tilde a,N}$</span>&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x7684;&#x662F;&#x4E00;&#x79CD;&#x5BF9;&#x4EFB;&#x610F;&#x7684; <span class="mathjax-exps">$a$</span>&#xFF0C; &#x53EF;&#x4EE5;&#x6709;&#x6548;&#x5B9E;&#x73B0; <span class="mathjax-exps">$U_{\tilde a,N}$</span> &#x7684;&#x91CF;&#x5B50;&#x7535;&#x8DEF;&#x3002;</p>
<p>&#x5728;&#x672C;&#x6BB5;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x4F7F;&#x7528;&#x6587;&#x732E;</p>
<p>[7] Beauregard, Stephane. &quot;Circuit for Shor&apos;s algorithm using 2n+3 qubits.&quot; Quantum Information &amp; Computation 3.2 (2003): 175-185.</p>
<p>&#x6240;&#x63D0;&#x4F9B;&#x7684;&#x7B97;&#x6CD5;&#xFF0C;&#x7ED9;&#x51FA;&#x91CF;&#x5B50;&#x95E8; <span class="mathjax-exps">$C(U_{a,N})$</span> &#x7684;&#x5B9E;&#x73B0;&#x4EE3;&#x7801;&#xFF0C;&#x7C7B;&#x4F3C;&#x4F8B; 8 &#x7684;&#x5B9E;&#x73B0;&#x65B9;&#x6848;&#xFF0C;&#x6211;&#x4EEC;&#x4E5F;&#x9700;&#x8981;&#x91C7;&#x53D6;</p>
<p></p><div class="mathjax-exps">$$|x\rangle|0\rangle^{\otimes L}|0\rangle^{\otimes t}\rightarrow|x\rangle(U_{a,N}|x\rangle)|0\rangle^{\otimes t}\xrightarrow{\operatorname{SWAP}} (U_{a,N}|x\rangle)|x\rangle|0\rangle^{\otimes t}\rightarrow (U_{a,N}|x\rangle)|0\rangle^{\otimes L}|0\rangle^{\otimes t}\tag{28}$$</div><p></p>
<p>&#x8FD9;&#x4E00;&#x6D41;&#x7A0B;&#x3002;&#x66F4;&#x5177;&#x4F53;&#x5730;&#xFF0C;&#x4E3A;&#x4E86;&#x5B9E;&#x73B0;&#x91CF;&#x5B50;&#x95E8; <span class="mathjax-exps">$U_{a,N}$</span>&#xFF0C;&#x6211;&#x4EEC;&#x8981;&#x4F9D;&#x6B21;&#x5730;&#x5B9E;&#x73B0;&#x91CF;&#x5B50;&#x95E8;</p>
<p></p><div class="mathjax-exps">$$\begin{eqnarray} \Phi_{L,+a}&amp;:=&amp;\sum_{j=0}^{2^L-1}\Phi_{L}|j+a\text{ mod }2^L\rangle\langle j|\Phi_{L}^\dagger,\tag{29}\\ \Phi_{L,+a,\text{mod }N}&amp;:=&amp;\Phi_{L}\left(\sum_{j=0}^{N-1}|j+a\text{ mod }N\rangle\langle j|+\sum_{j=N}^{2^L-1}|j\rangle\langle j|\right)\Phi_{L}^\dagger,\tag{30}\\ U_{L,+a\cdot\text{ mod }N}&amp;:=&amp;\sum_{f=0}^{2^L-1}|f\rangle\langle f|\otimes\left(\sum_{y=0}^{N-1}|(y+af)\text{ mod }N\rangle\langle y|+\sum_{y=N}^{2^L-1}|y\rangle\langle y|\right)\tag{31} \end{eqnarray}$$</div><p></p>
<p>&#x4EE5;&#x53CA;&#x4ED6;&#x4EEC;&#x7684;&#x63A7;&#x5236;&#x7248;&#x672C;&#xFF08;<span class="mathjax-exps">$C(U):=|0\rangle\langle0|\otimes I_*+|1\rangle\langle1|\otimes U$</span>&#xFF09;&#xFF0C;&#x8FD9;&#x91CC; <span class="mathjax-exps">$N&lt;2^L$</span>&#xFF0C;<span class="mathjax-exps">$\Phi_L$</span> &#x4E3A;&#x53BB;&#x9664; <span class="mathjax-exps">$\operatorname{SWAP}$</span> &#x95E8;&#x7684; <span class="mathjax-exps">$\operatorname{QFT}_{L}$</span>&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x8FD9;&#x6837;&#x7406;&#x89E3;&#xFF0C;<span class="mathjax-exps">$\Phi_{L,+a}$</span> &#x5B9E;&#x73B0;&#x4E86; <span class="mathjax-exps">$\text{mod }2^L$</span> &#x7684; <span class="mathjax-exps">$+a$</span> &#x8FD0;&#x7B97;&#xFF1B;<span class="mathjax-exps">$\Phi_{L,+a,\text{mod }N}$</span> &#x5B9E;&#x73B0;&#x4E86; <span class="mathjax-exps">$\text{mod }N$</span> &#x7684; <span class="mathjax-exps">$+a$</span> &#x8FD0;&#x7B97;&#xFF1B;<span class="mathjax-exps">$U_{L,+a\cdot\text{ mod }N}$</span> &#x5B9E;&#x73B0;&#x4E86; <span class="mathjax-exps">$\text{mod }N$</span> &#x7684; <span class="mathjax-exps">$\times a$</span> &#x8FD0;&#x7B97;&#xFF0C;&#x5373;&#x5F0F; <span class="mathjax-exps">$(28)$</span> &#x7684;&#x7B2C;&#x4E00;&#x6B65;&#x3002;</p>
<h4 class="mume-header" id="~phi_la-%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="mathjax-exps">$~\Phi$</span><span class="mathjax-exps">$_{L,+a}$</span> &#x7684;&#x5B9E;&#x73B0;</h4>

<p>&#x8003;&#x8651;&#x5230;</p>
<p></p><div class="mathjax-exps">$$\begin{eqnarray} \operatorname{QFT}_{L}|j\rangle&amp;=&amp;\bigotimes_{k=0}^{L-1}\frac{|0\rangle+e^{2\pi ij*2^{-k-1}}|1\rangle}{2},\tag{32}\\ \left(\bigotimes_{k=0}^{L-1}U_1(2\pi a*2^{-k-1})\right)\cdot \operatorname{QFT}_{L}|j\rangle&amp;=&amp;\bigotimes_{k=0}^{L-1}\left(U_1(2\pi a*2^{-k-1})\cdot\frac{|0\rangle+e^{2\pi ij*2^{-k-1}}|1\rangle}{2}\right)\\ &amp;=&amp;\bigotimes_{i=0}^{L-1}\frac{|0\rangle+e^{2\pi i(j+a)*2^{-k-1}}|1\rangle}{2}\tag{33}\\ &amp;=&amp;\operatorname{QFT}_{L}|j+a\text{ mod }2^L\rangle, \end{eqnarray}$$</div><p></p>
<p>&#x6211;&#x4EEC;&#x6709;</p>
<p></p><div class="mathjax-exps">$$\bigotimes_{k=0}^{L-1}U_1(2\pi a*2^{-k-1})=\sum_{j=0}^{2^L-1}\operatorname{QFT}_{L}|j+a\text{ mod }2^L\rangle\langle j|\operatorname{QFT}_{L}^\dagger,\tag{34}$$</div><p></p>
<p>&#x8003;&#x8651;&#x5230; <span class="mathjax-exps">$\operatorname{QFT}$</span> &#x7684;&#x5B9E;&#x73B0;&#x8FC7;&#x7A0B;&#x4E2D;&#x6709;&#x4E00;&#x4E32; <span class="mathjax-exps">$\operatorname{SWAP}$</span> &#x95E8;&#xFF0C;&#x4F46;&#x8FD9;&#x5728;&#x524D;&#x8FF0;&#x5B9E;&#x73B0;&#x4E2D;&#x662F;&#x4E0D;&#x5FC5;&#x8981;&#x7684;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x91CD;&#x65B0;&#x5B9A;&#x4E49;&#x6CA1;&#x6709; <span class="mathjax-exps">$\operatorname{SWAP}$</span> &#x6B65;&#x9AA4;&#x7684; <span class="mathjax-exps">$\operatorname{QFT}_{L}$</span> &#x4E3A; <span class="mathjax-exps">$\Phi_L$</span>,</p>
<p></p><div class="mathjax-exps">$$\begin{eqnarray} \Phi_{L}|j\rangle&amp;=&amp;\bigotimes_{k=0}^{L-1}\frac{|0\rangle+e^{2\pi ij*2^{k-L}}|1\rangle}{2},\tag{35}\\ \left(\bigotimes_{k=0}^{L-1}U_1(2\pi a*2^{k-L})\right)\cdot \Phi_{L}|j\rangle&amp;=&amp;\Phi_{L}|j+a\text{ mod }2^L\rangle,\tag{36}\\ \bigotimes_{k=0}^{L-1}U_1(2\pi a*2^{k-L})&amp;=&amp;\sum_{j=0}^{2^L-1}\Phi_{L}|j+a\text{ mod }2^L\rangle\langle j|\Phi_{L}^\dagger,\tag{37} \end{eqnarray}$$</div><p></p>
<p>&#x5BF9;&#x5E94;&#x4EE3;&#x7801;&#x6BB5;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF0C;&#x5176;&#x4E2D;&#x503C;&#x5F97;&#x6CE8;&#x610F;&#x7684;&#x662F;&#x4EE3;&#x7801;&#x6CE8;&#x91CA;&#x4E2D;&#x7684; <code>QFT</code> &#x5747;&#x6307; <strong>&#x6CA1;&#x6709;</strong> <span class="mathjax-exps">$\operatorname{SWAP}$</span> &#x95E8;&#x7684;&#x91CF;&#x5B50; Fourier &#x53D8;&#x6362;&#xFF08;&#x4E0B;&#x7565;&#x540C;&#xFF09;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="python{.line-numbers}" class="language-python line-numbers"><span class="token keyword">def</span> <span class="token function">func_qft_without_swap</span><span class="token punctuation">(</span>reg_system<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    Quantum Fourier Transform without the swap step, |s&gt; -&gt; QFT|s&gt;
    :param reg_system: |s&gt;
    :return:
    &quot;&quot;&quot;</span>
    number_qubit <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>reg_system<span class="token punctuation">)</span>
    <span class="token keyword">for</span> idx1_qubit <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> number_qubit <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># The outer loop</span>
        H<span class="token punctuation">(</span>reg_system<span class="token punctuation">[</span>idx1_qubit<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># Operate a H gate on the idx1-th qubit</span>
        <span class="token keyword">for</span> idx2_qubit <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> number_qubit <span class="token operator">-</span> idx1_qubit <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># The inner loop</span>
            <span class="token comment"># where we will operate a CU1 gate in each loop</span>
            idx3_qubit <span class="token operator">=</span> idx1_qubit <span class="token operator">+</span> idx2_qubit <span class="token operator">-</span> <span class="token number">1</span>  <span class="token comment"># idx3 is the idx for the ctrlling qubit</span>
            <span class="token comment"># idx1 is the ctrlled qubit and idx2 is related to the rotation angle</span>
            CU<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> pi <span class="token operator">/</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> idx2_qubit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>reg_system<span class="token punctuation">[</span>idx3_qubit<span class="token punctuation">]</span><span class="token punctuation">,</span> reg_system<span class="token punctuation">[</span>idx1_qubit<span class="token punctuation">]</span><span class="token punctuation">)</span>
    H<span class="token punctuation">(</span>reg_system<span class="token punctuation">[</span>number_qubit <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># Do not forget there is a H gate operating on the last qubit</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x6709; <span class="mathjax-exps">$\Phi_{L,+a}$</span> &#x7684;&#x5206;&#x89E3;&#x548C;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#xFF1A;</p>
<p><img src="figures/Phi_Add_a.png" alt></p>
<pre data-role="codeBlock" data-info="python{.line-numbers}" class="language-python line-numbers"><span class="token keyword">def</span> <span class="token function">func_qftadd</span><span class="token punctuation">(</span>reg_system<span class="token punctuation">,</span> int_adder<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    a circuit implement the addition under the Fourier bases
    :param reg_system: QFT|s&gt;, we write the state as a image of the Fourier transform
    :param int_adder: a
    :return: a circuit which implement the map: QFT|s&gt; -&gt; QFT|s+a&gt;
    &quot;&quot;&quot;</span>
    <span class="token keyword">for</span> idx_qubit <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>reg_system<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># For each qubit in the reg_s, we operate a U1 gate on it</span>
        U<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> pi <span class="token operator">*</span> <span class="token punctuation">(</span>int_adder <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token punctuation">(</span>idx_qubit <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">**</span> <span class="token punctuation">(</span>idx_qubit <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>
            reg_system<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">-</span> idx_qubit<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><h4 class="mume-header" id="c2phi_latextmod-n-%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="mathjax-exps">$C^2(\Phi_{L,+a,\text{mod }N})$</span> &#x7684;&#x5B9E;&#x73B0;</h4>

<p>&#x8FD9;&#x91CC;&#x76F4;&#x63A5;&#x7ED9;&#x51FA; <span class="mathjax-exps">$C^2(\Phi_{L,+a,\text{mod }N})$</span> &#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x53EF;&#x4EE5;&#x7B80;&#x5355;&#x5730;&#x53BB;&#x6389;&#x63A7;&#x5236;&#x4F4D;&#x5F97;&#x5230; <span class="mathjax-exps">$C(\Phi_{L,+a,\text{mod }N})$</span> &#x548C; <span class="mathjax-exps">$\Phi_{L,+a,\text{mod }N}$</span> &#x7684;&#x5B9E;&#x73B0;&#x3002;</p>
<p><img src="figures/Phi_Add_Mod.png" alt></p>
<p>&#x8FD9;&#x91CC; <span class="mathjax-exps">$|c_1\rangle$</span> &#x548C; <span class="mathjax-exps">$|c_2\rangle$</span> &#x4E3A;&#x4E24;&#x4E2A;&#x63A7;&#x5236;&#x4F4D;&#xFF0C;&#x6700;&#x4E0B;&#x4E00;&#x7EBF; <span class="mathjax-exps">$|0\rangle$</span> &#x4E3A;&#x4E00;&#x4E2A; <strong>&#x96F6;&#x5316;&#x8F85;&#x52A9;&#x6BD4;&#x7279;</strong>&#xFF08;zeroed qubit&#xFF09;&#xFF0C;&#x5B83;&#x5728;&#x8F93;&#x5165;&#x72B6;&#x6001;&#x4E3A; <span class="mathjax-exps">$|0\rangle$</span> &#x65F6;&#xFF0C;&#x8F93;&#x51FA;&#x72B6;&#x6001;&#x4E5F;&#x4E00;&#x5B9A;&#x4E3A; <span class="mathjax-exps">$|0\rangle$</span>&#x3002;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x7279;&#x522B;&#x8BF4;&#x660E;&#x7684;&#x662F;&#xFF0C;&#x4EC5;&#x5728;</p>
<p></p><div class="mathjax-exps">$$L\ge\lceil \log_2 N\rceil+1,\tag{38}$$</div><p></p>
<p>&#x7B2C;&#x4E09;&#x3001;&#x56DB;&#x7EBF;&#x7684;&#x8F93;&#x5165;&#x72B6;&#x6001;&#x662F;</p>
<p></p><div class="mathjax-exps">$$\Phi_L|s\rangle,\ s=0,1,\cdots,N-1,\tag{39}$$</div><p></p>
<p>&#x4E24;&#x4E2A;&#x6761;&#x4EF6;&#x5747;&#x6EE1;&#x8DB3;&#x65F6;&#xFF0C;&#x4E0A;&#x8FF0;&#x7535;&#x8DEF; <span class="mathjax-exps">$\mathcal C_{C^2(\Phi_{L,+a,\text{mod }N})}$</span> &#x624D;&#x5177;&#x6709;&#x6548;&#x679C;:</p>
<p></p><div class="mathjax-exps">$$\begin{eqnarray} \mathcal C_{C^2(\Phi_{L,+a,\text{mod }N})}|c_1\rangle|c_2\rangle\left(\Phi_L|s\rangle\right)|0\rangle &amp;=&amp;\left(C^2(\Phi_{L,+a,\text{mod }N})|c_1\rangle|c_2\rangle\left(\Phi_L|s\rangle\right)\right)|0\rangle\\ &amp;=&amp;|c_1\rangle|c_2\rangle\left(\Phi_L|s+c_1c_2a\text{ mod }N\rangle\right)|0\rangle. \end{eqnarray}\tag{40}$$</div><p></p>
<p>&#x82E5;&#x6761;&#x4EF6;&#x4E0D;&#x6EE1;&#x8DB3;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x89E6;&#x53D1;&#x4E00;&#x4E9B;&#x6CC4;&#x6F0F;&#xFF0C;&#x6BD4;&#x5982;&#x96F6;&#x5316;&#x8F85;&#x52A9;&#x6BD4;&#x7279;&#x6CA1;&#x6709;&#x88AB;&#x5F52;&#x4F4D;&#x4E3A; <span class="mathjax-exps">$|0\rangle$</span>&#xFF0C;&#x4F7F;&#x4E4B;&#x4ECD;&#x4E0E;&#x5176;&#x5B83; qubit &#x5904;&#x4E8E;&#x7EA0;&#x7F20;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x8FDB;&#x800C;&#x4F7F;&#x5F97;&#x6574;&#x4E2A;&#x8BA1;&#x7B97;&#x4E0E;&#x9884;&#x671F;&#x4E0D;&#x7B26;&#x3002;</p>
<p>&#x989D;&#x5916;&#x8865;&#x5145;&#x4E00;&#x70B9;&#xFF0C;&#x91CF;&#x5B50;&#x8BA1;&#x7B97;&#x5177;&#x6709;&#x53E0;&#x52A0;&#x6027;&#xFF0C;&#x5F53;&#x4E24;&#x4E2A;&#x72B6;&#x6001;&#x90FD;&#x662F;&#x5408;&#x6CD5;&#x7684;&#x65F6;&#xFF0C;&#x5B83;&#x4EEC;&#x7684;&#x53E0;&#x52A0;&#x6001;&#x4E5F;&#x4F1A;&#x8FD8;&#x662F;&#x5408;&#x6CD5;&#x7684;&#x3002;&#x6240;&#x4EE5;&#x7B2C;&#x4E09;&#x3001;&#x56DB;&#x7EBF;&#x7684;&#x8F93;&#x5165;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;</p>
<p></p><div class="mathjax-exps">$$\Phi_L\sum_{s=0}^{N-1}p_s|s\rangle,\tag{41}$$</div><p></p>
<p>&#x5176;&#x4E2D;</p>
<p></p><div class="mathjax-exps">$$\sum_{s=0}^{N-1}|p_s|^2=1.\tag{42}$$</div><p></p>
<p>&#x7C7B;&#x4F3C;&#x7684;&#x60C5;&#x5F62;&#xFF0C;&#x6211;&#x4EEC;&#x540E;&#x9762;&#x4E0D;&#x4F1A;&#x518D;&#x8D58;&#x8FF0;&#xFF0C;&#x4ECD;&#x7B80;&#x5355;&#x5730;&#x8BF4;&#xFF1A;<span class="mathjax-exps">$s$</span> &#x53EA;&#x80FD;&#x662F; <span class="mathjax-exps">$0,\cdots,N-1$</span>&#x3002;</p>
<p>&#x5728;&#x4E0B;&#x8FF0;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x8BB0;&#x7B2C;&#x4E00;&#x3001;&#x4E8C;&#x7EBF;&#x6574;&#x4F53;&#x4E3A; <code>reg_ctrlling</code>&#xFF0C;&#x7B2C;&#x4E09;&#x3001;&#x56DB;&#x7EBF;&#x6574;&#x4F53;&#x4E3A; <code>reg_system</code>&#xFF0C;&#x5176;&#x4E2D;&#x7B2C;&#x4E09;&#x7EBF;&#x5373; <code>reg_system[0]</code>&#xFF0C;&#x6700;&#x540E;&#x4E00;&#x7EBF;&#x4E3A; <code>qubit_zeroed</code>&#xFF0C;&#x6574;&#x578B;&#x53C2;&#x6570; <span class="mathjax-exps">$a,N$</span> &#x5206;&#x522B;&#x4E3A; <code>int_adder</code> &#x548C; <code>int_divisor</code>&#x3002;&#x51FD;&#x6570;&#x540D;&#x4EE5; <code>_inverse</code> &#x7ED3;&#x5C3E;&#x7684;&#x8868;&#x793A;&#x76F8;&#x5E94;&#x91CF;&#x5B50;&#x7535;&#x8DEF;&#x7684;&#x9006;&#x7535;&#x8DEF;&#xFF0C;&#x51FD;&#x6570;&#x540D;&#x4EE5; <code>func_ctrl</code> &#x6216; <code>func_double_ctrl</code> &#x5F00;&#x5934;&#x7684;&#x8868;&#x793A;&#x76F8;&#x5E94;&#x91CF;&#x5B50;&#x7535;&#x8DEF;&#x7684;&#x63A7;&#x5236;&#x7248;&#x672C;&#x6216;&#x53CC;&#x91CD;&#x63A7;&#x5236;&#x7248;&#x672C;&#x3002;</p>
<pre data-role="codeBlock" data-info="python{.line-numbers}" class="language-python line-numbers"><span class="token keyword">def</span> <span class="token function">func_double_ctrl_qftaddmod</span><span class="token punctuation">(</span>reg_system<span class="token punctuation">,</span> reg_ctrlling<span class="token punctuation">,</span> qubit_zeroed<span class="token punctuation">,</span> int_adder<span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    CC-qftadd(int_adder)mod(int_divisor)
    |c_1&gt;|c_2&gt;QFT|s&gt; -&gt; &lt;0|c_1*c_2&gt;*|c_1&gt;|c_2&gt;QFT|s&gt; + &lt;1|c_1*c_2&gt;*|c_1&gt;|c_2&gt;QFT|s+a mod d&gt;
    the complement comes from the Figure 5 in arXiv quant-ph/0205095
    :param reg_system: QFT|s&gt; with s &lt; d
    :param reg_ctrlling: [|c_1&gt;,|c_2&gt;]
    :param qubit_zeroed: |0&gt;
    :param int_adder: a with a &lt; d
    :param int_divisor: d
    :return: |c_1&gt;|c_2&gt;QFT|s&gt;|0&gt; -&gt; &lt;0|c_1*c_2&gt;*|c_1&gt;|c_2&gt;QFT|s&gt;|0&gt; + &lt;1|c_1*c_2&gt;*|c_1&gt;|c_2&gt;QFT|s+a mod d&gt;|0&gt;
    &quot;&quot;&quot;</span>
    func_double_ctrl_qftadd<span class="token punctuation">(</span>reg_system<span class="token punctuation">,</span> reg_ctrlling<span class="token punctuation">,</span> int_adder<span class="token punctuation">)</span>
    func_qftadd_inverse<span class="token punctuation">(</span>reg_system<span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span>
    func_qft_without_swap_inverse<span class="token punctuation">(</span>reg_system<span class="token punctuation">)</span>
    CX<span class="token punctuation">(</span>reg_system<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> qubit_zeroed<span class="token punctuation">)</span>
    func_qft_without_swap<span class="token punctuation">(</span>reg_system<span class="token punctuation">)</span>
    func_ctrl_qftadd<span class="token punctuation">(</span>reg_system<span class="token punctuation">,</span> qubit_zeroed<span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span>
    func_double_ctrl_qftadd_inverse<span class="token punctuation">(</span>reg_system<span class="token punctuation">,</span> reg_ctrlling<span class="token punctuation">,</span> int_adder<span class="token punctuation">)</span>
    func_qft_without_swap_inverse<span class="token punctuation">(</span>reg_system<span class="token punctuation">)</span>
    X<span class="token punctuation">(</span>reg_system<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    CX<span class="token punctuation">(</span>reg_system<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> qubit_zeroed<span class="token punctuation">)</span>
    X<span class="token punctuation">(</span>reg_system<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    func_qft_without_swap<span class="token punctuation">(</span>reg_system<span class="token punctuation">)</span>
    func_double_ctrl_qftadd<span class="token punctuation">(</span>reg_system<span class="token punctuation">,</span> reg_ctrlling<span class="token punctuation">,</span> int_adder<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>&#x7279;&#x522B;&#x5730;&#xFF0C;&#x4E00;&#x4E9B;&#x91CF;&#x5B50;&#x5B50;&#x7535;&#x8DEF;&#x7684;&#x53CC;&#x91CD;&#x63A7;&#x5236;&#x7248;&#x672C;&#x4F1A;&#x7528;&#x5230; <span class="mathjax-exps">$C^2(U_1)$</span> &#x95E8;&#xFF0C;&#x6211;&#x4EEC;&#x4E5F;&#x7ED9;&#x51FA;&#x5B83;&#x7684;&#x5B9E;&#x73B0;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="python{.line-numbers}" class="language-python line-numbers"><span class="token keyword">def</span> <span class="token function">CCU1</span><span class="token punctuation">(</span>q1<span class="token punctuation">,</span> q2<span class="token punctuation">,</span> q3<span class="token punctuation">,</span> float_theta<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    a single-parameter three-qubit gate, which is the double-ctrl version for U1 gate,
    the matrix form of CCU1(theta) is the diagonal matrix {1,1,1,1,1,1,1,e^{i theta}}
    in fact we do not distinguish which qubit is the ctrlling or ctrlled qubit
    :param q1: a qubit
    :param q2: another qubit
    :param q3: a third qubit
    :param float_theta: the rotation angle
    :return: |q1&gt;|q2&gt;|q3&gt; -&gt; &lt;0|q1*q2*q3&gt;*|q1&gt;|q2&gt;|q3&gt; + e^{i theta}*&lt;1|q1*q2*q3&gt;*|q1&gt;|q2&gt;|q3&gt;
    &quot;&quot;&quot;</span>
    float_theta_half <span class="token operator">=</span> float_theta <span class="token operator">/</span> <span class="token number">2</span>
    CU<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> float_theta_half<span class="token punctuation">)</span><span class="token punctuation">(</span>q2<span class="token punctuation">,</span> q3<span class="token punctuation">)</span>
    CX<span class="token punctuation">(</span>q1<span class="token punctuation">,</span> q2<span class="token punctuation">)</span>
    CU<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>float_theta_half<span class="token punctuation">)</span><span class="token punctuation">(</span>q2<span class="token punctuation">,</span> q3<span class="token punctuation">)</span>
    CX<span class="token punctuation">(</span>q1<span class="token punctuation">,</span> q2<span class="token punctuation">)</span>
    CU<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> float_theta_half<span class="token punctuation">)</span><span class="token punctuation">(</span>q1<span class="token punctuation">,</span> q3<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>&#x540E;&#x8BDD;&#xFF1A;&#x867D;&#x7136;&#x6211;&#x4EEC;&#x5E0C;&#x671B;&#x5B9E;&#x73B0;&#x7684;&#x662F; <span class="mathjax-exps">$\Phi_{+a,\text{mod }N}$</span>&#xFF0C;&#x4F46;&#x4EC5;&#x8BE5;&#x77E9;&#x9635;&#x7684;&#x4E00;&#x4E2A;&#x6295;&#x5F71; <span class="mathjax-exps">$B$</span> &#x662F;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x7684;&#xFF0C;&#x5F53;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x6709;&#x7535;&#x8DEF; <span class="mathjax-exps">$\mathcal C$</span>&#xFF0C;&#x5176;&#x6EE1;&#x8DB3;</p>
<p></p><div class="mathjax-exps">$$\mathcal C\cdot\Phi_{L}\sum_{j=0}^{N-1}|j\rangle\langle j|\Phi_{L}^\dagger=B:=\Phi_{L,+a,\text{mod }N}\cdot\Phi_{L}\sum_{j=0}^{N-1}|j\rangle\langle j|\Phi_{L}^\dagger\tag{43}$$</div><p></p>
<p>&#x65F6;&#xFF0C;&#x4FBF;&#x53EF;&#x89C6; <span class="mathjax-exps">$\mathcal C$</span> &#x4E3A; <span class="mathjax-exps">$B$</span> &#x7684;&#x4E00;&#x4E2A;&#x6709;&#x6548;&#x5B9E;&#x73B0;&#x3002;&#x8FD9;&#x79CD;&#x5C06;&#x6709;&#x6548;&#x4FE1;&#x606F; <span class="mathjax-exps">$B$</span> &#x7F16;&#x7801;&#x5230;&#x7535;&#x8DEF; <span class="mathjax-exps">$\mathcal C$</span> &#x7684;&#x6295;&#x5F71;&#x7684;&#x6B65;&#x9AA4;&#x4E00;&#x822C;&#x88AB;&#x79F0;&#x4E3A; block-encoding&#x3002;&#x6B64;&#x65F6;&#xFF0C;<span class="mathjax-exps">$\mathcal C$</span> &#x5177;&#x6709;&#x5F62;&#x5F0F;&#xFF1A;</p>
<p></p><div class="mathjax-exps">$$\begin{eqnarray} \mathcal C&amp;:=&amp;\Phi_{L}\left(\sum_{j=0}^{N-1}|j+a\text{ mod }N\rangle\langle j|+\sum_{j=N}^{2^L-1}|\tilde j\rangle\langle j|\right)\Phi_{L}^\dagger,\tag{44}\\ \Phi_{L,+a,\text{mod }N}&amp;:=&amp;\Phi_{L}\left(\sum_{j=0}^{N-1}|j+a\text{ mod }N\rangle\langle j|+\sum_{j=N}^{2^L-1}|j\rangle\langle j|\right)\Phi_{L}^\dagger.\tag{45} \end{eqnarray}$$</div><p></p>
<p>&#x8FD9;&#x91CC; <span class="mathjax-exps">$\{|\tilde j\rangle\}$</span> &#x5E94;&#x4E3A; <span class="mathjax-exps">$\text{Span}\{|j\rangle\,|\,j=N,\cdots2^L-1\}$</span> &#x7684;&#x4E00;&#x7EC4;&#x6807;&#x51C6;&#x6B63;&#x4EA4;&#x57FA;&#x3002;&#x53EF;&#x4EE5;&#x770B;&#x51FA; <span class="mathjax-exps">$\Phi_{L,+a,\text{mod }N}$</span> &#x53EA;&#x662F;&#x82E5;&#x5E72;&#x5B9E;&#x73B0; <span class="mathjax-exps">$\mathcal C$</span> &#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x7279;&#x4F8B;&#x3002;</p>
<h4 class="mume-header" id="u_lacdottext-mod-n-%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="mathjax-exps">$U_{L,+a\cdot\text{ mod }N}$</span> &#x7684;&#x5B9E;&#x73B0;</h4>

<p>&#x56DE;&#x987E; <span class="mathjax-exps">$U_{L,+a\cdot\text{ mod }N}$</span> &#x7684;&#x5B9A;&#x4E49;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;</p>
<p></p><div class="mathjax-exps">$$U_{L,+a\cdot\text{ mod }N}:=\sum_{f=0}^{2^L-1}|f\rangle\langle f|\otimes\left(\sum_{y=0}^{N-1}|(y+af)\text{ mod }N\rangle\langle y|+\sum_{y=N}^{2^L-1}|y\rangle\langle y|\right).\tag{46}$$</div><p></p>
<p>&#x5C06; <span class="mathjax-exps">$f$</span> &#x505A;&#x4E8C;&#x8FDB;&#x5236;&#x5C55;&#x5F00;&#x4E3A; <span class="mathjax-exps">$f=\sum_{j=0}^*2^jf_j$</span>&#xFF0C;&#x5F88;&#x5BB9;&#x6613;&#x5F97;&#x5230;&#x7528;&#x52A0;&#x6CD5;&#x5B9E;&#x73B0;&#x4E58;&#x6CD5;&#x7684;&#x529E;&#x6CD5;&#xFF1A;</p>
<p></p><div class="mathjax-exps">$$af=\sum_{j=0}^*2^jf_j\cdot a,\tag{47}$$</div><p></p>
<p>&#x8FDB;&#x4E00;&#x6B65;&#x6709;</p>
<p></p><div class="mathjax-exps">$$\begin{eqnarray} &amp;&amp;s+af\text{ mod }N=\left(\sum_{j=0}^*2^jf_j\cdot a\right)\text{ mod }N\\ &amp;=&amp;s+_{\text{mod }N}(2^0a\text{ mod }N)f_0+_{\text{mod }N}(2^1a\text{ mod }N)f_1+_{\text{mod }N}\cdots+_{\text{mod }N} (2^*a\text{ mod }N)f_*. \end{eqnarray}\tag{48}$$</div><p></p>
<p>&#x8FD9;&#x91CC; <span class="mathjax-exps">$+_{\text{mod }N}$</span> &#x8868;&#x793A;&#x6BCF;&#x5F53;&#x505A;&#x5B8C;&#x4E00;&#x6B21;&#x52A0;&#x6CD5;&#x540E;&#x6267;&#x884C;&#x4E00;&#x6B21;&#x6A21;&#x8FD0;&#x7B97;&#xFF0C;&#x8FD9;&#x6837;&#x53EF;&#x4EE5;&#x6709;&#x6548;&#x7684;&#x4FDD;&#x8BC1;&#x6BCF;&#x4E00;&#x6B65;&#x7684;&#x8BA1;&#x7B97;&#x7ED3;&#x679C;&#x6EE1;&#x8DB3;&#x8F93;&#x5165;&#x6761;&#x4EF6;&#xFF0C;&#x5373;&#x843D;&#x5728;&#x6574;&#x6570;&#x533A;&#x95F4; <span class="mathjax-exps">$\{0,1,\cdots,N-1\}$</span> &#x4E2D;&#x3002;</p>
<p><img src="figures/U_Add_Prod_Mod.png" alt></p>
<p>&#x53EF;&#x4EE5;&#x9A8C;&#x8BC1;&#x5F53; <span class="mathjax-exps">$L\ge\lceil \log_2 N\rceil+1$</span> &#x4E14; <span class="mathjax-exps">$s=0,1,\cdots N-1$</span> &#x65F6;&#xFF0C;&#x4E0A;&#x8FF0;&#x7535;&#x8DEF;&#x5B9E;&#x73B0;&#x4E86;</p>
<p></p><div class="mathjax-exps">$$\mathcal C_{U_{L,+a\cdot\text{ mod }N}}|c\rangle|f\rangle|s\rangle ={U_{L,+a\cdot\text{ mod }N}}|c\rangle|f\rangle|s\rangle =|c\rangle|f\rangle|s+caf\text{ mod }N\rangle.\tag{49}$$</div><p></p>
<p>&#x503C;&#x5F97;&#x6CE8;&#x610F;&#x7684;&#x662F;&#x6211;&#x4EEC;&#x5BF9; <span class="mathjax-exps">$|s\rangle$</span> &#x6709;&#x8981;&#x6C42;&#xFF0C;&#x4F46;&#x662F;&#x5BF9; <span class="mathjax-exps">$|f\rangle$</span> &#x6CA1;&#x6709;&#x8981;&#x6C42;&#x3002;&#x6700;&#x540E;&#x6211;&#x4EEC;&#x8BB0; <span class="mathjax-exps">$|s\rangle$</span>&#xFF0C;<span class="mathjax-exps">$|f\rangle$</span>&#xFF0C;<span class="mathjax-exps">$|c\rangle$</span> &#x5206;&#x522B;&#x4E3A; <code>reg_system</code>&#xFF0C;<code>reg_factor_1</code>&#xFF0C; <code>qubit_ctrlling</code>&#xFF0C;<span class="mathjax-exps">$a,N$</span> &#x5206;&#x522B;&#x4E3A; <code>int_factor_2</code>&#xFF0C;<code>int_divisor</code>&#xFF0C;&#x5E76;&#x5F15;&#x5165; <code>qubit_zeroed</code> &#x4F5C;&#x4E3A; <span class="mathjax-exps">$\mathcal C_{C^2(\Phi_{L,+a,\text{mod }N})}$</span> &#x6240;&#x9700;&#x5F15;&#x5165;&#x7684;&#x96F6;&#x5316;&#x8F85;&#x52A9;&#x6BD4;&#x7279;&#x3002;&#x6709;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="python{.line-numbers}" class="language-python line-numbers"><span class="token keyword">def</span> <span class="token function">func_ctrl_addprodmod</span><span class="token punctuation">(</span>reg_system<span class="token punctuation">,</span> reg_factor_1<span class="token punctuation">,</span> qubit_ctrlling<span class="token punctuation">,</span> qubit_zeroed<span class="token punctuation">,</span> int_factor_2<span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    :param reg_system: |s&gt; with s &lt; d
    :param reg_factor_1: |f_1&gt;, a quantum state encoding the factor_1
    :param qubit_ctrlling: |c&gt;
    :param qubit_zeroed: |0&gt;
    :param int_factor_2: f_2, a classical data
    :param int_divisor: d
    :return: |c&gt;|f_1&gt;|s&gt; -&gt; &lt;0|c&gt;|c&gt;|f_1&gt;|s&gt; + &lt;1|c&gt;|c&gt;|f_1&gt;|s+ f_1*f_2 mod d&gt;
    the complement comes from the Figure 6 in arXiv quant-ph/0205095
    &quot;&quot;&quot;</span>
    func_qft_without_swap<span class="token punctuation">(</span>reg_system<span class="token punctuation">)</span>
    <span class="token keyword">for</span> idx_qubit <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>reg_factor_1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># For each qubit in reg_f_1, we will operate a CC-qftaddmod gate where</span>
        <span class="token comment"># regarding idx_qubit as one of the two ctrlling qubit</span>
        func_double_ctrl_qftaddmod<span class="token punctuation">(</span>reg_system<span class="token punctuation">,</span> <span class="token punctuation">[</span>qubit_ctrlling<span class="token punctuation">,</span> reg_factor_1<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">-</span> idx_qubit<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> qubit_zeroed<span class="token punctuation">,</span>
                                   <span class="token punctuation">(</span>int_factor_2 <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">**</span> idx_qubit<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> int_divisor<span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span>
    func_qft_without_swap_inverse<span class="token punctuation">(</span>reg_system<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><h4 class="mume-header" id="u_an-%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="mathjax-exps">$U_{a,N}$</span> &#x7684;&#x5B9E;&#x73B0;</h4>

<p>&#x8003;&#x8651;&#x5230;</p>
<p></p><div class="mathjax-exps">$$s-a^{-1}as\equiv 0\pmod N,\tag{50}$$</div><p></p>
<p>&#x8FD9;&#x91CC; <span class="mathjax-exps">$a^{-1}$</span> &#x662F; <span class="mathjax-exps">$a$</span> &#x6A21; <span class="mathjax-exps">$N$</span> &#x7684;&#x9006;&#xFF08;<span class="mathjax-exps">$a^{-1}a\equiv1\pmod N$</span>&#xFF09;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x6269;&#x5C55;&#x7684; Euclid &#x7B97;&#x6CD5;&#x6709;&#x6548;&#x8BA1;&#x7B97;&#x3002;</p>
<p>&#x90A3;&#x4E48;&#x5F0F; <span class="mathjax-exps">$(28)$</span> &#x7684;&#x6D41;&#x7A0B;&#x53EF;&#x4EE5;&#x8868;&#x793A;&#x4E3A;</p>
<p></p><div class="mathjax-exps">$$\begin{eqnarray} |s\rangle|0\rangle \rightarrow U_{L,+a\cdot\text{ mod }N}|s\rangle|0\rangle =|s\rangle|as\rangle \stackrel{\operatorname{SWAP}}\longrightarrow|as\rangle|s\rangle \rightarrow U_{L,+a^{-1}\cdot\text{ mod }N}^\dagger|as\rangle|s\rangle =|as\rangle|0\rangle. \end{eqnarray}\tag{51}$$</div><p></p>
<p>&#x6211;&#x4EEC;&#x7ED9;&#x51FA; <span class="mathjax-exps">$C(U_{a,N})$</span> &#x7684;&#x7535;&#x8DEF;&#x5206;&#x89E3;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><img src="figures/U_aN.png" alt></p>
<p>&#x5176;&#x4E2D; <span class="mathjax-exps">$f &lt; N$</span>&#xFF0C;<span class="mathjax-exps">$|0\rangle$</span> &#x4E3A;&#x96F6;&#x5316;&#x8F85;&#x52A9;&#x6BD4;&#x7279;&#xFF0C; <span class="mathjax-exps">$\operatorname{SWAP}$</span> &#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E3A;&#xFF1A;&#x5BF9;&#x4E24;&#x5404;&#x91CF;&#x5B50;&#x5BC4;&#x5B58;&#x5668;&#x5BF9;&#x5E94;&#x7684;&#x91CF;&#x5B50;&#x4F4D;&#x505A; <span class="mathjax-exps">$\operatorname{SWAP}$</span> &#x95E8;&#x3002;&#x9700;&#x8981;&#x7279;&#x522B;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;<span class="mathjax-exps">$|f\rangle$</span> &#x5E94;&#x4F7F;&#x7528; <span class="mathjax-exps">$\lceil\log_2 N\rceil$</span> &#x4E2A;&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#x6765;&#x7F16;&#x7801;&#xFF0C;<span class="mathjax-exps">$|0\rangle$</span> &#x5E94;&#x4F7F;&#x7528;&#x81F3;&#x5C11; <span class="mathjax-exps">$\lceil\log_2 N\rceil+1$</span> &#x4E2A;&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#x6765;&#x7F16;&#x7801;&#xFF0C;&#x5728;&#x505A; <span class="mathjax-exps">$\operatorname{SWAP}$</span> &#x65F6;&#x9700;&#x4ECE;&#x4F4E;&#x4F4D;&#x5F00;&#x59CB;&#x5BF9;&#x9F50;&#xFF0C;&#x5373; <span class="mathjax-exps">$|0\rangle$</span> &#x7684;&#x6700;&#x9AD8;&#x4F4D;&#x4E0D;&#x53C2;&#x4E0E; <span class="mathjax-exps">$\operatorname{SWAP}$</span> &#x95E8;&#x3002;&#x8FD9;&#x91CC; <span class="mathjax-exps">$|0\rangle$</span> &#x8981;&#x6BD4; <span class="mathjax-exps">$|f\rangle$</span> &#x591A;&#x4F7F;&#x7528;&#x81F3;&#x5C11;&#x4E00;&#x4E2A;&#x91CF;&#x5B50;&#x6BD4;&#x7279;&#x6765;&#x7F16;&#x7801;&#x662F;&#x56E0;&#x4E3A; <span class="mathjax-exps">$C^2(\Phi_{L,+a,\text{mod }N})$</span> &#x7684;&#x5B9E;&#x73B0;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x989D;&#x5916;&#x7684;&#x6700;&#x9AD8;&#x4F4D;&#x91CF;&#x5B50;&#x6BD4;&#x7279; &#xFF08;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E3A;&#x50A8;&#x5B58;&#x8FDB;&#x4F4D;&#x7684;&#x96F6;&#x5316;&#x8F85;&#x52A9;&#x6BD4;&#x7279;&#xFF0C;&#x5728; <span class="mathjax-exps">$\operatorname{SWAP}$</span> &#x95E8; &#x4E4B;&#x524D;&#x5E94;&#x5F53;&#x5DF2;&#x7ECF;&#x88AB;&#x8FD8;&#x539F;&#x4E3A; <span class="mathjax-exps">$|0\rangle$</span>&#xFF09;&#x3002;</p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x7ED9;&#x51FA;&#x91CF;&#x6613;&#x4F0F;&#x7684;&#x4EE3;&#x7801;&#x3002;&#x6211;&#x4EEC;&#x8BB0; <span class="mathjax-exps">$|f\rangle$</span>&#xFF0C;<span class="mathjax-exps">$|0\rangle$</span>&#xFF0C;<span class="mathjax-exps">$|c\rangle$</span> &#x5206;&#x522B;&#x4E3A; <code>reg_system</code>&#xFF0C;<code>reg_zeroed</code>&#xFF0C; <code>qubit_ctrlling</code>&#xFF0C;<span class="mathjax-exps">$a,N$</span> &#x5206;&#x522B;&#x4E3A; <code>int_factor</code>&#xFF0C;<code>int_divisor</code>&#xFF0C;&#x5E76;&#x5F15;&#x5165; <code>qubit_zeroed</code> &#x4F5C;&#x4E3A; <span class="mathjax-exps">$\mathcal C_{C^2(\Phi_{L,+a,\text{mod }N})}$</span> &#x6240;&#x9700;&#x5F15;&#x5165;&#x7684;&#x96F6;&#x5316;&#x8F85;&#x52A9;&#x6BD4;&#x7279;&#x3002;&#x6709;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="python{.line-numbers}" class="language-python line-numbers"><span class="token keyword">def</span> <span class="token function">func_ctrl_multmod</span><span class="token punctuation">(</span>reg_system<span class="token punctuation">,</span> reg_zeroed<span class="token punctuation">,</span> qubit_ctrlling<span class="token punctuation">,</span> qubit_zeroed<span class="token punctuation">,</span> int_factor<span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    |c&gt;|s&gt; -&gt; &lt;0|c&gt;|c&gt;|s&gt;  + &lt;1|c&gt;|c&gt;|s * f mod d&gt;
    the complement comes from the Figure 7 in arXiv quant-ph/0205095
    :param reg_system: |s&gt;
    :param reg_zeroed: |0*&gt;, a register initialled into |0*&gt;
    :param qubit_ctrlling: |c&gt;
    :param qubit_zeroed: |0&gt;, a qubit at state |0&gt;
    :param int_factor: f
    :param int_divisor: d
    :return: |c&gt;|s&gt;|0*&gt;|0&gt; -&gt; &lt;0|c&gt;|c&gt;|s&gt;|0*&gt;|0&gt;  + &lt;1|c&gt;|c&gt;|s * f mod d&gt;|0*&gt;|0&gt;
    &quot;&quot;&quot;</span>
    func_ctrl_addprodmod<span class="token punctuation">(</span>reg_zeroed<span class="token punctuation">,</span> reg_system<span class="token punctuation">,</span> qubit_ctrlling<span class="token punctuation">,</span> qubit_zeroed<span class="token punctuation">,</span> int_factor<span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span>
    <span class="token keyword">for</span> idx_qubit <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>reg_system<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>reg_zeroed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># We CSWAP the corresponding qubit in those two reg</span>
        <span class="token comment"># from the end since maybe the two reg has different length</span>
        CSWAP<span class="token punctuation">(</span>qubit_ctrlling<span class="token punctuation">,</span> reg_system<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">-</span> idx_qubit<span class="token punctuation">]</span><span class="token punctuation">,</span> reg_zeroed<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">-</span> idx_qubit<span class="token punctuation">]</span><span class="token punctuation">)</span>
    func_ctrl_addprodmod_inverse<span class="token punctuation">(</span>reg_zeroed<span class="token punctuation">,</span> reg_system<span class="token punctuation">,</span> qubit_ctrlling<span class="token punctuation">,</span> qubit_zeroed<span class="token punctuation">,</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>int_factor<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                 int_divisor<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>&#x8FD9;&#x91CC; <span class="mathjax-exps">$a^{-1}\pmod N$</span> &#x6211;&#x4EEC;&#x76F4;&#x63A5;&#x8C03;&#x7528; python &#x7684; <code>pow</code> &#x51FD;&#x6570;&#x8BA1;&#x7B97;&#x4E86;&#x3002;</p>
<h4 class="mume-header" id="%E9%87%8F%E5%AD%90%E6%B1%82%E9%98%B6%E7%AE%97%E6%B3%95%E7%9A%84%E5%AE%9E%E7%8E%B0">&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#x7684;&#x5B9E;&#x73B0;</h4>

<p>&#x6211;&#x4EEC;&#x7ED9;&#x51FA;&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#x7684;&#x91CF;&#x6613;&#x4F0F;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF0C;&#x5176;&#x4E2D; <code>int_factor</code>&#xFF0C;<code>int_divisor</code>&#xFF0C;<code>int_shots</code>&#xFF0C;<code>number_qubit_ancilla</code> &#x5206;&#x522B;&#x8868;&#x793A;&#x8981;&#x6C42;&#x9636;&#x7684;&#x5E95;&#x6570;&#xFF0C;&#x6A21;&#x6570;&#xFF0C;&#x91CF;&#x5B50;&#x7B97;&#x6CD5;&#x6BCF;&#x4E2A;&#x7535;&#x8DEF;&#x8DD1;&#x7684; shots &#x6570;&#xFF0C;&#x4F7F;&#x7528;&#x91CF;&#x5B50;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;&#x6240;&#x5F15;&#x5165;&#x7684;&#x8F85;&#x52A9;&#x6BD4;&#x7279;&#x6570;&#x3002;</p>
<pre data-role="codeBlock" data-info="python{.line-numbers}" class="language-python line-numbers"><span class="token keyword">def</span> <span class="token function">func_quantum_order_finding</span><span class="token punctuation">(</span>int_factor<span class="token punctuation">,</span> int_divisor<span class="token punctuation">,</span> int_shots<span class="token punctuation">,</span> number_qubit_ancilla<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    :param int_factor: f
    :param int_divisor: d
    :param int_shots: the shots number for each quantum circuit
    :param number_qubit_ancilla: the number of qubits for the estimating the phase
    :return: an estimation for the fraction r/ord(f,d)/2^t, where ord(f,d) is the order of f mod d, r is a random in
             {0,1,...,ord(f,d)-1}, and t = number_qubit_ancilla as following corresponding to the precision.
    &quot;&quot;&quot;</span>
    <span class="token comment"># Create the quantum environment</span>
    env <span class="token operator">=</span> QEnv<span class="token punctuation">(</span><span class="token punctuation">)</span>
    Define<span class="token punctuation">.</span>hubToken <span class="token operator">=</span> <span class="token string">&apos;&apos;</span>
    <span class="token comment"># Choose backend</span>
    env<span class="token punctuation">.</span>backend<span class="token punctuation">(</span>BackendName<span class="token punctuation">.</span>LocalBaiduSim2<span class="token punctuation">)</span>
    <span class="token comment"># env.backend(BackendName.CloudBaiduSim2Water)</span>

    <span class="token comment"># Decide the number of qubit which will be used to encode the eigenstate</span>
    number_qubit_system <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>ceil<span class="token punctuation">(</span>math<span class="token punctuation">.</span>log<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># Create the quantum register</span>
    <span class="token comment"># The ancilla qubit used for phase estimation</span>
    reg_ancilla <span class="token operator">=</span> <span class="token punctuation">[</span>env<span class="token punctuation">.</span>Q<span class="token punctuation">[</span>idx_qubit<span class="token punctuation">]</span> <span class="token keyword">for</span> idx_qubit <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> number_qubit_ancilla<span class="token punctuation">)</span><span class="token punctuation">]</span>
    number_qubit_part2 <span class="token operator">=</span> number_qubit_ancilla <span class="token operator">+</span> number_qubit_system
    <span class="token comment"># The system register holding the eigenstate</span>
    reg_system <span class="token operator">=</span> <span class="token punctuation">[</span>env<span class="token punctuation">.</span>Q<span class="token punctuation">[</span>idx_qubit<span class="token punctuation">]</span> <span class="token keyword">for</span> idx_qubit <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>number_qubit_ancilla<span class="token punctuation">,</span> number_qubit_part2<span class="token punctuation">)</span><span class="token punctuation">]</span>
    number_qubit_part3 <span class="token operator">=</span> number_qubit_ancilla <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> number_qubit_system <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token comment"># The zeroed register used in the circuit of func_ctrl_multmod</span>
    reg_zeroed <span class="token operator">=</span> <span class="token punctuation">[</span>env<span class="token punctuation">.</span>Q<span class="token punctuation">[</span>idx_qubit<span class="token punctuation">]</span> <span class="token keyword">for</span> idx_qubit <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>number_qubit_part2<span class="token punctuation">,</span> number_qubit_part3<span class="token punctuation">)</span><span class="token punctuation">]</span>
    qubit_zeroed <span class="token operator">=</span> env<span class="token punctuation">.</span>Q<span class="token punctuation">[</span>number_qubit_part3<span class="token punctuation">]</span>  <span class="token comment"># The other zeroed qubit used in the circuit of func_ctrl_multmod</span>

    <span class="token comment"># Initialise the state |0...01&gt; as a superposition of concerned eigenstates</span>
    X<span class="token punctuation">(</span>reg_system<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token comment"># The following is the quantum phase estimation algorithm</span>
    <span class="token keyword">for</span> idx_qubit <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>reg_ancilla<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        H<span class="token punctuation">(</span>reg_ancilla<span class="token punctuation">[</span>idx_qubit<span class="token punctuation">]</span><span class="token punctuation">)</span>
        func_ctrl_multmod<span class="token punctuation">(</span>reg_system<span class="token punctuation">,</span> reg_zeroed<span class="token punctuation">,</span> reg_ancilla<span class="token punctuation">[</span>idx_qubit<span class="token punctuation">]</span><span class="token punctuation">,</span> qubit_zeroed<span class="token punctuation">,</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>int_factor<span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">**</span> idx_qubit<span class="token punctuation">,</span>
                                                                                            int_divisor<span class="token punctuation">)</span><span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span>
    func_qft_without_swap_inverse<span class="token punctuation">(</span>reg_ancilla<span class="token punctuation">)</span>

    <span class="token comment"># We only measure the reg_ancilla, which gives the estimation of the phase</span>
    MeasureZ<span class="token punctuation">(</span>reg_ancilla<span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span>number_qubit_ancilla<span class="token punctuation">)</span><span class="token punctuation">)</span>

    env<span class="token punctuation">.</span>module<span class="token punctuation">(</span>CompositeGateModule<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> func_qof_data_processing<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> number_qubit_ancilla<span class="token punctuation">,</span> env<span class="token punctuation">.</span>commit<span class="token punctuation">(</span>
        int_shots<span class="token punctuation">,</span> fetchMeasure<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;counts&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>&#x8FD9;&#x91CC;&#x4EE3;&#x7801;&#x5206;&#x4E3A;&#x51E0;&#x4E2A;&#x90E8;&#x5206;&#xFF1A;</p>
<ol>
<li>&#x8BBE;&#x7F6E;&#x91CF;&#x5B50;&#x5BC4;&#x5B58;&#x5668;&#xFF1B;</li>
<li>&#x521D;&#x59CB;&#x5316;&#x91CF;&#x5B50;&#x6001;&#xFF1B;</li>
<li>&#x8C03;&#x7528;&#x91CF;&#x5B50;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;&#x7684;&#x7535;&#x8DEF;&#xFF1B;</li>
<li>&#x6D4B;&#x91CF;&#xFF1B;</li>
<li>&#x8C03;&#x7528;&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#x7684;&#x6570;&#x636E;&#x540E;&#x5904;&#x7406;&#x90E8;&#x5206;&#x3002;</li>
</ol>
<p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x518D;&#x6765;&#x89E3;&#x91CA;&#x4E0B;&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#x7684;&#x6570;&#x636E;&#x540E;&#x5904;&#x7406;&#x90E8;&#x5206;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="python{.line-numbers}" class="language-python line-numbers"><span class="token keyword">def</span> <span class="token function">func_qof_data_processing</span><span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> number_qubit_ancilla<span class="token punctuation">,</span> dict_task_result_counts<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    :param int_divisor: d
    :param number_qubit_ancilla: the number of qubits for the estimating the phase
    :param dict_task_result_counts: a dict storing the counts data in the task result
    :return: a dict {&quot;order&quot;:shots} storing the order and the shots, such as {&quot;2&quot;:5,&quot;4&quot;:7} means that 5 shots indicate
             the order may be 2 and 7 shots indicate the order may be 4.
    dict_task_result_counts of form {&quot;quantum_output&quot;:shots} is a quantum output from an estimation for the fraction
    r/ord(f,d)/2^t, where ord(f,d) is the order of f mod d, r is a random in {0,1,...,ord(f,d)-1}, and
    t = number_qubit_ancilla as following corresponding to the precision.
    For the case that the ancilla is enough we compute the maximal denominator, and for the case that the ancilla is not
    enough we compute all the possible denominators.
    &quot;&quot;&quot;</span>
    dict_order <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment"># The case that the number of ancilla is enough</span>
    <span class="token keyword">if</span> number_qubit_ancilla <span class="token operator">&gt;=</span> math<span class="token punctuation">.</span>log<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> idx_key <span class="token keyword">in</span> dict_task_result_counts<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># We need to transform the key in dict_task</span>
            <span class="token keyword">if</span> dict_task_result_counts<span class="token punctuation">[</span>idx_key<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment"># Skip the measurement results with counts &lt;= 0</span>
                <span class="token keyword">continue</span>
            <span class="token comment"># From a numerator to the order by calling func_result_to_order</span>
            int_order_maybe <span class="token operator">=</span> func_result_to_order<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>idx_key<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> number_qubit_ancilla<span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span>
            str_int_order_maybe <span class="token operator">=</span> <span class="token string">&quot;{0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>int_order_maybe<span class="token punctuation">)</span>
            <span class="token keyword">if</span> str_int_order_maybe <span class="token keyword">not</span> <span class="token keyword">in</span> dict_order<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                dict_order<span class="token punctuation">[</span>str_int_order_maybe<span class="token punctuation">]</span> <span class="token operator">=</span> dict_task_result_counts<span class="token punctuation">[</span>idx_key<span class="token punctuation">]</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                dict_order<span class="token punctuation">[</span>str_int_order_maybe<span class="token punctuation">]</span> <span class="token operator">+=</span> dict_task_result_counts<span class="token punctuation">[</span>idx_key<span class="token punctuation">]</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment"># The case that the number of ancilla is not enough</span>
        <span class="token keyword">for</span> idx_key <span class="token keyword">in</span> dict_task_result_counts<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># We need to transform the key in dict_task</span>
            <span class="token comment"># from a numerator to the order by calling func_result_to_order</span>
            <span class="token keyword">if</span> dict_task_result_counts<span class="token punctuation">[</span>idx_key<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment"># Skip the measurement results with counts &lt;= 0</span>
                <span class="token keyword">continue</span>
            list_int_order_maybe <span class="token operator">=</span> func_result_to_order_list<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>idx_key<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> number_qubit_ancilla<span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span>
            <span class="token keyword">for</span> int_order_maybe <span class="token keyword">in</span> list_int_order_maybe<span class="token punctuation">:</span>
                str_int_order_maybe <span class="token operator">=</span> <span class="token string">&quot;{0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>int_order_maybe<span class="token punctuation">)</span>
                <span class="token keyword">if</span> str_int_order_maybe <span class="token keyword">not</span> <span class="token keyword">in</span> dict_order<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    dict_order<span class="token punctuation">[</span>str_int_order_maybe<span class="token punctuation">]</span> <span class="token operator">=</span> dict_task_result_counts<span class="token punctuation">[</span>idx_key<span class="token punctuation">]</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    dict_order<span class="token punctuation">[</span>str_int_order_maybe<span class="token punctuation">]</span> <span class="token operator">+=</span> dict_task_result_counts<span class="token punctuation">[</span>idx_key<span class="token punctuation">]</span>
    <span class="token keyword">return</span> dict_order
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x91CF;&#x5B50;&#x7535;&#x8DEF;&#x7684;&#x8FD4;&#x56DE;&#x7ED3;&#x679C; <code>dict_task_result_counts</code>&#xFF0C; &#x5176;&#x53D8;&#x91CF;&#x7C7B;&#x578B;&#x4E3A;&#x5B57;&#x5178;&#xFF0C;&#x5176;&#x5143;&#x7D20;&#x7684;&#x952E;&#x4E3A;&#x6D4B;&#x91CF;&#x7ED3;&#x679C;&#xFF08;&#x5B57;&#x7B26;&#x4E32;&#xFF09;&#xFF0C;&#x503C;&#x4E3A;&#x8BE5;&#x6D4B;&#x91CF;&#x7ED3;&#x679C;&#x5BF9;&#x5E94;&#x7684;&#x89C2;&#x6D4B;&#x5230;&#x7684;&#x6B21;&#x6570;&#x3002;&#x6211;&#x4EEC;&#x8FD8;&#x9700;&#x8981;&#x8F85;&#x52A9;&#x6BD4;&#x7279;&#x7684;&#x6570;&#x91CF; <code>number_qubit_ancilla</code> &#x7528;&#x4E8E;&#x8BA1;&#x7B97; <span class="mathjax-exps">$k$</span> &#x7684;&#x5206;&#x6BCD;&#xFF0C;&#x6A21;&#x6570; <code>int_divisor</code> &#x4F5C;&#x4E3A;&#x8FDE;&#x5206;&#x6570;&#x5C55;&#x5F00;&#x6B65;&#x9AA4;&#x7684;&#x754C;&#x5B9A;&#x3002;&#x51FD;&#x6570;&#x6700;&#x7EC8;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5B57;&#x5178;&#xFF0C;&#x5176;&#x5143;&#x7D20;&#x7684;&#x952E;&#x4E3A;&#x6C42;&#x5F97;&#x7684;&#x201C;&#x9636;&#x201D;&#xFF0C;&#x503C;&#x4E3A;&#x8BE5;&#x201C;&#x9636;&#x201D;&#x5BF9;&#x5E94;&#x7684;&#x89C2;&#x6D4B;&#x6B21;&#x6570;&#x3002;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x4E86;&#x5F15;&#x53F7;&#x662F;&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;&#x9636;&#x53EF;&#x80FD;&#x4E0D;&#x662F;&#x6B63;&#x786E;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x53EA;&#x662F;&#x6570;&#x636E;&#x5904;&#x7406;&#x7684;&#x7ED3;&#x679C;&#x3002;&#x8FD9;&#x91CC;&#x8FD8;&#x505A;&#x4E86;&#x4E24;&#x79CD;&#x5206;&#x7C7B;&#xFF0C;&#x533A;&#x522B;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;&#x5F15;&#x5165;&#x7684;&#x8F85;&#x52A9;&#x6BD4;&#x7279;&#x662F;&#x5426;&#x8DB3;&#x591F;&#x3002;&#x8FD9;&#x91CC;&#x8F85;&#x52A9;&#x6BD4;&#x7279;&#x8DB3;&#x591F;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x9009;&#x62E9;&#x8FDE;&#x5206;&#x6570;&#x5C55;&#x5F00;&#x4E2A;&#x622A;&#x65AD;&#x4E2D;&#x5206;&#x6BCD;&#x5C0F;&#x4E8E;&#x6A21;&#x6570;&#x4E14;&#x6700;&#x5927;&#x7684;&#x90A3;&#x4E2A;&#x4F5C;&#x4E3A;&#x8FDE;&#x5206;&#x6570;&#x5C55;&#x5F00;&#x6B65;&#x9AA4;&#x7684;&#x8F93;&#x51FA;&#xFF0C;&#x8FD9;&#x5BF9;&#x5E94;&#x51FD;&#x6570; <code>func_result_to_order</code>&#xFF1B;&#x8F85;&#x52A9;&#x6BD4;&#x7279;&#x4E0D;&#x8DB3;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x5168;&#x90E8;&#x622A;&#x65AD;&#x4E2D;&#x5206;&#x6BCD;&#x5C0F;&#x4E8E;&#x6A21;&#x6570;&#x7684;&#x7EC4;&#x6210;&#x4E00;&#x4E2A;&#x5217;&#x8868;&#x4F5C;&#x4E3A;&#x8F93;&#x51FA;&#xFF0C;&#x8FD9;&#x5BF9;&#x5E94;&#x51FD;&#x6570; <code>func_result_to_order_list</code>&#x3002;&#x8FD9;&#x91CC;&#x51FD;&#x6570; <code>func_result_to_order</code> &#x548C; <code>func_result_to_order_list</code> &#x4E3A;&#x7ECF;&#x5178;&#x8BA1;&#x7B97;&#xFF0C;&#x5176;&#x672C;&#x8D28;&#x4E0A;&#x5C31;&#x662F; Euclid &#x8F97;&#x8F6C;&#x76F8;&#x9664;&#x6CD5;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x518D;&#x8D58;&#x8FF0;&#x4E86;&#x3002;</p>
<p>&#x6700;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x56DE;&#x5230;</p>
<h4 class="mume-header" id="shor-%E7%AE%97%E6%B3%95%E7%9A%84%E5%AE%9E%E7%8E%B0">Shor &#x7B97;&#x6CD5;&#x7684;&#x5B9E;&#x73B0;</h4>

<pre data-role="codeBlock" data-info="python{.line-numbers}" class="language-python line-numbers"><span class="token keyword">def</span> <span class="token function">func_Shor_algorithm</span><span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> number_qubit_ancilla<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> int_shots<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> int_factor<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    We want to factor the int int_divisor
    :param int_divisor: d, which we want to factor
    :param number_qubit_ancilla: the number of qubit which will be used for quantum phase estimation
    :param int_shots: the number of shots whose default value is 2; when int_shots &gt; 2 means we want to know the
                      distribution of the state after quantum phase estimation
    :param int_factor: an integer whose order will be computed by the quantum order finding algorithm
    :return: a factor of d
    here it will print the computation process such as ord(4 mod 15) = 2 and the factorization such as 15 = 3 * 5,
    where &quot;not quantum&quot; means the current factorization comes from a classical part of Shor&apos;s algorithm.
    For int_shots &gt; 2, we will print the number of shots where we obtain a correct factorization.
    &quot;&quot;&quot;</span>
    <span class="token comment"># Some classical cases</span>
    <span class="token keyword">if</span> int_divisor <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        int_divisor <span class="token operator">=</span> <span class="token operator">-</span>int_divisor
    <span class="token keyword">if</span> int_divisor <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;{0} is zero.&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>int_divisor<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">0</span>
    <span class="token keyword">if</span> int_divisor <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;{0} is unit.&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>int_divisor<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">1</span>
    <span class="token keyword">elif</span> isprime<span class="token punctuation">(</span>int_divisor<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;{0} is prime.&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>int_divisor<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">1</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token comment"># The case that d is a power of some prime</span>
        <span class="token keyword">for</span> idx_int <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>floor<span class="token punctuation">(</span>math<span class="token punctuation">.</span>log<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">/</span> idx_int<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> idx_int<span class="token punctuation">)</span> <span class="token operator">==</span> int_divisor<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;{0[0]} is a power of {0[1]}.&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token punctuation">[</span>int_divisor<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">/</span> idx_int<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> idx_int
        <span class="token comment"># The case that d is even</span>
        <span class="token keyword">if</span> int_divisor <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;{0[0]} = {0[1]} * {0[2]}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token punctuation">[</span>int_divisor<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> int_divisor <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token number">2</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># Generate a random f (int_factor) which can be assigned when called</span>
            <span class="token keyword">if</span> int_factor <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                int_factor <span class="token operator">=</span> randint<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> int_divisor <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span>
            <span class="token comment"># If the input int_factor is invalid to introduce the factorization, we reset the value of int_factor</span>
            <span class="token keyword">elif</span> int_factor <span class="token operator">%</span> int_divisor <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">or</span> int_factor <span class="token operator">%</span> int_divisor <span class="token operator">==</span> int_divisor <span class="token operator">-</span> <span class="token number">1</span> <span class="token keyword">or</span> \
                    int_factor <span class="token operator">%</span> int_divisor <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;The value of int_factor is invalid!&apos;</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> func_Shor_algorithm<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> number_qubit_ancilla<span class="token operator">=</span>number_qubit_ancilla<span class="token punctuation">,</span> int_shots<span class="token operator">=</span>int_shots<span class="token punctuation">)</span>
            int_gcd <span class="token operator">=</span> math<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>int_factor<span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span>
            <span class="token comment"># The case that f and d are not co-prime</span>
            <span class="token keyword">if</span> int_gcd <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;{0[0]} = {0[1]} * {0[2]}, not quantum&apos;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token punctuation">[</span>int_divisor<span class="token punctuation">,</span> int_gcd<span class="token punctuation">,</span> int_divisor <span class="token operator">//</span> int_gcd<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> int_gcd
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token comment"># From now on, we entry the quantum part</span>
                number_qubit_system <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>ceil<span class="token punctuation">(</span>math<span class="token punctuation">.</span>log<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token comment"># The number_qubit_ancilla used for phase estimation should be 2 * n_q_s + 4 such that the successful</span>
                <span class="token comment"># probability of the phase estimation will &gt; 98.6%</span>
                <span class="token keyword">if</span> number_qubit_ancilla <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                    number_qubit_ancilla <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> number_qubit_system <span class="token operator">+</span> <span class="token number">4</span>
                <span class="token comment"># The case that the number of ancilla is enough</span>
                <span class="token keyword">if</span> number_qubit_ancilla <span class="token operator">&gt;=</span> math<span class="token punctuation">.</span>log<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">:</span>
                    <span class="token comment"># A dict storing the possible order and its corresponding number of shots</span>
                    dict_order <span class="token operator">=</span> func_quantum_order_finding<span class="token punctuation">(</span>int_factor<span class="token punctuation">,</span> int_divisor<span class="token punctuation">,</span> int_shots<span class="token punctuation">,</span> number_qubit_ancilla<span class="token punctuation">)</span>
                    <span class="token comment"># The list of possible order</span>
                    list_order <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>idx_key<span class="token punctuation">)</span> <span class="token keyword">for</span> idx_key <span class="token keyword">in</span> dict_order<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
                    int_order <span class="token operator">=</span> <span class="token number">0</span>
                    <span class="token keyword">if</span> int_shots <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">or</span> int_shots <span class="token operator">==</span> <span class="token number">2</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>list_order<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                        <span class="token keyword">if</span> int_shots <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>list_order<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                            int_order <span class="token operator">=</span> list_order<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                        <span class="token keyword">elif</span> int_shots <span class="token operator">==</span> <span class="token number">2</span> <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>list_order<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
                            <span class="token comment"># For two shots, we compute the least common multiple as the order</span>
                            int_order <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>list_order<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> list_order<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">/</span> math<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>list_order<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> list_order<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        int_pow_half <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>int_factor<span class="token punctuation">,</span> int_order <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span>
                        <span class="token comment"># To check whether int_factor and its order can introduce the factorization</span>
                        <span class="token keyword">if</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>int_factor<span class="token punctuation">,</span> int_order<span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">and</span> int_order <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> int_pow_half <span class="token operator">!=</span> \
                                int_divisor <span class="token operator">-</span> <span class="token number">1</span> <span class="token keyword">and</span> int_pow_half <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>
                            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;ord({0[0]} mod {0[1]}) = {0[2]}&apos;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token punctuation">[</span>int_factor<span class="token punctuation">,</span> int_divisor<span class="token punctuation">,</span> int_order<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token comment"># An f which satisfies some appropriate conditions will give a factorization of d</span>
                            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;{0[0]} = {0[1]} * {0[2]}&apos;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
                                <span class="token punctuation">[</span>int_divisor<span class="token punctuation">,</span> math<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> int_pow_half <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                 math<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> int_pow_half <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token keyword">return</span> math<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> int_pow_half <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
                        <span class="token keyword">else</span><span class="token punctuation">:</span>
                            <span class="token comment"># Maybe we compute a wrong order, maybe f and its order cannot give the factorization of d</span>
                            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;Perhaps ord({0[0]} mod {0[1]}) = {0[2]},\n&apos;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token punctuation">[</span>int_factor<span class="token punctuation">,</span> int_divisor<span class="token punctuation">,</span>
                                                                                       int_order<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;but it cannot give the factorization of {0}.&apos;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>int_divisor<span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token comment"># We haven&apos;t compute the correct order and need to recompute</span>
                            func_Shor_algorithm<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> number_qubit_ancilla<span class="token operator">=</span>number_qubit_ancilla<span class="token punctuation">,</span>
                                                int_shots<span class="token operator">=</span>int_shots<span class="token punctuation">)</span>
                    <span class="token keyword">elif</span> int_shots <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">:</span>
                        <span class="token comment"># Here we use sympy to compute the order to confirm which possible order is correct</span>
                        int_order_true <span class="token operator">=</span> n_order<span class="token punctuation">(</span>int_factor<span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span>
                        <span class="token keyword">if</span> int_order_true <span class="token keyword">in</span> list_order<span class="token punctuation">:</span>
                            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;We obtain ord({0[0]} mod {0[1]}) = {0[2]} for {0[3]} of {0[4]} times.&apos;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
                                <span class="token punctuation">[</span>int_factor<span class="token punctuation">,</span> int_divisor<span class="token punctuation">,</span> int_order_true<span class="token punctuation">,</span> dict_order<span class="token punctuation">[</span><span class="token string">&quot;{0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>int_order_true<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                 int_shots<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            int_pow_half_true <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>int_factor<span class="token punctuation">,</span> int_order_true <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span>
                            <span class="token comment"># To check whether int_factor and its order can introduce the factorization</span>
                            <span class="token keyword">if</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>int_factor<span class="token punctuation">,</span> int_pow_half_true<span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">and</span> int_order_true <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> \
                                    int_pow_half_true <span class="token operator">!=</span> int_divisor <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span>
                                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;{0[0]} = {0[1]} * {0[2]}&apos;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token punctuation">[</span>int_divisor<span class="token punctuation">,</span> math<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>
                                    int_divisor<span class="token punctuation">,</span> int_pow_half_true <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> math<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> int_pow_half_true <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                <span class="token keyword">return</span> math<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> int_pow_half_true <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
                            <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment"># int_factor cannot introduce the factorization of d</span>
                                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;But it cannot give the factorization of {0}.&apos;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>int_divisor<span class="token punctuation">)</span><span class="token punctuation">)</span>
                                func_Shor_algorithm<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> number_qubit_ancilla<span class="token operator">=</span>number_qubit_ancilla<span class="token punctuation">,</span>
                                                    int_shots<span class="token operator">=</span>int_shots<span class="token punctuation">)</span>
                        <span class="token keyword">else</span><span class="token punctuation">:</span>
                            <span class="token comment"># We haven&apos;t compute the correct order and need to recompute</span>
                            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;we haven&apos;t computed the correct order of {0[0]} mod {0[1]}.&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
                                <span class="token punctuation">[</span>int_factor<span class="token punctuation">,</span> int_divisor<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            func_Shor_algorithm<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> number_qubit_ancilla<span class="token operator">=</span>number_qubit_ancilla<span class="token punctuation">,</span>
                                                int_shots<span class="token operator">=</span>int_shots<span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment"># The case that the number of ancilla is not enough, where the cost is more.</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Since the ancilla qubits are not enough to estimate the order with a high probability,&quot;</span><span class="token punctuation">)</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;we need to traverse all probable denominator in the step of continued fraction expansions.&quot;</span><span class="token punctuation">)</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Thus some order may be obtained for twice as many times as the number of shots.\n&quot;</span><span class="token punctuation">)</span>
                    <span class="token comment"># A dict storing the possible order and its corresponding number of shots</span>
                    dict_order <span class="token operator">=</span> func_quantum_order_finding<span class="token punctuation">(</span>int_factor<span class="token punctuation">,</span> int_divisor<span class="token punctuation">,</span> int_shots<span class="token punctuation">,</span> number_qubit_ancilla<span class="token punctuation">)</span>
                    <span class="token comment"># The list of possible order</span>
                    list_order <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>idx_key<span class="token punctuation">)</span> <span class="token keyword">for</span> idx_key <span class="token keyword">in</span> dict_order<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
                    int_order <span class="token operator">=</span> <span class="token number">0</span>
                    <span class="token keyword">if</span> int_shots <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>list_order<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>  <span class="token comment"># For the case 1-shot</span>
                        <span class="token keyword">for</span> int_order_maybe <span class="token keyword">in</span> list_order<span class="token punctuation">:</span>  <span class="token comment"># Check &quot;maybe&quot; is the correct order one by one</span>
                            <span class="token keyword">if</span> int_order_maybe <span class="token operator">!=</span> <span class="token number">0</span> <span class="token keyword">and</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>int_factor<span class="token punctuation">,</span> int_order_maybe<span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                                int_order <span class="token operator">=</span> int_order_maybe  <span class="token comment"># If correct, recorded in int_order</span>
                                <span class="token keyword">break</span>
                        int_pow_half <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>int_factor<span class="token punctuation">,</span> int_order <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span>
                        <span class="token comment"># To check whether int_factor and its order can introduce the factorization</span>
                        <span class="token keyword">if</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>int_factor<span class="token punctuation">,</span> int_order<span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">and</span> int_order <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> int_pow_half <span class="token operator">!=</span> \
                                int_divisor <span class="token operator">-</span> <span class="token number">1</span> <span class="token keyword">and</span> int_pow_half <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>
                            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;ord({0[0]} mod {0[1]}) = {0[2]}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token punctuation">[</span>int_factor<span class="token punctuation">,</span> int_divisor<span class="token punctuation">,</span> int_order<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token comment"># An f which satisfies some appropriate conditions will give a factorization of d</span>
                            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;{0[0]} = {0[1]} * {0[2]}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
                                <span class="token punctuation">[</span>int_divisor<span class="token punctuation">,</span> math<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> int_pow_half <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                 math<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> int_pow_half <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token keyword">return</span> math<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> int_pow_half <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
                        <span class="token keyword">else</span><span class="token punctuation">:</span>
                            <span class="token comment"># Maybe we compute a wrong order, maybe f and its order cannot give the factorization of d</span>
                            <span class="token keyword">if</span> int_order <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment"># We haven&apos;t computed the correct order of int_factor</span>
                                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;We haven&apos;t computed the correct order of {0[0]} mod {0[1]}.\n&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
                                    <span class="token punctuation">[</span>int_factor<span class="token punctuation">,</span> int_divisor<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment"># int_factor cannot introduce the factorization of d</span>
                                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Perhaps ord({0[0]} mod {0[1]}) = {0[2]},&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
                                    <span class="token punctuation">[</span>int_factor<span class="token punctuation">,</span> int_divisor<span class="token punctuation">,</span> int_order<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;but it cannot give the factorization of {0}.&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>int_divisor<span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token comment"># And we need to recompute</span>
                            func_Shor_algorithm<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> number_qubit_ancilla<span class="token operator">=</span>number_qubit_ancilla<span class="token punctuation">,</span>
                                                int_shots<span class="token operator">=</span>int_shots<span class="token punctuation">)</span>
                    <span class="token keyword">elif</span> int_shots <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">:</span>  <span class="token comment"># For the case int_shots &gt; 1</span>
                        <span class="token comment"># Here we use sympy to compute the order to confirm which possible order is correct</span>
                        int_order_true <span class="token operator">=</span> n_order<span class="token punctuation">(</span>int_factor<span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span>
                        <span class="token keyword">if</span> int_order_true <span class="token keyword">in</span> list_order<span class="token punctuation">:</span>
                            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;We obtain ord({0[0]} mod {0[1]}) = {0[2]} for {0[3]} of {0[4]} times.&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
                                <span class="token punctuation">[</span>int_factor<span class="token punctuation">,</span> int_divisor<span class="token punctuation">,</span> int_order_true<span class="token punctuation">,</span> dict_order<span class="token punctuation">[</span><span class="token string">&quot;{0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>int_order_true<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                 int_shots<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            int_pow_half_true <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>int_factor<span class="token punctuation">,</span> int_order_true <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span>
                            <span class="token comment"># To check whether int_factor and its order can introduce the factorization</span>
                            <span class="token keyword">if</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>int_factor<span class="token punctuation">,</span> int_pow_half_true<span class="token punctuation">,</span> int_divisor<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">and</span> int_order_true <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> \
                                    int_pow_half_true <span class="token operator">!=</span> int_divisor <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span>
                                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;{0[0]} = {0[1]} * {0[2]}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token punctuation">[</span>int_divisor<span class="token punctuation">,</span> math<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>
                                    int_divisor<span class="token punctuation">,</span> int_pow_half_true <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> math<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> int_pow_half_true <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                <span class="token keyword">return</span> math<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> int_pow_half_true <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
                            <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment"># int_factor cannot introduce the factorization of d</span>
                                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;But it cannot give the factorization of {0}.&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>int_divisor<span class="token punctuation">)</span><span class="token punctuation">)</span>
                                func_Shor_algorithm<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> number_qubit_ancilla<span class="token operator">=</span>number_qubit_ancilla<span class="token punctuation">,</span>
                                                    int_shots<span class="token operator">=</span>int_shots<span class="token punctuation">)</span>
                        <span class="token keyword">else</span><span class="token punctuation">:</span>
                            <span class="token comment"># We haven&apos;t compute the correct order and need to recompute</span>
                            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;we haven&apos;t computed the correct order of {0[0]} mod {0[1]}.\n&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
                                <span class="token punctuation">[</span>int_factor<span class="token punctuation">,</span> int_divisor<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            func_Shor_algorithm<span class="token punctuation">(</span>int_divisor<span class="token punctuation">,</span> number_qubit_ancilla<span class="token operator">=</span>number_qubit_ancilla<span class="token punctuation">,</span>
                                                int_shots<span class="token operator">=</span>int_shots<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x786E;&#x5B9A; <code>int_divisor</code> &#x662F;&#x8981;&#x5206;&#x89E3;&#x7684;&#x5927;&#x6570; <span class="mathjax-exps">$N$</span>&#xFF1B;<code>int_factor</code> &#x4E3A;&#x9996;&#x6B21;&#x62BD;&#x53D6;&#x7684;&#x6574;&#x6570; <span class="mathjax-exps">$a\in\{2,\cdots,N-2\}$</span>&#xFF0C;&#x7F3A;&#x7701;&#x65F6;&#x5C06;&#x5728;&#x4EE3;&#x7801;&#x7684;&#x7B2C; <code>38</code> &#x884C;&#x968F;&#x673A;&#x751F;&#x6210;&#xFF1B;<code>number_qubit_ancilla</code> &#x4E3A;&#x91CF;&#x5B50;&#x76F8;&#x4F4D;&#x4F30;&#x8BA1;&#x7B97;&#x6CD5;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7684;&#x8F85;&#x52A9;&#x6BD4;&#x7279;&#x6570;&#x91CF;&#xFF0C;&#x7F3A;&#x7701;&#x65F6;&#x5C06;&#x5728;&#x4EE3;&#x7801;&#x7684;&#x7B2C; <code>55</code> &#x884C;&#x8BBE;&#x7F6E;&#x4E3A;&#x7565;&#x5927;&#x4E8E;&#x7F16;&#x7801; <span class="mathjax-exps">$N$</span> &#x7684; qubit &#x6570;&#x91CF;&#x7684;&#x4E24;&#x500D;&#xFF1B;<code>int_shots</code> &#x4E3A;&#x6BCF;&#x4E2A;&#x91CF;&#x5B50;&#x7535;&#x8DEF;&#x6267;&#x884C;&#x7684;&#x6B21;&#x6570;&#xFF0C;&#x7F3A;&#x7701;&#x503C;&#x4E3A; <span class="mathjax-exps">$2$</span> &#x5BF9;&#x5E94; <strong>&#x7B97;&#x6CD5; 7</strong> &#x7684;&#x6B65;&#x9AA4; 2&#x3002;</p>
<p>&#x4EE3;&#x7801;&#x7684; <code>14-35</code> &#x884C;&#x7EA6;&#x5316;/&#x6392;&#x9664;&#x4E86;&#x8D1F;&#x6570;&#x3001;<span class="mathjax-exps">$0$</span>&#x3001;<span class="mathjax-exps">$1$</span>&#x3001;&#x7D20;&#x6570;&#x3001;&#x5076;&#x6570;&#x3001;&#x6574;&#x6570;&#x5E42;&#x7B49;&#x7ECF;&#x5178;&#x53EF;&#x533A;&#x5206;&#x60C5;&#x5F62;&#xFF0C;&#x5BF9;&#x5E94; <strong>&#x7B97;&#x6CD5; 3</strong> &#x7684;&#x8F93;&#x5165;&#x6761;&#x4EF6;&#x7B5B;&#x67E5;&#x3002;&#x4EE3;&#x7801;&#x7684; <code>37-49</code> &#x884C;&#x5BF9;&#x5E94; <strong>&#x7B97;&#x6CD5; 3</strong> &#x7684;&#x6B65;&#x9AA4; 1-3&#x3002;&#x540E;&#x9762;&#x4F9D;&#x65E7;&#x6309;&#x7167;&#x201C;&#x8F85;&#x52A9;&#x6BD4;&#x7279;&#x662F;&#x5426;&#x8DB3;&#x591F;&#x201D;&#x505A;&#x4E86;&#x4E8C;&#x5206;&#x7C7B;&#xFF0C;&#x6211;&#x4EEC;&#x8BA4;&#x4E3A;&#x5728;&#x8F85;&#x52A9;&#x6BD4;&#x7279;&#x5145;&#x8DB3;&#x6216;&#x8005; shots &#x6570;&#x4E0D;&#x8D85;&#x8FC7; <span class="mathjax-exps">$2$</span> &#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x5C1D;&#x8BD5;&#x8BA1;&#x7B97;&#x5927;&#x6570;&#x5206;&#x89E3;&#x7684;&#x7ED3;&#x679C;&#xFF1B;&#x5426;&#x5219;&#xFF0C;&#x6211;&#x4EEC;&#x503E;&#x5411;&#x4E8E;&#x4E86;&#x89E3; Shor &#x7B97;&#x6CD5;&#x80FD;&#x8F93;&#x51FA;&#x6B63;&#x786E;&#x7ED3;&#x679C;&#x7684;&#x6982;&#x7387;&#x3002;&#x6211;&#x4EEC;&#x5206;&#x522B;&#x5728;&#x7B2C; <code>60</code>&#x3001;<code>119</code> &#x884C;&#x83B7;&#x53D6;&#x5904;&#x7406;&#x597D;&#x7684;&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#x7684;&#x7ED3;&#x679C;&#x3002;&#x5BF9;&#x4E8E;&#x5C1D;&#x8BD5;&#x6C42;&#x89E3;&#x5927;&#x6570;&#x5206;&#x89E3;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x6211;&#x4EEC;&#x5206;&#x522B;&#x5728; <code>72</code>&#x3001;<code>130</code> &#x884C;&#x9A8C;&#x8BC1; <span class="mathjax-exps">$a$</span> &#x662F;&#x5426;&#x5177;&#x6709;&#x201C;&#x826F;&#x6027;&#x201D;&#xFF0C;&#x5BF9;&#x5E94; <strong>&#x7B97;&#x6CD5; 3</strong> &#x7684;&#x6B65;&#x9AA4; 5&#xFF0C;&#x8FDB;&#x4E00;&#x6B65;&#x5206;&#x522B;&#x5728; <code>76</code>&#x3001;<code>134</code> &#x884C;&#x7ED9;&#x51FA;&#x5927;&#x6570;&#x5206;&#x89E3;&#xFF1B;&#x5BF9;&#x4E8E;&#x4E86;&#x89E3;&#x6B63;&#x786E;&#x6982;&#x7387;&#x7684;&#x60C5;&#x5F62;&#xFF0C;&#x6211;&#x4EEC;&#x5206;&#x522B;&#x5728; <code>90</code>&#x3001;<code>152</code> &#x884C;&#x4F7F;&#x7528;&#x51FD;&#x6570; <code>sympy.ntheory.residue_ntheory.n_order</code> &#x76F4;&#x63A5;&#x8C03;&#x53D6;&#x6B63;&#x786E;&#x7684;&#x9636;&#xFF0C;&#x7136;&#x540E;&#x6BD4;&#x5BF9;&#x91CF;&#x5B50;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#x6570;&#x636E;&#x5904;&#x7406;&#x540E;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x6765;&#x76F4;&#x89C2;&#x5224;&#x65AD; Shor &#x7B97;&#x6CD5;&#x8F93;&#x51FA;&#x6B63;&#x786E;&#x5206;&#x89E3;&#x7684;&#x6982;&#x7387;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8FD9;&#x6837;&#x8C03;&#x7528; Shor &#x7B97;&#x6CD5;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="python" class="language-python">func_Shor_algorithm<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> number_qubit_ancilla<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> int_shots<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> int_factor<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
</pre><p>&#x67D0;&#x6B21;&#x7684;&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="python" class="language-python">Shots <span class="token number">2</span>
Counts <span class="token punctuation">{</span><span class="token string">&apos;00000010&apos;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&apos;00000001&apos;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span>
State <span class="token boolean">None</span>
Seed <span class="token number">245569767</span>
<span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token number">2</span> mod <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">4</span>
<span class="token number">15</span> <span class="token operator">=</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token number">5</span>
</pre><p>&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6C42;&#x9636;&#x7B97;&#x6CD5;&#x6B63;&#x786E;&#x5730;&#x6C42;&#x51FA;&#x4E86; <span class="mathjax-exps">$2\pmod{15}$</span> &#x7684;&#x9636;&#x3002;</p>
<h2 class="mume-header" id="%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">&#x53C2;&#x8003;&#x8D44;&#x6599;</h2>

<p>[1] Pomerance, Carl. &quot;A tale of two sieves.&quot; Notices Amer. Math. Soc. 1996.</p>
<p>[2] Shor, Peter W. &quot;Algorithms for quantum computation: discrete logarithms and factoring.&quot; Proceedings 35th annual symposium on foundations of computer science. Ieee, 1994.</p>
<p>[3] Agrawal, Manindra, Neeraj Kayal, and Nitin Saxena. &quot;PRIMES is in P.&quot; Annals of Mathematics (2004): 781-793.</p>
<p>[4] Lenstra Jr, H. W., and Carl Pomerance. &quot;Primality testing with Gaussian periods. Archived version 20110412, Dartmouth College, US.&quot; (2011).</p>
<p>[5] Nielsen, Michael A., and Isaac L. Chuang. &quot;Quantum computation and quantum information.&quot; Phys. Today 54.2 (2001): 60.</p>
<p>[6] Vedral, Vlatko, Adriano Barenco, and Artur Ekert. &quot;Quantum networks for elementary arithmetic operations.&quot; Physical Review A 54.1 (1996): 147.</p>
<p>[7] Beauregard, Stephane. &quot;Circuit for Shor&apos;s algorithm using 2n+3 qubits.&quot; arXiv preprint quant-ph/0205095 (2002).</p>

      </div>
      
      
    
    
    
    
    
    
    
    
  
    </body></html>